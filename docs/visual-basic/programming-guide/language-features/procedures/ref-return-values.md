---
title: Valori restituiti Ref (Visual Basic)
ms.date: 04/28/2017
helpviewer_keywords:
- variables [Visual Basic]
- ref return values [Visual Basic]
- ref returns [Visual Basic]
ms.assetid: 5ef0cc69-eb3a-4a67-92a2-78585f223cb5
ms.openlocfilehash: 7401fdd0fa876d21a87dbe9faf9d979e6b3bdc5c
ms.sourcegitcommit: 1f12db2d852d05bed8c53845f0b5a57a762979c8
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/18/2019
ms.locfileid: "72581129"
---
# <a name="support-for-reference-return-values-visual-basic"></a><span data-ttu-id="8fa04-102">Supporto per i valori restituiti di riferimento (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="8fa04-102">Support for reference return values (Visual Basic)</span></span>

<span data-ttu-id="8fa04-103">A partire C# da 7,0, C# il linguaggio supporta i *valori restituiti di riferimento*.</span><span class="sxs-lookup"><span data-stu-id="8fa04-103">Starting with C# 7.0, the C# language supports *reference return values*.</span></span> <span data-ttu-id="8fa04-104">Un modo per comprendere i valori restituiti di riferimento è che si tratta del contrario degli argomenti passati per riferimento a un metodo.</span><span class="sxs-lookup"><span data-stu-id="8fa04-104">One way to understand reference return values is that they are the opposite of arguments that are passed by reference to a method.</span></span> <span data-ttu-id="8fa04-105">Quando viene modificato un argomento passato per riferimento, le modifiche vengono riflesse nel valore della variabile nel chiamante.</span><span class="sxs-lookup"><span data-stu-id="8fa04-105">When an argument passed by reference is modified, the changes are reflected in value of the variable on the caller.</span></span> <span data-ttu-id="8fa04-106">Quando un metodo fornisce un valore restituito di riferimento a un chiamante, le modifiche apportate al valore restituito di riferimento dal chiamante vengono riflesse nei dati del metodo chiamato.</span><span class="sxs-lookup"><span data-stu-id="8fa04-106">When an method provides a reference return value to a caller, modifications made to the reference return value by the caller are reflected in the called method's data.</span></span>

<span data-ttu-id="8fa04-107">Visual Basic non consente di creare metodi con valori restituiti di riferimento, ma consente di utilizzare valori restituiti di riferimento.</span><span class="sxs-lookup"><span data-stu-id="8fa04-107">Visual Basic does not allow you to author methods with reference return values, but it does allow you to consume reference return values.</span></span> <span data-ttu-id="8fa04-108">In altre parole, è possibile chiamare un metodo con un valore restituito di riferimento e modificare il valore restituito e le modifiche apportate al valore restituito di riferimento vengono riflesse nei dati del metodo chiamato.</span><span class="sxs-lookup"><span data-stu-id="8fa04-108">In other words, you can call a method with a reference return value and modify that return value, and changes to the reference return value are reflected in the called method's data.</span></span>

## <a name="modifying-the-ref-return-value-directly"></a><span data-ttu-id="8fa04-109">Modifica diretta del valore restituito Ref</span><span class="sxs-lookup"><span data-stu-id="8fa04-109">Modifying the ref return value directly</span></span>

<span data-ttu-id="8fa04-110">Per i metodi che hanno sempre esito positivo e non hanno parametri di `ByRef`, è possibile modificare direttamente il valore restituito di riferimento.</span><span class="sxs-lookup"><span data-stu-id="8fa04-110">For methods that always succeed and have no `ByRef` parameters, you can modify the reference return value directly.</span></span> <span data-ttu-id="8fa04-111">A tale scopo, assegnare il nuovo valore alle espressioni che restituiscono il valore restituito di riferimento.</span><span class="sxs-lookup"><span data-stu-id="8fa04-111">You do this by assigning the new value to the expressions that returns the reference return value.</span></span>

<span data-ttu-id="8fa04-112">Nell'esempio C# seguente viene definito un metodo di `NumericValue.IncrementValue` che incrementa un valore interno e lo restituisce come valore restituito di riferimento.</span><span class="sxs-lookup"><span data-stu-id="8fa04-112">The following C# example defines a `NumericValue.IncrementValue` method that increments an internal value and returns it as a reference return value.</span></span>

[!code-csharp[Ref-Return](../../../../../samples/snippets/visualbasic/programming-guide/language-features/procedures/ref-returns1.cs)]

<span data-ttu-id="8fa04-113">Il valore restituito di riferimento viene quindi modificato dal chiamante nell'esempio di Visual Basic seguente.</span><span class="sxs-lookup"><span data-stu-id="8fa04-113">The reference return value is then modified by the caller in the following Visual Basic example.</span></span> <span data-ttu-id="8fa04-114">Si noti che la riga con la chiamata al metodo `NumericValue.IncrementValue` non assegna un valore al metodo.</span><span class="sxs-lookup"><span data-stu-id="8fa04-114">Note that the line with the `NumericValue.IncrementValue` method call does not assign a value to the method.</span></span> <span data-ttu-id="8fa04-115">Assegna invece un valore al valore restituito di riferimento restituito dal metodo.</span><span class="sxs-lookup"><span data-stu-id="8fa04-115">Instead, it assigns a value to the reference return value returned by the method.</span></span>

[!code-vb[Ref-Return](../../../../../samples/snippets/visualbasic/programming-guide/language-features/procedures/use-ref-returns1.vb)]

## <a name="using-a-helper-method"></a><span data-ttu-id="8fa04-116">Uso di un metodo helper</span><span class="sxs-lookup"><span data-stu-id="8fa04-116">Using a helper method</span></span>

<span data-ttu-id="8fa04-117">In altri casi, la modifica del valore restituito di riferimento di una chiamata al metodo può non essere sempre auspicabile.</span><span class="sxs-lookup"><span data-stu-id="8fa04-117">In other cases, modifying the reference return value of a method call directly may not always be desirable.</span></span> <span data-ttu-id="8fa04-118">Un metodo di ricerca che restituisce una stringa, ad esempio, potrebbe non essere sempre in grado di trovare una corrispondenza.</span><span class="sxs-lookup"><span data-stu-id="8fa04-118">For example, a search method that returns a string may not always find a match.</span></span> <span data-ttu-id="8fa04-119">In tal caso, si desidera modificare il valore restituito di riferimento solo se la ricerca ha esito positivo.</span><span class="sxs-lookup"><span data-stu-id="8fa04-119">In that case, you want to modify the reference return value only if the search is successful.</span></span>

<span data-ttu-id="8fa04-120">Nell'esempio C# seguente viene illustrato questo scenario.</span><span class="sxs-lookup"><span data-stu-id="8fa04-120">The following C# example illustrates this scenario.</span></span> <span data-ttu-id="8fa04-121">Definisce una classe `Sentence` scritta in C# include un metodo `FindNext` che trova la parola successiva in una frase che inizia con una sottostringa specificata.</span><span class="sxs-lookup"><span data-stu-id="8fa04-121">It defines a `Sentence` class written in C# includes a `FindNext` method that finds the next word in a sentence that begins with a specified substring.</span></span> <span data-ttu-id="8fa04-122">La stringa viene restituita come valore di riferimento restituito. Una variabile `Boolean` passata dal riferimento al metodo indica se la ricerca ha avuto esito positivo.</span><span class="sxs-lookup"><span data-stu-id="8fa04-122">The string is returned as a reference return value, and a `Boolean` variable passed by reference to the method indicates whether the search was successful.</span></span> <span data-ttu-id="8fa04-123">Il valore restituito di riferimento indica che il chiamante non solo può leggere il valore restituito. può anche modificarla e tale modifica viene riflessa nei dati contenuti internamente nella classe `Sentence`.</span><span class="sxs-lookup"><span data-stu-id="8fa04-123">The reference return value indicates that the caller can not only read the returned value; he or she can also modify it, and that modification is reflected in the data contained internally in the `Sentence` class.</span></span>

[!code-csharp[Ref-Return](../../../../../samples/snippets/visualbasic/getting-started/ref-returns.cs)]

<span data-ttu-id="8fa04-124">La modifica diretta del valore restituito di riferimento in questo caso non è affidabile, perché la chiamata al metodo potrebbe non riuscire a trovare una corrispondenza e restituire la prima parola nella frase.</span><span class="sxs-lookup"><span data-stu-id="8fa04-124">Directly modifying the reference return value in this case is not reliable, since the method call may fail to find a match and return the first word in the sentence.</span></span> <span data-ttu-id="8fa04-125">In tal caso, il chiamante modificherà inavvertitamente la prima parola della frase.</span><span class="sxs-lookup"><span data-stu-id="8fa04-125">In that case, the caller will inadvertently modify the first word of the sentence.</span></span> <span data-ttu-id="8fa04-126">Questa operazione può essere impedita dal chiamante che restituisce una `null` (o `Nothing` in Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="8fa04-126">This could be prevented by the caller returning a `null` (or `Nothing` in Visual Basic).</span></span> <span data-ttu-id="8fa04-127">In tal caso, tuttavia, il tentativo di modificare una stringa il cui valore è `Nothing` genera un'<xref:System.NullReferenceException>.</span><span class="sxs-lookup"><span data-stu-id="8fa04-127">But in that case, attempting to modify a string whose value is `Nothing` throws a <xref:System.NullReferenceException>.</span></span> <span data-ttu-id="8fa04-128">Se può essere impedito anche dal chiamante che restituisce <xref:System.String.Empty?displayProperty=nameWithType>, ma ciò richiede che il chiamante definisca una variabile di stringa il cui valore è <xref:System.String.Empty?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="8fa04-128">If could also be prevented by the caller returning <xref:System.String.Empty?displayProperty=nameWithType>, but this requires that the caller define a string variable whose value is <xref:System.String.Empty?displayProperty=nameWithType>.</span></span> <span data-ttu-id="8fa04-129">Sebbene il chiamante possa modificare tale stringa, la modifica non ha alcun effetto, perché la stringa modificata non ha alcuna relazione con le parole nella frase archiviata dalla classe `Sentence`.</span><span class="sxs-lookup"><span data-stu-id="8fa04-129">While the caller can modify that string, the modification itself serves no purpose, since the modified string has no relationship to the words in the sentence stored by the `Sentence` class.</span></span>

<span data-ttu-id="8fa04-130">Il modo migliore per gestire questo scenario è passare il valore restituito di riferimento per riferimento a un metodo helper.</span><span class="sxs-lookup"><span data-stu-id="8fa04-130">The best way to handle this scenario is to pass the reference return value by reference to a helper method.</span></span> <span data-ttu-id="8fa04-131">Il metodo helper contiene quindi la logica per determinare se la chiamata al metodo ha avuto esito positivo e, in caso affermativo, per modificare il valore restituito di riferimento.</span><span class="sxs-lookup"><span data-stu-id="8fa04-131">The helper method then contains the logic to determine whether the method call succeeded and, if it did, to modify the reference return value.</span></span> <span data-ttu-id="8fa04-132">Nell'esempio seguente viene fornita un'implementazione possibile.</span><span class="sxs-lookup"><span data-stu-id="8fa04-132">The following example provides a possible implementation.</span></span>

[!code-vb[Ref-Return](../../../../../samples/snippets/visualbasic/getting-started/ref-return-helper.vb#1)]

## <a name="see-also"></a><span data-ttu-id="8fa04-133">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="8fa04-133">See also</span></span>

- [<span data-ttu-id="8fa04-134">Passaggio di argomenti per valore e per riferimento</span><span class="sxs-lookup"><span data-stu-id="8fa04-134">Passing arguments by value and by reference</span></span>](passing-arguments-by-value-and-by-reference.md)
- [<span data-ttu-id="8fa04-135">Routine in Visual Basic</span><span class="sxs-lookup"><span data-stu-id="8fa04-135">Procedures in Visual Basic</span></span>](index.md)
