---
title: Chiave
ms.date: 07/20/2015
f1_keywords:
- vb.AnonymousKey
helpviewer_keywords:
- anonymous types [Visual Basic], key
- Key [Visual Basic]
- Key keyword [Visual Basic]
ms.assetid: 7697a928-7d14-4430-a72a-c9e96e8d6c11
ms.openlocfilehash: 92c8809779d6cab524f67ee47f355b72ab152403
ms.sourcegitcommit: 17ee6605e01ef32506f8fdc686954244ba6911de
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 11/22/2019
ms.locfileid: "74351510"
---
# <a name="key-visual-basic"></a><span data-ttu-id="2b02b-102">Key (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="2b02b-102">Key (Visual Basic)</span></span>
<span data-ttu-id="2b02b-103">La parola chiave `Key` consente di specificare il comportamento per le proprietà dei tipi anonimi.</span><span class="sxs-lookup"><span data-stu-id="2b02b-103">The `Key` keyword enables you to specify behavior for properties of anonymous types.</span></span> <span data-ttu-id="2b02b-104">Solo le proprietà designate come proprietà chiave partecipano ai test di uguaglianza tra le istanze di tipo anonimo o il calcolo dei valori del codice hash.</span><span class="sxs-lookup"><span data-stu-id="2b02b-104">Only properties you designate as key properties participate in tests of equality between anonymous type instances, or calculation of hash code values.</span></span> <span data-ttu-id="2b02b-105">Non è possibile modificare i valori delle proprietà chiave.</span><span class="sxs-lookup"><span data-stu-id="2b02b-105">The values of key properties cannot be changed.</span></span>  
  
 <span data-ttu-id="2b02b-106">Per definire una proprietà di un tipo anonimo come proprietà chiave, inserire la parola chiave `Key` davanti alla relativa dichiarazione nell'elenco di inizializzazione.</span><span class="sxs-lookup"><span data-stu-id="2b02b-106">You designate a property of an anonymous type as a key property by placing the keyword `Key` in front of its declaration in the initialization list.</span></span> <span data-ttu-id="2b02b-107">Nell'esempio seguente `Airline` e `FlightNo` sono proprietà chiave, ma `Gate` non lo è.</span><span class="sxs-lookup"><span data-stu-id="2b02b-107">In the following example, `Airline` and `FlightNo` are key properties, but `Gate` is not.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#26](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class2.vb#26)]  
  
 <span data-ttu-id="2b02b-108">Quando viene creato un nuovo tipo anonimo, esso eredita direttamente da <xref:System.Object>.</span><span class="sxs-lookup"><span data-stu-id="2b02b-108">When a new anonymous type is created, it inherits directly from <xref:System.Object>.</span></span> <span data-ttu-id="2b02b-109">Il compilatore esegue l'override di tre membri ereditati: <xref:System.Object.Equals%2A>, <xref:System.Object.GetHashCode%2A>e <xref:System.Object.ToString%2A>.</span><span class="sxs-lookup"><span data-stu-id="2b02b-109">The compiler overrides three inherited members: <xref:System.Object.Equals%2A>, <xref:System.Object.GetHashCode%2A>, and <xref:System.Object.ToString%2A>.</span></span> <span data-ttu-id="2b02b-110">Il codice di sostituzione prodotto per <xref:System.Object.Equals%2A> e <xref:System.Object.GetHashCode%2A> si basa sulle proprietà chiave.</span><span class="sxs-lookup"><span data-stu-id="2b02b-110">The override code that is produced for <xref:System.Object.Equals%2A> and <xref:System.Object.GetHashCode%2A> is based on key properties.</span></span> <span data-ttu-id="2b02b-111">Se nel tipo non sono presenti proprietà chiave, <xref:System.Object.GetHashCode%2A> e <xref:System.Object.Equals%2A> non vengono sottoposte a override.</span><span class="sxs-lookup"><span data-stu-id="2b02b-111">If there are no key properties in the type, <xref:System.Object.GetHashCode%2A> and <xref:System.Object.Equals%2A> are not overridden.</span></span>  
  
## <a name="equality"></a><span data-ttu-id="2b02b-112">Uguaglianza</span><span class="sxs-lookup"><span data-stu-id="2b02b-112">Equality</span></span>  
 <span data-ttu-id="2b02b-113">Due istanze di tipo anonimo sono uguali se sono istanze dello stesso tipo e se i valori delle relative proprietà chiave sono uguali.</span><span class="sxs-lookup"><span data-stu-id="2b02b-113">Two anonymous type instances are equal if they are instances of the same type and if the values of their key properties are equal.</span></span> <span data-ttu-id="2b02b-114">Negli esempi seguenti `flight2` è uguale a `flight1` dell'esempio precedente, perché sono istanze dello stesso tipo anonimo e hanno valori corrispondenti per le relative proprietà chiave.</span><span class="sxs-lookup"><span data-stu-id="2b02b-114">In the following examples, `flight2` is equal to `flight1` from the previous example because they are instances of the same anonymous type and they have matching values for their key properties.</span></span> <span data-ttu-id="2b02b-115">Tuttavia, `flight3` non è uguale a `flight1` perché ha un valore diverso per una proprietà chiave, `FlightNo`.</span><span class="sxs-lookup"><span data-stu-id="2b02b-115">However, `flight3` is not equal to `flight1` because it has a different value for a key property, `FlightNo`.</span></span> <span data-ttu-id="2b02b-116">L'istanza `flight4` non è dello stesso tipo `flight1` perché designa proprietà diverse come proprietà chiave.</span><span class="sxs-lookup"><span data-stu-id="2b02b-116">Instance `flight4` is not the same type as `flight1` because they designate different properties as key properties.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#27](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class2.vb#27)]  
  
 <span data-ttu-id="2b02b-117">Se due istanze sono dichiarate solo con proprietà non chiave, identiche in nome, tipo, ordine e valore, le due istanze non sono uguali.</span><span class="sxs-lookup"><span data-stu-id="2b02b-117">If two instances are declared with only non-key properties, identical in name, type, order, and value, the two instances are not equal.</span></span> <span data-ttu-id="2b02b-118">Un'istanza senza proprietà chiave è uguale solo a se stessa.</span><span class="sxs-lookup"><span data-stu-id="2b02b-118">An instance without key properties is equal only to itself.</span></span>  
  
 <span data-ttu-id="2b02b-119">Per ulteriori informazioni sulle condizioni in cui due istanze di tipo anonimo sono istanze dello stesso tipo anonimo, vedere [tipi anonimi](../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-types.md).</span><span class="sxs-lookup"><span data-stu-id="2b02b-119">For more information about the conditions under which two anonymous type instances are instances of the same anonymous type, see [Anonymous Types](../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-types.md).</span></span>  
  
## <a name="hash-code-calculation"></a><span data-ttu-id="2b02b-120">Calcolo del codice hash</span><span class="sxs-lookup"><span data-stu-id="2b02b-120">Hash Code Calculation</span></span>  
 <span data-ttu-id="2b02b-121">Come <xref:System.Object.Equals%2A>, la funzione hash definita in <xref:System.Object.GetHashCode%2A> per un tipo anonimo si basa sulle proprietà chiave del tipo.</span><span class="sxs-lookup"><span data-stu-id="2b02b-121">Like <xref:System.Object.Equals%2A>, the hash function that is defined in <xref:System.Object.GetHashCode%2A> for an anonymous type is based on the key properties of the type.</span></span> <span data-ttu-id="2b02b-122">Negli esempi seguenti viene illustrata l'interazione tra le proprietà chiave e i valori del codice hash.</span><span class="sxs-lookup"><span data-stu-id="2b02b-122">The following examples show the interaction between key properties and hash code values.</span></span>  
  
 <span data-ttu-id="2b02b-123">Le istanze di un tipo anonimo che hanno gli stessi valori per tutte le proprietà chiave hanno lo stesso valore di codice hash, anche se le proprietà non chiave non hanno valori corrispondenti.</span><span class="sxs-lookup"><span data-stu-id="2b02b-123">Instances of an anonymous type that have the same values for all key properties have the same hash code value, even if non-key properties do not have matching values.</span></span> <span data-ttu-id="2b02b-124">L'istruzione seguente restituisce `True`.</span><span class="sxs-lookup"><span data-stu-id="2b02b-124">The following statement returns `True`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#37](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class2.vb#37)]  
  
 <span data-ttu-id="2b02b-125">Le istanze di un tipo anonimo con valori diversi per una o più proprietà chiave hanno valori di codice hash diversi.</span><span class="sxs-lookup"><span data-stu-id="2b02b-125">Instances of an anonymous type that have different values for one or more key properties have different hash code values.</span></span> <span data-ttu-id="2b02b-126">L'istruzione seguente restituisce `False`.</span><span class="sxs-lookup"><span data-stu-id="2b02b-126">The following statement returns `False`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#38](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class2.vb#38)]  
  
 <span data-ttu-id="2b02b-127">Le istanze di tipi anonimi che designano proprietà diverse come proprietà chiave non sono istanze dello stesso tipo.</span><span class="sxs-lookup"><span data-stu-id="2b02b-127">Instances of anonymous types that designate different properties as key properties are not instances of the same type.</span></span> <span data-ttu-id="2b02b-128">Hanno valori di codice hash diversi anche quando i nomi e i valori di tutte le proprietà sono uguali.</span><span class="sxs-lookup"><span data-stu-id="2b02b-128">They have different hash code values even when the names and values of all properties are the same.</span></span> <span data-ttu-id="2b02b-129">L'istruzione seguente restituisce `False`.</span><span class="sxs-lookup"><span data-stu-id="2b02b-129">The following statement returns `False`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#39](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class2.vb#39)]  
  
## <a name="read-only-values"></a><span data-ttu-id="2b02b-130">Valori di sola lettura</span><span class="sxs-lookup"><span data-stu-id="2b02b-130">Read-Only Values</span></span>  
 <span data-ttu-id="2b02b-131">Non è possibile modificare i valori delle proprietà chiave.</span><span class="sxs-lookup"><span data-stu-id="2b02b-131">The values of key properties cannot be changed.</span></span> <span data-ttu-id="2b02b-132">Ad esempio, in `flight1` degli esempi precedenti, i campi `Airline` e `FlightNo` sono di sola lettura, ma è possibile modificare `Gate`.</span><span class="sxs-lookup"><span data-stu-id="2b02b-132">For example, in `flight1` in the earlier examples, the `Airline` and `FlightNo` fields are read-only, but `Gate` can be changed.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#28](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class2.vb#28)]  
  
## <a name="see-also"></a><span data-ttu-id="2b02b-133">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="2b02b-133">See also</span></span>

- [<span data-ttu-id="2b02b-134">Definizione di tipo anonimo</span><span class="sxs-lookup"><span data-stu-id="2b02b-134">Anonymous Type Definition</span></span>](../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-type-definition.md)
- [<span data-ttu-id="2b02b-135">Procedura: Dedurre tipi e nomi di proprietà nelle dichiarazioni di tipo anonimo</span><span class="sxs-lookup"><span data-stu-id="2b02b-135">How to: Infer Property Names and Types in Anonymous Type Declarations</span></span>](../../../visual-basic/programming-guide/language-features/objects-and-classes/how-to-infer-property-names-and-types-in-anonymous-type-declarations.md)
- [<span data-ttu-id="2b02b-136">Tipi anonimi</span><span class="sxs-lookup"><span data-stu-id="2b02b-136">Anonymous Types</span></span>](../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-types.md)
