---
title: 'Concorrenza ottimistica: Panoramica'
ms.date: 03/30/2017
ms.assetid: c2e38512-d0c8-4807-b30a-cb7e30338694
ms.openlocfilehash: a61d4c5b35f3797539fe845045b8a959b0351350
ms.sourcegitcommit: 68653db98c5ea7744fd438710248935f70020dfb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/22/2019
ms.locfileid: "69938622"
---
# <a name="optimistic-concurrency-overview"></a><span data-ttu-id="09a5c-102">Concorrenza ottimistica: Panoramica</span><span class="sxs-lookup"><span data-stu-id="09a5c-102">Optimistic Concurrency: Overview</span></span>
<span data-ttu-id="09a5c-103">In [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] è supportato il controllo della concorrenza ottimistica.</span><span class="sxs-lookup"><span data-stu-id="09a5c-103">[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] supports optimistic concurrency control.</span></span> <span data-ttu-id="09a5c-104">Nella tabella seguente vengono descritte le condizioni che si applicano alla concorrenza [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] ottimistica nella documentazione di:</span><span class="sxs-lookup"><span data-stu-id="09a5c-104">The following table describes terms that apply to optimistic concurrency in [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] documentation:</span></span>  
  
|<span data-ttu-id="09a5c-105">Termini</span><span class="sxs-lookup"><span data-stu-id="09a5c-105">Terms</span></span>|<span data-ttu-id="09a5c-106">Descrizione</span><span class="sxs-lookup"><span data-stu-id="09a5c-106">Description</span></span>|  
|-----------|-----------------|  
|<span data-ttu-id="09a5c-107">concurrency</span><span class="sxs-lookup"><span data-stu-id="09a5c-107">concurrency</span></span>|<span data-ttu-id="09a5c-108">Situazione in cui due o più utenti tentano contemporaneamente di aggiornare la stessa riga del database.</span><span class="sxs-lookup"><span data-stu-id="09a5c-108">The situation in which two or more users at the same time try to update the same database row.</span></span>|  
|<span data-ttu-id="09a5c-109">conflitto di concorrenza</span><span class="sxs-lookup"><span data-stu-id="09a5c-109">concurrency conflict</span></span>|<span data-ttu-id="09a5c-110">Situazione in cui due o più utenti tentano contemporaneamente di inviare valori in conflitto a una o più colonne di una riga.</span><span class="sxs-lookup"><span data-stu-id="09a5c-110">The situation in which two or more users at the same time try to submit conflicting values to one or more columns of a row.</span></span>|  
|<span data-ttu-id="09a5c-111">controllo della concorrenza</span><span class="sxs-lookup"><span data-stu-id="09a5c-111">concurrency control</span></span>|<span data-ttu-id="09a5c-112">Tecnica usata per risolvere i conflitti di concorrenza.</span><span class="sxs-lookup"><span data-stu-id="09a5c-112">The technique used to resolve concurrency conflicts.</span></span>|  
|<span data-ttu-id="09a5c-113">controllo di concorrenza ottimistica</span><span class="sxs-lookup"><span data-stu-id="09a5c-113">optimistic concurrency control</span></span>|<span data-ttu-id="09a5c-114">Tecnica che consente di esaminare se i valori presenti in una riga in altre transazioni sono stati modificati prima di consentire l'invio di modifiche.</span><span class="sxs-lookup"><span data-stu-id="09a5c-114">The technique that first investigates whether other transactions have changed values in a row before permitting changes to be submitted.</span></span><br /><br /> <span data-ttu-id="09a5c-115">Si differenzia dal *controllo della concorrenza pessimistica*, che blocca il record per evitare conflitti di concorrenza.</span><span class="sxs-lookup"><span data-stu-id="09a5c-115">Contrast with *pessimistic concurrency control*, which locks the record to avoid concurrency conflicts.</span></span><br /><br /> <span data-ttu-id="09a5c-116">Il controllo ottimistico è così definito poiché considera improbabile che una transazione interferisca con un'altra.</span><span class="sxs-lookup"><span data-stu-id="09a5c-116">*Optimistic* control is so termed because it considers the chances of one transaction interfering with another to be unlikely.</span></span>|  
|<span data-ttu-id="09a5c-117">risoluzione dei conflitti</span><span class="sxs-lookup"><span data-stu-id="09a5c-117">conflict resolution</span></span>|<span data-ttu-id="09a5c-118">Processo di aggiornamento di un elemento in conflitto mediante la riesecuzione di una query sul database e la risoluzione delle differenze.</span><span class="sxs-lookup"><span data-stu-id="09a5c-118">The process of refreshing a conflicting item by querying the database again and then reconciling differences.</span></span><br /><br /> <span data-ttu-id="09a5c-119">Quando un oggetto viene aggiornato, la funzionalità di ricerca delle modifiche di [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] conserva i dati seguenti:</span><span class="sxs-lookup"><span data-stu-id="09a5c-119">When an object is refreshed, the [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] change tracker holds the following data:</span></span><br /><br /> <span data-ttu-id="09a5c-120">: I valori originariamente ricavati dal database e usati per il controllo degli aggiornamenti.</span><span class="sxs-lookup"><span data-stu-id="09a5c-120">-   The values originally taken from the database and used for the update check.</span></span><br /><span data-ttu-id="09a5c-121">-I nuovi valori del database della query successiva.</span><span class="sxs-lookup"><span data-stu-id="09a5c-121">-   The new database values from the subsequent query.</span></span><br /><br /> [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] <span data-ttu-id="09a5c-122">determina quindi se l'oggetto è in conflitto, ovvero se uno o più valori del membro sono stati modificati.</span><span class="sxs-lookup"><span data-stu-id="09a5c-122">then determines whether the object is in conflict (that is, whether one or more of its member values has changed).</span></span> <span data-ttu-id="09a5c-123">Se l'oggetto è in conflitto, [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] determina quindi quale dei suoi membri sono in conflitto.</span><span class="sxs-lookup"><span data-stu-id="09a5c-123">If the object is in conflict, [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] next determines which of its members are in conflict.</span></span><br /><br /> <span data-ttu-id="09a5c-124">Qualsiasi conflitto fra membri individuato da [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] viene aggiunto a un elenco di conflitti.</span><span class="sxs-lookup"><span data-stu-id="09a5c-124">Any member conflict that [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] discovers is added to a conflict list.</span></span>|  
  
 <span data-ttu-id="09a5c-125">Nel modello a oggetti,siverificaunconflittodiconcorrenzaottimisticaquandosonosoddisfatteentrambelecondizioni[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] seguenti:</span><span class="sxs-lookup"><span data-stu-id="09a5c-125">In the [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] object model, an *optimistic concurrency conflict* occurs when both of the following conditions are true:</span></span>  
  
- <span data-ttu-id="09a5c-126">Il client tenta di inviare modifiche al database.</span><span class="sxs-lookup"><span data-stu-id="09a5c-126">The client tries to submit changes to the database.</span></span>  
  
- <span data-ttu-id="09a5c-127">Uno o più valori di controllo degli aggiornamenti sono stati aggiornati nel database dall'ultima lettura effettuata dal client.</span><span class="sxs-lookup"><span data-stu-id="09a5c-127">One or more update-check values have been updated in the database since the client last read them.</span></span>  
  
 <span data-ttu-id="09a5c-128">Per risolvere questo conflitto, è necessario individuare i membri dell'oggetto in conflitto, quindi decidere come procedere.</span><span class="sxs-lookup"><span data-stu-id="09a5c-128">Resolution of this conflict includes discovering which members of the object are in conflict, and then deciding what you want to do about it.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="09a5c-129">Solo i membri di cui è stato eseguito il mapping come <xref:System.Data.Linq.Mapping.UpdateCheck.Always> o <xref:System.Data.Linq.Mapping.UpdateCheck.WhenChanged> fanno parte dei controlli di concorrenza ottimistica.</span><span class="sxs-lookup"><span data-stu-id="09a5c-129">Only members mapped as <xref:System.Data.Linq.Mapping.UpdateCheck.Always> or <xref:System.Data.Linq.Mapping.UpdateCheck.WhenChanged> participate in optimistic concurrency checks.</span></span> <span data-ttu-id="09a5c-130">Per i membri contrassegnati come <xref:System.Data.Linq.Mapping.UpdateCheck.Never> non viene eseguito alcun controllo.</span><span class="sxs-lookup"><span data-stu-id="09a5c-130">No check is performed for members marked <xref:System.Data.Linq.Mapping.UpdateCheck.Never>.</span></span> <span data-ttu-id="09a5c-131">Per altre informazioni, vedere <xref:System.Data.Linq.Mapping.UpdateCheck>.</span><span class="sxs-lookup"><span data-stu-id="09a5c-131">For more information, see <xref:System.Data.Linq.Mapping.UpdateCheck>.</span></span>  
  
## <a name="example"></a><span data-ttu-id="09a5c-132">Esempio</span><span class="sxs-lookup"><span data-stu-id="09a5c-132">Example</span></span>  
 <span data-ttu-id="09a5c-133">Nel seguente scenario, ad esempio, User1 prepara un aggiornamento mediante l'esecuzione di una query su una riga del database.</span><span class="sxs-lookup"><span data-stu-id="09a5c-133">For example, in the following scenario, User1 starts to prepare an update by querying the database for a row.</span></span> <span data-ttu-id="09a5c-134">User1 riceve una riga con i valori Alfreds, Maria e Sales.</span><span class="sxs-lookup"><span data-stu-id="09a5c-134">User1 receives a row with values of Alfreds, Maria, and Sales.</span></span>  
  
 <span data-ttu-id="09a5c-135">User1 desidera modificare il valore della colonna Manager in Alfred e il valore della colonna Department in Marketing.</span><span class="sxs-lookup"><span data-stu-id="09a5c-135">User1 wants to change the value of the Manager column to Alfred and the value of the Department column to Marketing.</span></span> <span data-ttu-id="09a5c-136">Prima che User1 possa inviare le modifiche, User2 ha già inviato le proprie modifiche al database.</span><span class="sxs-lookup"><span data-stu-id="09a5c-136">Before User1 can submit those changes, User2 has submitted changes to the database.</span></span> <span data-ttu-id="09a5c-137">Ora il valore della colonna Assistant è stato modificato in Mary e il valore della colonna Department è cambiato in Service.</span><span class="sxs-lookup"><span data-stu-id="09a5c-137">So now the value of the Assistant column has been changed to Mary and the value of the Department column to Service.</span></span>  
  
 <span data-ttu-id="09a5c-138">Quando User1 tenta di inviare le modifiche, l'invio non viene completato e viene generata un'eccezione <xref:System.Data.Linq.ChangeConflictException>.</span><span class="sxs-lookup"><span data-stu-id="09a5c-138">When User1 now tries to submit changes, the submission fails and a <xref:System.Data.Linq.ChangeConflictException> exception is thrown.</span></span> <span data-ttu-id="09a5c-139">Questo risultato si verifica perché i valori del database per le colonna Assistant e Department non sono quelli previsti.</span><span class="sxs-lookup"><span data-stu-id="09a5c-139">This result occurs because the database values for the Assistant column and the Department column are not those that were expected.</span></span> <span data-ttu-id="09a5c-140">I membri che rappresentano le colonne Assistant e Department sono in conflitto.</span><span class="sxs-lookup"><span data-stu-id="09a5c-140">Members representing the Assistant and Department columns are in conflict.</span></span> <span data-ttu-id="09a5c-141">Nella tabella seguente è riepilogata questa situazione:</span><span class="sxs-lookup"><span data-stu-id="09a5c-141">The following table summarizes the situation.</span></span>  
  
||<span data-ttu-id="09a5c-142">Manager</span><span class="sxs-lookup"><span data-stu-id="09a5c-142">Manager</span></span>|<span data-ttu-id="09a5c-143">Assistant</span><span class="sxs-lookup"><span data-stu-id="09a5c-143">Assistant</span></span>|<span data-ttu-id="09a5c-144">department</span><span class="sxs-lookup"><span data-stu-id="09a5c-144">Department</span></span>|  
|------|-------------|---------------|----------------|  
|<span data-ttu-id="09a5c-145">Stato originale</span><span class="sxs-lookup"><span data-stu-id="09a5c-145">Original state</span></span>|<span data-ttu-id="09a5c-146">Alfreds</span><span class="sxs-lookup"><span data-stu-id="09a5c-146">Alfreds</span></span>|<span data-ttu-id="09a5c-147">Maria</span><span class="sxs-lookup"><span data-stu-id="09a5c-147">Maria</span></span>|<span data-ttu-id="09a5c-148">Sales</span><span class="sxs-lookup"><span data-stu-id="09a5c-148">Sales</span></span>|  
|<span data-ttu-id="09a5c-149">Utente1</span><span class="sxs-lookup"><span data-stu-id="09a5c-149">User1</span></span>|<span data-ttu-id="09a5c-150">Alfred</span><span class="sxs-lookup"><span data-stu-id="09a5c-150">Alfred</span></span>||<span data-ttu-id="09a5c-151">Marketing</span><span class="sxs-lookup"><span data-stu-id="09a5c-151">Marketing</span></span>|  
|<span data-ttu-id="09a5c-152">User2</span><span class="sxs-lookup"><span data-stu-id="09a5c-152">User2</span></span>||<span data-ttu-id="09a5c-153">Mary</span><span class="sxs-lookup"><span data-stu-id="09a5c-153">Mary</span></span>|<span data-ttu-id="09a5c-154">Service</span><span class="sxs-lookup"><span data-stu-id="09a5c-154">Service</span></span>|  
  
 <span data-ttu-id="09a5c-155">È possibile risolvere questo tipo di conflitti in diversi modi.</span><span class="sxs-lookup"><span data-stu-id="09a5c-155">You can resolve conflicts such as this in different ways.</span></span> <span data-ttu-id="09a5c-156">Per altre informazioni, vedere [Procedura: Gestire i conflitti](../../../../../../docs/framework/data/adonet/sql/linq/how-to-manage-change-conflicts.md)di modifica.</span><span class="sxs-lookup"><span data-stu-id="09a5c-156">For more information, see [How to: Manage Change Conflicts](../../../../../../docs/framework/data/adonet/sql/linq/how-to-manage-change-conflicts.md).</span></span>  
  
## <a name="conflict-detection-and-resolution-checklist"></a><span data-ttu-id="09a5c-157">Elenco di controllo per il rilevamento e la risoluzione dei conflitti</span><span class="sxs-lookup"><span data-stu-id="09a5c-157">Conflict Detection and Resolution Checklist</span></span>  
 <span data-ttu-id="09a5c-158">È possibile rilevare e risolvere i conflitti a qualsiasi livello di dettaglio.</span><span class="sxs-lookup"><span data-stu-id="09a5c-158">You can detect and resolve conflicts at any level of detail.</span></span> <span data-ttu-id="09a5c-159">Da una parte è possibile risolvere tutti i conflitti usando una delle tre modalità disponibili (vedere <xref:System.Data.Linq.RefreshMode>) senza ulteriori considerazioni.</span><span class="sxs-lookup"><span data-stu-id="09a5c-159">At one extreme, you can resolve all conflicts in one of three ways (see <xref:System.Data.Linq.RefreshMode>) without additional consideration.</span></span> <span data-ttu-id="09a5c-160">Dall'altra è possibile definire un'azione specifica per ogni tipo di conflitto e per ogni membro in conflitto.</span><span class="sxs-lookup"><span data-stu-id="09a5c-160">At the other extreme, you can designate a specific action for each type of conflict on every member in conflict.</span></span>  
  
- <span data-ttu-id="09a5c-161">Specificare o modificare le opzioni per <xref:System.Data.Linq.Mapping.UpdateCheck> nel modello a oggetti.</span><span class="sxs-lookup"><span data-stu-id="09a5c-161">Specify or revise <xref:System.Data.Linq.Mapping.UpdateCheck> options in your object model.</span></span>  
  
     <span data-ttu-id="09a5c-162">Per altre informazioni, vedere [Procedura: Specificare i membri sottoposti a test per i](../../../../../../docs/framework/data/adonet/sql/linq/how-to-specify-which-members-are-tested-for-concurrency-conflicts.md)conflitti di concorrenza.</span><span class="sxs-lookup"><span data-stu-id="09a5c-162">For more information, see [How to: Specify Which Members are Tested for Concurrency Conflicts](../../../../../../docs/framework/data/adonet/sql/linq/how-to-specify-which-members-are-tested-for-concurrency-conflicts.md).</span></span>  
  
- <span data-ttu-id="09a5c-163">Nel blocco try/catch della chiamata a <xref:System.Data.Linq.DataContext.SubmitChanges%2A> specificare a che punto dovranno essere generate eccezioni.</span><span class="sxs-lookup"><span data-stu-id="09a5c-163">In the try/catch block of your call to <xref:System.Data.Linq.DataContext.SubmitChanges%2A>, specify at what point you want exceptions to be thrown.</span></span>  
  
     <span data-ttu-id="09a5c-164">Per altre informazioni, vedere [Procedura: Consente di specificare quando vengono generate](../../../../../../docs/framework/data/adonet/sql/linq/how-to-specify-when-concurrency-exceptions-are-thrown.md)eccezioni di concorrenza.</span><span class="sxs-lookup"><span data-stu-id="09a5c-164">For more information, see [How to: Specify When Concurrency Exceptions are Thrown](../../../../../../docs/framework/data/adonet/sql/linq/how-to-specify-when-concurrency-exceptions-are-thrown.md).</span></span>  
  
- <span data-ttu-id="09a5c-165">Determinare la quantità di dettagli sul conflitto da recuperare, quindi includere nel blocco try/catch il codice necessario.</span><span class="sxs-lookup"><span data-stu-id="09a5c-165">Determine how much conflict detail you want to retrieve, and include code in your try/catch block accordingly.</span></span>  
  
     <span data-ttu-id="09a5c-166">Per altre informazioni, vedere [Procedura: Recuperare informazioni sui](../../../../../../docs/framework/data/adonet/sql/linq/how-to-retrieve-entity-conflict-information.md) conflitti di [entità e procedura: Recuperare le informazioni sui](../../../../../../docs/framework/data/adonet/sql/linq/how-to-retrieve-member-conflict-information.md)conflitti dei membri.</span><span class="sxs-lookup"><span data-stu-id="09a5c-166">For more information, see [How to: Retrieve Entity Conflict Information](../../../../../../docs/framework/data/adonet/sql/linq/how-to-retrieve-entity-conflict-information.md) and [How to: Retrieve Member Conflict Information](../../../../../../docs/framework/data/adonet/sql/linq/how-to-retrieve-member-conflict-information.md).</span></span>  
  
- <span data-ttu-id="09a5c-167">Includere nel `try` / codice comesidesiderarisolvereidiversiconflittiindividuati.`catch`</span><span class="sxs-lookup"><span data-stu-id="09a5c-167">Include in your `try`/`catch` code how you want to resolve the various conflicts you discover.</span></span>  
  
     <span data-ttu-id="09a5c-168">Per altre informazioni, vedere [Procedura: Risolvere i conflitti mantenendo i valori](../../../../../../docs/framework/data/adonet/sql/linq/how-to-resolve-conflicts-by-retaining-database-values.md)del database, [procedura: Risolvere i conflitti sovrascrivendo i](../../../../../../docs/framework/data/adonet/sql/linq/how-to-resolve-conflicts-by-overwriting-database-values.md)valori del [database e procedura: Risolvere i conflitti mediante l'Unione con](../../../../../../docs/framework/data/adonet/sql/linq/how-to-resolve-conflicts-by-merging-with-database-values.md)i valori del database.</span><span class="sxs-lookup"><span data-stu-id="09a5c-168">For more information, see [How to: Resolve Conflicts by Retaining Database Values](../../../../../../docs/framework/data/adonet/sql/linq/how-to-resolve-conflicts-by-retaining-database-values.md), [How to: Resolve Conflicts by Overwriting Database Values](../../../../../../docs/framework/data/adonet/sql/linq/how-to-resolve-conflicts-by-overwriting-database-values.md), and [How to: Resolve Conflicts by Merging with Database Values](../../../../../../docs/framework/data/adonet/sql/linq/how-to-resolve-conflicts-by-merging-with-database-values.md).</span></span>  
  
## <a name="linq-to-sql-types-that-support-conflict-discovery-and-resolution"></a><span data-ttu-id="09a5c-169">Tipi LINQ to SQL che supportano l'individuazione e la risoluzione dei conflitti</span><span class="sxs-lookup"><span data-stu-id="09a5c-169">LINQ to SQL Types That Support Conflict Discovery and Resolution</span></span>  
 <span data-ttu-id="09a5c-170">Di seguito sono elencate le classi e le funzionalità di [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] che supportano la risoluzione di conflitti nella concorrenza ottimistica:</span><span class="sxs-lookup"><span data-stu-id="09a5c-170">Classes and features to support the resolution of conflicts in optimistic concurrency in [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] include the following:</span></span>  
  
- <xref:System.Data.Linq.ObjectChangeConflict?displayProperty=nameWithType>  
  
- <xref:System.Data.Linq.MemberChangeConflict?displayProperty=nameWithType>  
  
- <xref:System.Data.Linq.ChangeConflictCollection?displayProperty=nameWithType>  
  
- <xref:System.Data.Linq.ChangeConflictException?displayProperty=nameWithType>  
  
- <xref:System.Data.Linq.DataContext.ChangeConflicts%2A?displayProperty=nameWithType>  
  
- <xref:System.Data.Linq.DataContext.SubmitChanges%2A?displayProperty=nameWithType>  
  
- <xref:System.Data.Linq.DataContext.Refresh%2A?displayProperty=nameWithType>  
  
- <xref:System.Data.Linq.Mapping.ColumnAttribute.UpdateCheck%2A?displayProperty=nameWithType>  
  
- <xref:System.Data.Linq.Mapping.UpdateCheck?displayProperty=nameWithType>  
  
- <xref:System.Data.Linq.RefreshMode?displayProperty=nameWithType>  
  
## <a name="see-also"></a><span data-ttu-id="09a5c-171">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="09a5c-171">See also</span></span>

- [<span data-ttu-id="09a5c-172">Procedura: Gestione dei conflitti di modifica</span><span class="sxs-lookup"><span data-stu-id="09a5c-172">How to: Manage Change Conflicts</span></span>](../../../../../../docs/framework/data/adonet/sql/linq/how-to-manage-change-conflicts.md)
