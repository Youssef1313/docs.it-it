---
title: 'Procedura: Archiviare e riutilizzare query'
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: a012bd79-1809-45e3-adea-0229532396cc
ms.openlocfilehash: f8400b214bc9ba3a28eeec05f6171953b42bc6f5
ms.sourcegitcommit: 68653db98c5ea7744fd438710248935f70020dfb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/22/2019
ms.locfileid: "69938749"
---
# <a name="how-to-store-and-reuse-queries"></a><span data-ttu-id="591d6-102">Procedura: Archiviare e riutilizzare query</span><span class="sxs-lookup"><span data-stu-id="591d6-102">How to: Store and Reuse Queries</span></span>
<span data-ttu-id="591d6-103">Quando si usa un'applicazione che esegue molte volte query strutturalmente simili, è spesso possibile migliorare le prestazioni compilando la query una volta ed eseguendola più volte con parametri diversi.</span><span class="sxs-lookup"><span data-stu-id="591d6-103">When you have an application that executes structurally similar queries many times, you can often increase performance by compiling the query one time and executing it several times with different parameters.</span></span> <span data-ttu-id="591d6-104">Un'applicazione potrebbe ad esempio essere usata per recuperare tutti i clienti di una determinata città, specificata in fase di runtime dall'utente in un modulo.</span><span class="sxs-lookup"><span data-stu-id="591d6-104">For example, an application might have to retrieve all the customers who are in a particular city, where the city is specified at runtime by the user in a form.</span></span> [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]<span data-ttu-id="591d6-105">supporta l'utilizzo di *query* compilate per questo scopo.</span><span class="sxs-lookup"><span data-stu-id="591d6-105">supports the use of *compiled queries* for this purpose.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="591d6-106">Questo modello di utilizzo rappresenta il metodo più comune di uso delle query compilate.</span><span class="sxs-lookup"><span data-stu-id="591d6-106">This pattern of usage represents the most common use for compiled queries.</span></span> <span data-ttu-id="591d6-107">Sono tuttavia possibili altri approcci.</span><span class="sxs-lookup"><span data-stu-id="591d6-107">Other approaches are possible.</span></span> <span data-ttu-id="591d6-108">Ad esempio, le query compilate possono essere archiviate come membri statici in una classe parziale che estende il codice generato dalla finestra di progettazione.</span><span class="sxs-lookup"><span data-stu-id="591d6-108">For example, compiled queries can be stored as static members on a partial class that extends the code generated by the designer.</span></span>  
  
## <a name="example"></a><span data-ttu-id="591d6-109">Esempio</span><span class="sxs-lookup"><span data-stu-id="591d6-109">Example</span></span>  
 <span data-ttu-id="591d6-110">In molti scenari è possibile riutilizzare le query oltre i limiti dei thread.</span><span class="sxs-lookup"><span data-stu-id="591d6-110">In many scenarios you might want to reuse the queries across thread boundaries.</span></span> <span data-ttu-id="591d6-111">In questi casi l'archiviazione delle query compilate in variabili statiche è particolarmente efficace.</span><span class="sxs-lookup"><span data-stu-id="591d6-111">In such cases, storing the compiled queries in static variables is especially effective.</span></span> <span data-ttu-id="591d6-112">Nell'esempio di codice riportato di seguito si presuppone una classe `Queries` progettata per archiviare le query compilate e una classe Northwind che rappresenta un oggetto <xref:System.Data.Linq.DataContext> fortemente tipizzato.</span><span class="sxs-lookup"><span data-stu-id="591d6-112">The following code example assumes a `Queries` class designed to store compiled queries, and assumes a Northwind class that represents a strongly typed <xref:System.Data.Linq.DataContext>.</span></span>  
  
 [!code-csharp[DLinqQuerying#6](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqQuerying/cs/Program.cs#6)]
 [!code-vb[DLinqQuerying#6](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqQuerying/vb/Module1.vb#6)]  
  
 [!code-csharp[DLinqQuerying#7](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqQuerying/cs/Program.cs#7)]
 [!code-vb[DLinqQuerying#7](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqQuerying/vb/Module1.vb#7)]  
  
## <a name="example"></a><span data-ttu-id="591d6-113">Esempio</span><span class="sxs-lookup"><span data-stu-id="591d6-113">Example</span></span>  
 <span data-ttu-id="591d6-114">Attualmente non è possibile archiviare (in variabili statiche) query che restituiscono un *tipo anonimo*, perché il tipo non ha alcun nome da fornire come argomento generico.</span><span class="sxs-lookup"><span data-stu-id="591d6-114">You cannot currently store (in static variables) queries that return an *anonymous type*, because type has no name to provide as a generic argument.</span></span> <span data-ttu-id="591d6-115">Nell'esempio riportato di seguito viene descritto come risolvere questo problema creando un tipo in grado di rappresentare il risultato, quindi utilizzandolo come argomento generico.</span><span class="sxs-lookup"><span data-stu-id="591d6-115">The following example shows how you can work around the issue by creating a type that can represent the result, and then use it as a generic argument.</span></span>  
  
 [!code-csharp[DLinqQuerying#8](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqQuerying/cs/Program.cs#8)]
 [!code-vb[DLinqQuerying#8](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqQuerying/vb/Module1.vb#8)]  
  
## <a name="see-also"></a><span data-ttu-id="591d6-116">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="591d6-116">See also</span></span>

- <xref:System.Data.Linq.CompiledQuery>
- [<span data-ttu-id="591d6-117">Concetti relativi alle query</span><span class="sxs-lookup"><span data-stu-id="591d6-117">Query Concepts</span></span>](../../../../../../docs/framework/data/adonet/sql/linq/query-concepts.md)
- [<span data-ttu-id="591d6-118">Esecuzione di query sul database</span><span class="sxs-lookup"><span data-stu-id="591d6-118">Querying the Database</span></span>](../../../../../../docs/framework/data/adonet/sql/linq/querying-the-database.md)
