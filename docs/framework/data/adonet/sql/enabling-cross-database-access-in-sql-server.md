---
title: Abilitazione dell'accesso tra database in SQL Server
ms.date: 03/30/2017
ms.assetid: 10663fb6-434c-4c81-8178-ec894b9cf895
ms.openlocfilehash: bf46d43f5ac9b0a385e9bc6da1546af1d67a282d
ms.sourcegitcommit: ad800f019ac976cb669e635fb0ea49db740e6890
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/29/2019
ms.locfileid: "73040238"
---
# <a name="enabling-cross-database-access-in-sql-server"></a><span data-ttu-id="4e7bc-102">Abilitazione dell'accesso tra database in SQL Server</span><span class="sxs-lookup"><span data-stu-id="4e7bc-102">Enabling Cross-Database Access in SQL Server</span></span>
<span data-ttu-id="4e7bc-103">Il concatenamento della proprietà tra database si verifica quando una procedura di un database dipende dagli oggetti di un altro.</span><span class="sxs-lookup"><span data-stu-id="4e7bc-103">Cross-database ownership chaining occurs when a procedure in one database depends on objects in another database.</span></span> <span data-ttu-id="4e7bc-104">Una catena di proprietà tra database funziona allo stesso modo del concatenamento della proprietà con un singolo database, ad eccezione del fatto che una catena di proprietà non interrotta richiede che tutti i proprietari degli oggetti siano mappati allo stesso account di accesso.</span><span class="sxs-lookup"><span data-stu-id="4e7bc-104">A cross-database ownership chain works in the same way as ownership chaining within a single database, except that an unbroken ownership chain requires that all the object owners are mapped to the same login account.</span></span> <span data-ttu-id="4e7bc-105">Se l'oggetto di origine nel database di origine e gli oggetti di destinazione nei database di destinazione appartengono allo stesso account di accesso, le autorizzazioni sugli oggetti di destinazione non verranno controllate in SQL Server.</span><span class="sxs-lookup"><span data-stu-id="4e7bc-105">If the source object in the source database and the target objects in the target databases are owned by the same login account, SQL Server does not check permissions on the target objects.</span></span>  
  
## <a name="off-by-default"></a><span data-ttu-id="4e7bc-106">Disattivazione per impostazione predefinita</span><span class="sxs-lookup"><span data-stu-id="4e7bc-106">Off By Default</span></span>  
 <span data-ttu-id="4e7bc-107">Il concatenamento della proprietà tra database è disattivato per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="4e7bc-107">Ownership chaining across databases is turned off by default.</span></span> <span data-ttu-id="4e7bc-108">Microsoft consiglia di disabilitare questa funzionalità perché espone la sicurezza ai seguenti rischi:</span><span class="sxs-lookup"><span data-stu-id="4e7bc-108">Microsoft recommends that you disable cross-database ownership chaining because it exposes you to the following security risks:</span></span>  
  
- <span data-ttu-id="4e7bc-109">I proprietari dei database e i membri dei ruoli di database `db_ddladmin` o `db_owners` possono creare oggetti appartenenti ad altri utenti.</span><span class="sxs-lookup"><span data-stu-id="4e7bc-109">Database owners and members of the `db_ddladmin` or the `db_owners` database roles can create objects that are owned by other users.</span></span> <span data-ttu-id="4e7bc-110">Questi oggetti possono avere come destinazione gli oggetti di altri database,</span><span class="sxs-lookup"><span data-stu-id="4e7bc-110">These objects can potentially target objects in other databases.</span></span> <span data-ttu-id="4e7bc-111">il che significa che se si abilita il concatenamento della proprietà tra database, è necessario considerare completamente attendibili questi utenti per i dati di tutti i database.</span><span class="sxs-lookup"><span data-stu-id="4e7bc-111">This means that if you enable cross-database ownership chaining, you must fully trust these users with data in all databases.</span></span>  
  
- <span data-ttu-id="4e7bc-112">Gli utenti con l'autorizzazione CREATE DATABASE possono creare nuovi database e collegare database esistenti.</span><span class="sxs-lookup"><span data-stu-id="4e7bc-112">Users with CREATE DATABASE permission can create new databases and attach existing databases.</span></span> <span data-ttu-id="4e7bc-113">Se il concatenamento della proprietà tra database è abilitato, questi utenti possono accedere ad oggetti di altri database per cui potrebbero non disporre di privilegi dai database appena creati o collegati.</span><span class="sxs-lookup"><span data-stu-id="4e7bc-113">If cross-database ownership chaining is enabled, these users can access objects in other databases that they might not have privileges in from the newly created or attached databases that they create.</span></span>  
  
## <a name="enabling-cross-database-ownership-chaining"></a><span data-ttu-id="4e7bc-114">Abilitazione del concatenamento della proprietà tra database</span><span class="sxs-lookup"><span data-stu-id="4e7bc-114">Enabling Cross-database Ownership Chaining</span></span>  
 <span data-ttu-id="4e7bc-115">Il concatenamento della proprietà tra database deve essere abilitato solo negli ambienti in cui gli utenti con privilegi elevati possono essere considerati completamente attendibili.</span><span class="sxs-lookup"><span data-stu-id="4e7bc-115">Cross-database ownership chaining should only be enabled in environments where you can fully trust highly-privileged users.</span></span> <span data-ttu-id="4e7bc-116">Questa funzionalità può essere configurata durante l'installazione per tutti i database o in modo selettivo per specifici database utilizzando i comandi Transact-SQL `sp_configure` e `ALTER DATABASE`.</span><span class="sxs-lookup"><span data-stu-id="4e7bc-116">It can be configured during setup for all databases, or selectively for specific databases using the Transact-SQL commands `sp_configure` and `ALTER DATABASE`.</span></span>  
  
 <span data-ttu-id="4e7bc-117">Per configurare in modo selettivo questa funzionalità, usare `sp_configure` per disattivarla per il server.</span><span class="sxs-lookup"><span data-stu-id="4e7bc-117">To selectively configure cross-database ownership chaining, use `sp_configure` to turn it off for the server.</span></span> <span data-ttu-id="4e7bc-118">Usare quindi il comando ALTER DATABASE con SET DB_CHAINING ON per configurare il concatenamento della proprietà tra database solo per i database per cui è necessario.</span><span class="sxs-lookup"><span data-stu-id="4e7bc-118">Then use the ALTER DATABASE command with SET DB_CHAINING ON to configure cross-database ownership chaining for only the databases that require it.</span></span>  
  
 <span data-ttu-id="4e7bc-119">Nell'esempio seguente si attiva il concatenamento della proprietà tra database per tutti i database:</span><span class="sxs-lookup"><span data-stu-id="4e7bc-119">The following sample turns on cross-database ownership chaining for all databases:</span></span>  
  
```sql
EXECUTE sp_configure 'show advanced', 1;  
RECONFIGURE;  
EXECUTE sp_configure 'cross db ownership chaining', 1;  
RECONFIGURE;  
```  
  
 <span data-ttu-id="4e7bc-120">Nell'esempio seguente si attiva il concatenamento della proprietà tra database per database specifici:</span><span class="sxs-lookup"><span data-stu-id="4e7bc-120">The following sample turns on cross-database ownership chaining for specific databases:</span></span>  
  
```sql
ALTER DATABASE Database1 SET DB_CHAINING ON;  
ALTER DATABASE Database2 SET DB_CHAINING ON;  
```  
  
### <a name="dynamic-sql"></a><span data-ttu-id="4e7bc-121">SQL dinamico</span><span class="sxs-lookup"><span data-stu-id="4e7bc-121">Dynamic SQL</span></span>  
 <span data-ttu-id="4e7bc-122">Il concatenamento della proprietà tra database non funziona nei casi in cui vengono eseguite istruzioni SQL create in modo dinamico, a meno che nei due database non esistano gli stessi utenti.</span><span class="sxs-lookup"><span data-stu-id="4e7bc-122">Cross-database ownership chaining does not work in cases where dynamically created SQL statements are executed unless the same user exists in both databases.</span></span> <span data-ttu-id="4e7bc-123">Per aggirare questo problema, in SQL Server è possibile creare una stored procedure che accede ai dati di un altro database e firmare la procedura con un certificato disponibile in entrambi i database.</span><span class="sxs-lookup"><span data-stu-id="4e7bc-123">You can work around this in SQL Server by creating a stored procedure that accesses data in another database and signing the procedure with a certificate that exists in both databases.</span></span> <span data-ttu-id="4e7bc-124">In questo modo si fornisce agli utenti l'accesso alle risorse del database usate dalla procedura senza concedere loro l'accesso o le autorizzazioni per il database.</span><span class="sxs-lookup"><span data-stu-id="4e7bc-124">This gives users access to the database resources used by the procedure without granting them database access or permissions.</span></span>  
  
## <a name="external-resources"></a><span data-ttu-id="4e7bc-125">Risorse esterne</span><span class="sxs-lookup"><span data-stu-id="4e7bc-125">External Resources</span></span>  
 <span data-ttu-id="4e7bc-126">Per altre informazioni, vedere le seguenti risorse.</span><span class="sxs-lookup"><span data-stu-id="4e7bc-126">For more information, see the following resources.</span></span>  
  
|<span data-ttu-id="4e7bc-127">Risorsa</span><span class="sxs-lookup"><span data-stu-id="4e7bc-127">Resource</span></span>|<span data-ttu-id="4e7bc-128">Descrizione</span><span class="sxs-lookup"><span data-stu-id="4e7bc-128">Description</span></span>|  
|--------------|-----------------|  
|<span data-ttu-id="4e7bc-129">[Estensione della rappresentazione del database tramite l'opzione Execute As](https://docs.microsoft.com/previous-versions/sql/sql-server-2008-r2/ms188304(v=sql.105)) e [cross db ownership chaining](/sql/database-engine/configure-windows/cross-db-ownership-chaining-server-configuration-option).</span><span class="sxs-lookup"><span data-stu-id="4e7bc-129">[Extending Database Impersonation by Using EXECUTE AS](https://docs.microsoft.com/previous-versions/sql/sql-server-2008-r2/ms188304(v=sql.105)) and [Cross DB Ownership Chaining Option](/sql/database-engine/configure-windows/cross-db-ownership-chaining-server-configuration-option).</span></span>|<span data-ttu-id="4e7bc-130">Gli articoli descrivono come configurare il concatenamento della proprietà tra database per un'istanza di SQL Server.</span><span class="sxs-lookup"><span data-stu-id="4e7bc-130">Articles describe how to configure cross-database ownership chaining for an instance of SQL Server.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="4e7bc-131">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="4e7bc-131">See also</span></span>

- [<span data-ttu-id="4e7bc-132">Protezione delle applicazioni ADO.NET</span><span class="sxs-lookup"><span data-stu-id="4e7bc-132">Securing ADO.NET Applications</span></span>](../securing-ado-net-applications.md)
- [<span data-ttu-id="4e7bc-133">Cenni preliminari sulla sicurezza in SQL Server</span><span class="sxs-lookup"><span data-stu-id="4e7bc-133">Overview of SQL Server Security</span></span>](overview-of-sql-server-security.md)
- [<span data-ttu-id="4e7bc-134">Gestione delle autorizzazioni con stored procedure in SQL Server</span><span class="sxs-lookup"><span data-stu-id="4e7bc-134">Managing Permissions with Stored Procedures in SQL Server</span></span>](managing-permissions-with-stored-procedures-in-sql-server.md)
- [<span data-ttu-id="4e7bc-135">Scrittura dinamica sicura in SQL Server</span><span class="sxs-lookup"><span data-stu-id="4e7bc-135">Writing Secure Dynamic SQL in SQL Server</span></span>](writing-secure-dynamic-sql-in-sql-server.md)
- [<span data-ttu-id="4e7bc-136">Firma di stored procedure in SQL Server</span><span class="sxs-lookup"><span data-stu-id="4e7bc-136">Signing Stored Procedures in SQL Server</span></span>](signing-stored-procedures-in-sql-server.md)
- [<span data-ttu-id="4e7bc-137">Panoramica di ADO.NET</span><span class="sxs-lookup"><span data-stu-id="4e7bc-137">ADO.NET Overview</span></span>](../ado-net-overview.md)
