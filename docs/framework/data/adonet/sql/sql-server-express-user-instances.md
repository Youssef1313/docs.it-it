---
title: Connessione alle istanze utente di SQL Server Express
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: 00c12376-cb26-4317-86ad-e6e9c089be57
ms.openlocfilehash: 7cd02a0a315ffdb155af09ac4e4fabbea1724a4d
ms.sourcegitcommit: d2e1dfa7ef2d4e9ffae3d431cf6a4ffd9c8d378f
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 09/07/2019
ms.locfileid: "70780842"
---
# <a name="sql-server-express-user-instances"></a><span data-ttu-id="6b94f-102">Connessione alle istanze utente di SQL Server Express</span><span class="sxs-lookup"><span data-stu-id="6b94f-102">SQL Server Express User Instances</span></span>
<span data-ttu-id="6b94f-103">In Microsoft SQL Server Express Edition (SQL Server Express) è supportata la funzionalità istanze utente, disponibile solo quando si usa il provider di dati .NET Framework per SQL Server (`SqlClient`).</span><span class="sxs-lookup"><span data-stu-id="6b94f-103">Microsoft SQL Server Express Edition (SQL Server Express) supports the user instance feature, which is only available when using the .NET Framework Data Provider for SQL Server (`SqlClient`).</span></span> <span data-ttu-id="6b94f-104">Un'istanza utente è un'istanza distinta del motore di database di SQL Server Express generata da un'istanza padre.</span><span class="sxs-lookup"><span data-stu-id="6b94f-104">A user instance is a separate instance of the SQL Server Express Database Engine that is generated by a parent instance.</span></span> <span data-ttu-id="6b94f-105">Le istanze utente consentono agli utenti non amministratori di collegarsi e connettersi ai database SQL Server Express dai propri computer locali.</span><span class="sxs-lookup"><span data-stu-id="6b94f-105">User instances allow users who are not administrators on their local computers to attach and connect to SQL Server Express databases.</span></span> <span data-ttu-id="6b94f-106">Ogni istanza viene eseguita nel contesto di sicurezza del singolo utente, a livello di un'istanza per ogni utente.</span><span class="sxs-lookup"><span data-stu-id="6b94f-106">Each instance runs under the security context of the individual user, on a one-instance-per-user basis.</span></span>  
  
## <a name="user-instance-capabilities"></a><span data-ttu-id="6b94f-107">Funzionalità dell'istanza utente</span><span class="sxs-lookup"><span data-stu-id="6b94f-107">User Instance Capabilities</span></span>  
 <span data-ttu-id="6b94f-108">Le istanze utente risultano utili per gli utenti che eseguono Windows con un account utente con privilegi minimi (LUA, Least-Privilege User Account), perché ogni utente dispone di privilegi di amministratore di sistema di SQL Server (`sysadmin`) sull'istanza eseguita nel proprio computer senza la necessità di disporre anche di privilegi di amministratore di Windows.</span><span class="sxs-lookup"><span data-stu-id="6b94f-108">User instances are useful for users who are running Windows under a least-privilege user account (LUA) because each user has SQL Server system administrator (`sysadmin`) privileges over the instance running on her computer without needing to run as a Windows administrator as well.</span></span> <span data-ttu-id="6b94f-109">Il software eseguito con un'istanza utente con autorizzazioni limitate non può apportare modifiche a livello di sistema, perché l'istanza di SQL Server Express viene eseguita con l'account dell'utente non amministratore di Windows, non come servizio.</span><span class="sxs-lookup"><span data-stu-id="6b94f-109">Software executing on a user instance with limited permissions cannot make system-wide changes because the instance of SQL Server Express is running under the non-administrator Windows account of the user, not as a service.</span></span> <span data-ttu-id="6b94f-110">Ogni istanza utente è isolata dalla relativa istanza padre e da qualsiasi altra istanza utente in esecuzione nello stesso computer.</span><span class="sxs-lookup"><span data-stu-id="6b94f-110">Each user instance is isolated from its parent instance and from any other user instances running on the same computer.</span></span> <span data-ttu-id="6b94f-111">I database eseguiti in un'istanza utente vengono aperti solo in modalità utente singolo e non è possibile che più utenti si connettano ai database in esecuzione in un'istanza utente.</span><span class="sxs-lookup"><span data-stu-id="6b94f-111">Databases running on a user instance are opened in single-user mode only, and it is not possible for multiple users to connect to databases running on a user instance.</span></span> <span data-ttu-id="6b94f-112">La replica e le query distribuite sono inoltre disabilitate per le istanze utente.</span><span class="sxs-lookup"><span data-stu-id="6b94f-112">Replication and distributed queries are also disabled for user instances.</span></span>  
  
 <span data-ttu-id="6b94f-113">Per altre informazioni, vedere "Istanze utente" nella documentazione online di SQL Server.</span><span class="sxs-lookup"><span data-stu-id="6b94f-113">For more information, see "User Instances" in SQL Server Books Online.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="6b94f-114">Le istanze utente non sono necessarie per gli utenti che sono già amministratori del proprio computer o negli scenari che implicano più utenti di database.</span><span class="sxs-lookup"><span data-stu-id="6b94f-114">User instances are not needed for users who are already administrators on their own computers, or for scenarios involving multiple database users.</span></span>  
  
## <a name="enabling-user-instances"></a><span data-ttu-id="6b94f-115">Abilitazione delle istanze utente</span><span class="sxs-lookup"><span data-stu-id="6b94f-115">Enabling User Instances</span></span>  
 <span data-ttu-id="6b94f-116">Per generare le istanze utente, è necessario che sia in esecuzione un'istanza padre di SQL Server Express.</span><span class="sxs-lookup"><span data-stu-id="6b94f-116">To generate user instances, a parent instance of SQL Server Express must be running.</span></span> <span data-ttu-id="6b94f-117">Le istanze utente sono abilitate per impostazione predefinita durante l'installazione di SQL Server Express e possono essere abilitate o disabilitate in modo esplicito da un amministratore di sistema che esegue l'stored procedure di sistema **sp_configure** nell'istanza padre.</span><span class="sxs-lookup"><span data-stu-id="6b94f-117">User instances are enabled by default when SQL Server Express is installed, and they can be explicitly enabled or disabled by a system administrator executing the **sp_configure** system stored procedure on the parent instance.</span></span>  
  
```  
-- Enable user instances.  
sp_configure 'user instances enabled','1'   
  
-- Disable user instances.  
sp_configure 'user instances enabled','0'  
```  
  
 <span data-ttu-id="6b94f-118">Il protocollo di rete per le istanze utente deve essere Named Pipes locale.</span><span class="sxs-lookup"><span data-stu-id="6b94f-118">The network protocol for user instances must be local Named Pipes.</span></span> <span data-ttu-id="6b94f-119">Un'istanza utente non può essere avviata su un'istanza remota di SQL Server e gli account di accesso di SQL Server non sono supportati.</span><span class="sxs-lookup"><span data-stu-id="6b94f-119">A user instance cannot be started on a remote instance of SQL Server, and SQL Server logins are not allowed.</span></span>  
  
## <a name="connecting-to-a-user-instance"></a><span data-ttu-id="6b94f-120">Connessione a un'istanza utente</span><span class="sxs-lookup"><span data-stu-id="6b94f-120">Connecting to a User Instance</span></span>  
 <span data-ttu-id="6b94f-121">Le `User Instance` parole `AttachDBFilename` chiave e <xref:System.Data.SqlClient.SqlConnection.ConnectionString%2A> consentono <xref:System.Data.SqlClient.SqlConnection> a un oggetto di connettersi a un'istanza utente.</span><span class="sxs-lookup"><span data-stu-id="6b94f-121">The `User Instance` and `AttachDBFilename`<xref:System.Data.SqlClient.SqlConnection.ConnectionString%2A> keywords allow a <xref:System.Data.SqlClient.SqlConnection> to connect to a user instance.</span></span> <span data-ttu-id="6b94f-122">Le istanze utente sono supportate anche dalle proprietà <xref:System.Data.SqlClient.SqlConnectionStringBuilder>`UserInstance` e `AttachDBFilename`.</span><span class="sxs-lookup"><span data-stu-id="6b94f-122">User instances are also supported by the <xref:System.Data.SqlClient.SqlConnectionStringBuilder>`UserInstance` and `AttachDBFilename` properties.</span></span>  
  
 <span data-ttu-id="6b94f-123">Si noti quanto segue sull'esempio di stringa di connessione illustrato di seguito:</span><span class="sxs-lookup"><span data-stu-id="6b94f-123">Note the following about the sample connection string shown below:</span></span>  
  
- <span data-ttu-id="6b94f-124">La parola chiave `Data Source` fa riferimento all'istanza padre di SQL Server Express che genera l'istanza utente.</span><span class="sxs-lookup"><span data-stu-id="6b94f-124">The `Data Source` keyword refers to the parent instance of SQL Server Express that is generating the user instance.</span></span> <span data-ttu-id="6b94f-125">L'istanza predefinita è .\sqlexpress.</span><span class="sxs-lookup"><span data-stu-id="6b94f-125">The default instance is .\sqlexpress.</span></span>  
  
- <span data-ttu-id="6b94f-126">`Integrated Security` è impostato su `true`.</span><span class="sxs-lookup"><span data-stu-id="6b94f-126">`Integrated Security` is set to `true`.</span></span> <span data-ttu-id="6b94f-127">Per connettersi a un'istanza utente, è necessario usare l'autenticazione di Windows. Gli account di accesso di SQL Server non sono supportati.</span><span class="sxs-lookup"><span data-stu-id="6b94f-127">To connect to a user instance, Windows Authentication is required; SQL Server logins are not supported.</span></span>  
  
- <span data-ttu-id="6b94f-128">`User Instance` è impostata su `true`, che richiama un'istanza utente.</span><span class="sxs-lookup"><span data-stu-id="6b94f-128">The `User Instance` is set to `true`, which invokes a user instance.</span></span> <span data-ttu-id="6b94f-129">Il valore predefinito è `false`.</span><span class="sxs-lookup"><span data-stu-id="6b94f-129">(The default is `false`.)</span></span>  
  
- <span data-ttu-id="6b94f-130">La parola chiave per la stringa di connessione `AttachDbFileName` viene usata per collegare il file di database primario (con estensione mdf) che deve includere il nome del percorso completo.</span><span class="sxs-lookup"><span data-stu-id="6b94f-130">The `AttachDbFileName` connection string keyword is used to attach the primary database file (.mdf), which must include the full path name.</span></span> <span data-ttu-id="6b94f-131">`AttachDbFileName` corrisponde anche alle chiavi "extended properties" e "initial file name" all'interno della stringa di connessione <xref:System.Data.SqlClient.SqlConnection>.</span><span class="sxs-lookup"><span data-stu-id="6b94f-131">`AttachDbFileName` also corresponds to the "extended properties" and "initial file name" keys within a <xref:System.Data.SqlClient.SqlConnection> connection string.</span></span>  
  
- <span data-ttu-id="6b94f-132">La stringa di sostituzione `|DataDirectory|` racchiusa tra barre verticali fa riferimento alla directory di dati dell'applicazione che apre la connessione e fornisce un percorso relativo che indica la posizione dei file di database e di log, con estensione mdf e ldf.</span><span class="sxs-lookup"><span data-stu-id="6b94f-132">The `|DataDirectory|` substitution string enclosed in the pipe symbols refers to the data directory of the application opening the connection and provides a relative path indicating the location of the .mdf and .ldf database and log files.</span></span> <span data-ttu-id="6b94f-133">Se si desidera individuare altrove questi file, è necessario fornire il percorso completo.</span><span class="sxs-lookup"><span data-stu-id="6b94f-133">If you want to locate these files elsewhere, you must provide the full path to the files.</span></span>  
  
```  
Data Source=.\\SQLExpress;Integrated Security=true;  
User Instance=true;AttachDBFilename=|DataDirectory|\InstanceDB.mdf;  
Initial Catalog=InstanceDB;  
```  
  
> [!NOTE]
> <span data-ttu-id="6b94f-134">È anche possibile usare le proprietà <xref:System.Data.SqlClient.SqlConnectionStringBuilder><xref:System.Data.SqlClient.SqlConnectionStringBuilder.UserInstance%2A> e <xref:System.Data.SqlClient.SqlConnectionStringBuilder.AttachDBFilename%2A> per compilare una stringa di connessione in fase di esecuzione.</span><span class="sxs-lookup"><span data-stu-id="6b94f-134">You can also use the <xref:System.Data.SqlClient.SqlConnectionStringBuilder><xref:System.Data.SqlClient.SqlConnectionStringBuilder.UserInstance%2A> and <xref:System.Data.SqlClient.SqlConnectionStringBuilder.AttachDBFilename%2A> properties to build a connection string at run time.</span></span>  
  
### <a name="using-the-124datadirectory124-substitution-string"></a><span data-ttu-id="6b94f-135">Utilizzo della &#124;stringa di&#124; sostituzione DataDirectory</span><span class="sxs-lookup"><span data-stu-id="6b94f-135">Using the &#124;DataDirectory&#124; Substitution String</span></span>  
 <span data-ttu-id="6b94f-136">`AttachDbFileName` è stata estesa in ADO.NET 2.0 con l'introduzione della stringa di sostituzione `|DataDirectory|` (racchiusa tra barre verticali).</span><span class="sxs-lookup"><span data-stu-id="6b94f-136">`AttachDbFileName` was extended in ADO.NET 2.0 with the introduction of the `|DataDirectory|` (enclosed in pipe symbols) substitution string.</span></span> <span data-ttu-id="6b94f-137">`DataDirectory` viene usata insieme a `AttachDbFileName` per indicare un percorso relativo di un file di dati, consentendo agli sviluppatori di creare stringhe di connessione basate su un percorso relativo dell'origine dati senza che sia necessario specificare un percorso completo.</span><span class="sxs-lookup"><span data-stu-id="6b94f-137">`DataDirectory` is used in conjunction with `AttachDbFileName` to indicate a relative path to a data file, allowing developers to create connection strings that are based on a relative path to the data source instead of being required to specify a full path.</span></span>  
  
 <span data-ttu-id="6b94f-138">La posizione fisica alla quale `DataDirectory` punta dipende dal tipo di applicazione.</span><span class="sxs-lookup"><span data-stu-id="6b94f-138">The physical location that `DataDirectory` points to depends on the type of application.</span></span> <span data-ttu-id="6b94f-139">In questo esempio il file Northwind.mdf da collegare è situato nella cartella \app_data dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="6b94f-139">In this example, the Northwind.mdf file to be attached is located in the application's \app_data folder.</span></span>  
  
```  
Data Source=.\\SQLExpress;Integrated Security=true;  
User Instance=true;  
AttachDBFilename=|DataDirectory|\app_data\Northwind.mdf;  
Initial Catalog=Northwind;  
```  
  
 <span data-ttu-id="6b94f-140">Quando si usa `DataDirectory`, il percorso del file risultante non può trovarsi in una posizione della struttura della directory più alta rispetto alla directory a cui punta la stringa di sostituzione.</span><span class="sxs-lookup"><span data-stu-id="6b94f-140">When `DataDirectory` is used, the resulting file path cannot be higher in the directory structure than the directory pointed to by the substitution string.</span></span> <span data-ttu-id="6b94f-141">Se ad esempio il formato completamente espanso di `DataDirectory` è C:\AppDirectory\app_data, la stringa di connessione di esempio illustrata in precedenza è valida perché si trova al di sotto di c:\AppDirectory.</span><span class="sxs-lookup"><span data-stu-id="6b94f-141">For example, if the fully expanded `DataDirectory` is C:\AppDirectory\app_data, then the sample connection string shown above works because it is below c:\AppDirectory.</span></span> <span data-ttu-id="6b94f-142">Se tuttavia si tenta di specificare `DataDirectory` come `|DataDirectory|\..\data`, verrà generato un errore perché \data non è una sottodirectory di \AppDirectory.</span><span class="sxs-lookup"><span data-stu-id="6b94f-142">However, attempting to specify `DataDirectory` as `|DataDirectory|\..\data` will result in an error because \data is not a subdirectory of \AppDirectory.</span></span>  
  
 <span data-ttu-id="6b94f-143">Se la stringa di connessione include una stringa di sostituzione in un formato errato, verrà generata un'eccezione <xref:System.ArgumentException>.</span><span class="sxs-lookup"><span data-stu-id="6b94f-143">If the connection string has an improperly formatted substitution string, an <xref:System.ArgumentException> will be thrown.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="6b94f-144"><xref:System.Data.SqlClient> risolve le stringhe di sostituzione in percorsi completi rispetto al file system del computer locale.</span><span class="sxs-lookup"><span data-stu-id="6b94f-144"><xref:System.Data.SqlClient> resolves the substitution strings into full paths against the local computer file system.</span></span> <span data-ttu-id="6b94f-145">Pertanto, i nomi di percorso di server remoti, http e UNC non sono supportati.</span><span class="sxs-lookup"><span data-stu-id="6b94f-145">Therefore, remote server, HTTP, and UNC path names are not supported.</span></span> <span data-ttu-id="6b94f-146">Se il server non si trova nel computer locale, quando la connessione viene aperta verrà generata un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="6b94f-146">An exception is thrown when the connection is opened if the server is not located on the local computer.</span></span>  
  
 <span data-ttu-id="6b94f-147">Quando viene aperto, l'oggetto <xref:System.Data.SqlClient.SqlConnection> viene reindirizzato dall'istanza di SQL Server Express predefinita a un'istanza avviata in fase di esecuzione che viene eseguita con l'account del chiamante.</span><span class="sxs-lookup"><span data-stu-id="6b94f-147">When the <xref:System.Data.SqlClient.SqlConnection> is opened, it is redirected from the default SQL Server Express instance to a run-time initiated instance running under the caller's account.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="6b94f-148">Può essere necessario aumentare il valore di <xref:System.Data.SqlClient.SqlConnection.ConnectionTimeout%2A>, in quanto il caricamento delle istanze utente può richiedere più tempo delle istanze normali.</span><span class="sxs-lookup"><span data-stu-id="6b94f-148">It may be necessary to increase the <xref:System.Data.SqlClient.SqlConnection.ConnectionTimeout%2A> value since user instances may take longer to load than regular instances.</span></span>  
  
 <span data-ttu-id="6b94f-149">Con il frammento di codice seguente viene aperta una nuova connessione `SqlConnection`, la stringa di connessione viene visualizzata nella finestra della console e quindi la connessione viene chiusa all'uscita dal blocco di codice `using`.</span><span class="sxs-lookup"><span data-stu-id="6b94f-149">The following code fragment opens a new `SqlConnection`, displays the connection string in the console window, and then closes the connection when exiting the `using` code block.</span></span>  
  
```vb  
Private Sub OpenSqlConnection()  
    ' Retrieve the connection string.  
    Dim connectionString As String = GetConnectionString()  
  
    Using connection As New SqlConnection(connectionString)  
        connection.Open()  
        Console.WriteLine("ConnectionString: {0}", _  
           connection.ConnectionString)  
    End Using  
End Sub  
```  
  
```csharp  
private static void OpenSqlConnection()  
{  
    // Retrieve the connection string.  
    string connectionString = GetConnectionString();  
  
    using (SqlConnection connection =   
        new SqlConnection(connectionString))  
    {  
        connection.Open();  
        Console.WriteLine("ConnectionString: {0}",   
             connection.ConnectionString);  
    }  
}  
```  
  
> [!NOTE]
> <span data-ttu-id="6b94f-150">Le istanze utente non sono supportate nel codice CLR (Common Language Runtime) in esecuzione in SQL Server.</span><span class="sxs-lookup"><span data-stu-id="6b94f-150">User instances are not supported in common language runtime (CLR) code that is running inside of SQL Server.</span></span> <span data-ttu-id="6b94f-151">Se viene eseguita una chiamata a <xref:System.InvalidOperationException> su un oggetto `Open` nella cui stringa di connessione è presente <xref:System.Data.SqlClient.SqlConnection>, viene generata un'eccezione `User Instance=true`.</span><span class="sxs-lookup"><span data-stu-id="6b94f-151">An <xref:System.InvalidOperationException> is thrown if `Open` is called on a <xref:System.Data.SqlClient.SqlConnection> that has `User Instance=true` in the connection string.</span></span>  
  
## <a name="lifetime-of-a-user-instance-connection"></a><span data-ttu-id="6b94f-152">Durata di una connessione a un'istanza utente</span><span class="sxs-lookup"><span data-stu-id="6b94f-152">Lifetime of a User Instance Connection</span></span>  
 <span data-ttu-id="6b94f-153">A differenza delle versioni di SQL Server che vengono eseguite come servizio, le istanze di SQL Server Express non devono necessariamente essere avviate e interrotte manualmente.</span><span class="sxs-lookup"><span data-stu-id="6b94f-153">Unlike versions of SQL Server that run as a service, SQL Server Express instances do not need to be manually started and stopped.</span></span> <span data-ttu-id="6b94f-154">Ogni volta che un utente vi accede e si connette, l'istanza utente viene avviata se non è già in esecuzione.</span><span class="sxs-lookup"><span data-stu-id="6b94f-154">Each time a user logs in and connects to a user instance, the user instance is started if it is not already running.</span></span> <span data-ttu-id="6b94f-155">Nei database dell'istanza utente è impostata l'opzione `AutoClose`, quindi il database viene automaticamente arrestato dopo un periodo di inattività.</span><span class="sxs-lookup"><span data-stu-id="6b94f-155">User instance databases have the `AutoClose` option set so that the database is automatically shut down after a period of inactivity.</span></span> <span data-ttu-id="6b94f-156">Il processo sqlservr.exe che viene avviato rimane in esecuzione per un periodo di timeout limitato dopo la chiusura dell'ultima connessione all'istanza, quindi non deve essere riavviato se prima della scadenza del timeout viene aperta un'altra connessione.</span><span class="sxs-lookup"><span data-stu-id="6b94f-156">The sqlservr.exe process that is started is kept running for a limited time-out period after the last connection to the instance is closed, so it does not need to be restarted if another connection is opened before the time-out has expired.</span></span> <span data-ttu-id="6b94f-157">L'istanza utente viene automaticamente arrestata se non vengono aperte nuove connessioni prima della scadenza del timeout.</span><span class="sxs-lookup"><span data-stu-id="6b94f-157">The user instance automatically shuts down if no new connection opens before that time-out period has expired.</span></span> <span data-ttu-id="6b94f-158">Un amministratore di sistema dell'istanza padre può impostare la durata del periodo di timeout per un'istanza utente utilizzando **sp_configure** per modificare l'opzione **timeout istanza utente** .</span><span class="sxs-lookup"><span data-stu-id="6b94f-158">A system administrator on the parent instance can set the duration of the time-out period for a user instance by using **sp_configure** to change the **user instance timeout** option.</span></span> <span data-ttu-id="6b94f-159">Il valore predefinito è 60 minuti.</span><span class="sxs-lookup"><span data-stu-id="6b94f-159">The default is 60 minutes.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="6b94f-160">Se nella stringa di connessione si usa `Min Pool Size` con un valore maggiore di zero, il pool di connessioni manterrà sempre alcune connessioni aperte, quindi l'istanza utente non verrà automaticamente arrestata.</span><span class="sxs-lookup"><span data-stu-id="6b94f-160">If `Min Pool Size` is used in the connection string with a value greater than zero, the connection pooler will always maintain a few opened connections, and the user instance will not automatically shut down.</span></span>  
  
## <a name="how-user-instances-work"></a><span data-ttu-id="6b94f-161">Funzionamento delle istanze utente</span><span class="sxs-lookup"><span data-stu-id="6b94f-161">How User Instances Work</span></span>  
 <span data-ttu-id="6b94f-162">La prima volta che viene generata un'istanza utente per ogni utente, i database di sistema **Master** e **msdb** vengono copiati dalla cartella Template Data in un percorso nella directory del repository di dati dell'applicazione locale dell'utente per l'utilizzo esclusivo da parte dell'istanza utente.</span><span class="sxs-lookup"><span data-stu-id="6b94f-162">The first time a user instance is generated for each user, the **master** and **msdb** system databases are copied from the Template Data folder to a path under the user's local application data repository directory for exclusive use by the user instance.</span></span> <span data-ttu-id="6b94f-163">Questo percorso è in genere `C:\Documents and Settings\<UserName>\Local Settings\Application Data\Microsoft\Microsoft SQL Server Data\SQLEXPRESS`.</span><span class="sxs-lookup"><span data-stu-id="6b94f-163">This path is typically `C:\Documents and Settings\<UserName>\Local Settings\Application Data\Microsoft\Microsoft SQL Server Data\SQLEXPRESS`.</span></span> <span data-ttu-id="6b94f-164">Quando viene avviata un'istanza utente, i file **tempdb**, log e Trace vengono scritti anche in questa directory.</span><span class="sxs-lookup"><span data-stu-id="6b94f-164">When a user instance starts up, the **tempdb**, log, and trace files are also written to this directory.</span></span> <span data-ttu-id="6b94f-165">Per l'istanza viene generato un nome, che è assolutamente univoco per ogni utente.</span><span class="sxs-lookup"><span data-stu-id="6b94f-165">A name is generated for the instance, which is guaranteed to be unique for each user.</span></span>  
  
 <span data-ttu-id="6b94f-166">Per impostazione predefinita, a tutti i membri del gruppo Windows Builtin\\Users sono concesse le autorizzazioni per connettersi all'istanza locale, nonché le autorizzazioni di lettura ed esecuzione sui binari di SQL Server.</span><span class="sxs-lookup"><span data-stu-id="6b94f-166">By default all members of the Windows Builtin\Users group are granted permissions to connect on the local instance as well as read and execute permissions on the SQL Server binaries.</span></span> <span data-ttu-id="6b94f-167">Dopo la verifica delle credenziali dell'utente chiamante che ospita l'istanza utente, tale utente assume il ruolo di `sysadmin` sull'istanza.</span><span class="sxs-lookup"><span data-stu-id="6b94f-167">Once the credentials of the calling user hosting the user instance have been verified, that user becomes the `sysadmin` on that instance.</span></span> <span data-ttu-id="6b94f-168">Per le istanze utente è abilitata solo la memoria condivisa, il che significa che sono consentite soltanto operazioni nel computer locale.</span><span class="sxs-lookup"><span data-stu-id="6b94f-168">Only shared memory is enabled for user instances, which means that only operations on the local machine are possible.</span></span>  
  
 <span data-ttu-id="6b94f-169">Agli utenti è necessario concedere autorizzazioni di lettura e scrittura sui file mdf e ldf specificati nella stringa di connessione.</span><span class="sxs-lookup"><span data-stu-id="6b94f-169">Users must be granted both read and write permissions on the .mdf and .ldf files specified in the connection string.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="6b94f-170">I file mdf e ldf rappresentano rispettivamente il file di database e il file di log.</span><span class="sxs-lookup"><span data-stu-id="6b94f-170">The .mdf and .ldf files represent the database and log files, respectively.</span></span> <span data-ttu-id="6b94f-171">Questi due file rappresentano un set corrispondente, quindi è necessario prestare attenzione durante le operazioni di backup e ripristino.</span><span class="sxs-lookup"><span data-stu-id="6b94f-171">These two files are a matched set, so care must be taken during backup and restore operations.</span></span> <span data-ttu-id="6b94f-172">Il file di database contiene informazioni sulla versione esatta del file di log e non è possibile aprirlo se è abbinato al file di log errato.</span><span class="sxs-lookup"><span data-stu-id="6b94f-172">The database file contains information about the exact version of the log file, and the database will not open if it is coupled with the wrong log file.</span></span>  
  
 <span data-ttu-id="6b94f-173">Per evitare il danneggiamento dei dati, i database nell'istanza utente vengono aperti con accesso esclusivo.</span><span class="sxs-lookup"><span data-stu-id="6b94f-173">To avoid data corruption, a database in the user instance is opened with exclusive access.</span></span> <span data-ttu-id="6b94f-174">Se due istanze utente diverse condividono lo stesso database nello stesso computer, l'utente nella prima istanza deve chiudere il database prima che possa essere aperto nella seconda istanza.</span><span class="sxs-lookup"><span data-stu-id="6b94f-174">If two different user instances share the same database on the same computer, the user on the first instance must close the database before it can be opened in a second instance.</span></span>  
  
## <a name="user-instance-scenarios"></a><span data-ttu-id="6b94f-175">Scenari di istanza utente</span><span class="sxs-lookup"><span data-stu-id="6b94f-175">User Instance Scenarios</span></span>  
 <span data-ttu-id="6b94f-176">Le istanze utente forniscono agli sviluppatori di applicazioni di database un archivio dati di SQL Server che non richiede la disponibilità di account amministrativi sui propri computer di sviluppo.</span><span class="sxs-lookup"><span data-stu-id="6b94f-176">User instances provide developers of database applications with a SQL Server data store that does not depend on developers having administrative accounts on their development computers.</span></span> <span data-ttu-id="6b94f-177">Le istanze utente sono basate sul modello Access/Jet, in cui l'applicazione di database si connette a un file e l'utente ottiene automaticamente le autorizzazioni complete su tutti gli oggetti di database, senza richiedere l'intervento di un amministratore di sistema che le conceda.</span><span class="sxs-lookup"><span data-stu-id="6b94f-177">User instances are based on the Access/Jet model, where the database application simply connects to a file, and the user automatically has full permissions on all of the database objects without needing the intervention of a system administrator to grant permissions.</span></span> <span data-ttu-id="6b94f-178">Sono destinate alle situazioni in cui l'utente opera con un account con privilegi minimi e non dispone di privilegi amministrativi nel server o nel computer locale, anche se ha la necessità di creare applicazioni e oggetti di database.</span><span class="sxs-lookup"><span data-stu-id="6b94f-178">It is intended to work in situations where the user is running under a least-privilege user account (LUA) and does not have administrative privileges on the server or local machine, yet needs to create database objects and applications.</span></span> <span data-ttu-id="6b94f-179">Le istanze utente consentono di creare istanze in fase di esecuzione che vengono eseguite nel contesto di sicurezza dell'utente e non in quello di un servizio di sistema con più privilegi.</span><span class="sxs-lookup"><span data-stu-id="6b94f-179">User instances allow users to create instances at run time that run under the user's own security context, and not in the security context of a more privileged system service.</span></span>  
  
> [!IMPORTANT]
> <span data-ttu-id="6b94f-180">Le istanze utente devono essere usate solo negli scenari in cui tutte le applicazioni che le usano sono completamente attendibili.</span><span class="sxs-lookup"><span data-stu-id="6b94f-180">User instances should only be used in scenarios where all the applications using it are fully trusted.</span></span>  
  
 <span data-ttu-id="6b94f-181">Gli scenari delle istanze utente includono:</span><span class="sxs-lookup"><span data-stu-id="6b94f-181">User instance scenarios include:</span></span>  
  
- <span data-ttu-id="6b94f-182">Qualsiasi applicazione in modalità utente singolo in cui non è necessario condividere dati.</span><span class="sxs-lookup"><span data-stu-id="6b94f-182">Any single-user application where sharing data is not required.</span></span>  
  
- <span data-ttu-id="6b94f-183">Distribuzione ClickOnce.</span><span class="sxs-lookup"><span data-stu-id="6b94f-183">ClickOnce deployment.</span></span> <span data-ttu-id="6b94f-184">Se .NET Framework 2.0 (o versione successiva) e SQL Server Express sono già installati nel computer di destinazione, il pacchetto di installazione scaricato come risultato di un'azione ClickOnce può essere installato e usato da utenti non amministratori.</span><span class="sxs-lookup"><span data-stu-id="6b94f-184">If the .NET Framework 2.0 (or later) and SQL Server Express are already installed on the target computer, the installation package downloaded as a result of a ClickOnce action can be installed and used by non-administrator users.</span></span> <span data-ttu-id="6b94f-185">Si noti che un amministratore deve installare SQL Server Express se fa parte dell'installazione.</span><span class="sxs-lookup"><span data-stu-id="6b94f-185">Note that an administrator must install SQL Server Express if that is part of the setup.</span></span> <span data-ttu-id="6b94f-186">Per ulteriori informazioni, vedere [la pagina relativa alla distribuzione ClickOnce per Windows Forms](../../../winforms/clickonce-deployment-for-windows-forms.md).</span><span class="sxs-lookup"><span data-stu-id="6b94f-186">For more information, see [ClickOnce Deployment for Windows Forms](../../../winforms/clickonce-deployment-for-windows-forms.md).</span></span>
  
- <span data-ttu-id="6b94f-187">Hosting ASP.NET dedicato con autenticazione di Windows.</span><span class="sxs-lookup"><span data-stu-id="6b94f-187">Dedicated ASP.NET hosting using Windows Authentication.</span></span> <span data-ttu-id="6b94f-188">Una Intranet può contenere una singola istanza di SQL Server Express.</span><span class="sxs-lookup"><span data-stu-id="6b94f-188">A single SQL Server Express instance can be hosted on an intranet.</span></span> <span data-ttu-id="6b94f-189">L'applicazione si connette usando l'account di Windows ASPNET, non tramite rappresentazione.</span><span class="sxs-lookup"><span data-stu-id="6b94f-189">The application connects using the ASPNET Windows account, not by using impersonation.</span></span> <span data-ttu-id="6b94f-190">Le istanze utente non devono essere usate per scenari di hosting di terze parti o condivisi in cui tutte le applicazioni condividerebbero la stessa istanza utente e non rimarrebbero più isolate una dall'altra.</span><span class="sxs-lookup"><span data-stu-id="6b94f-190">User instances should not be used for third-party or shared hosting scenarios where all applications would share the same user instance and would no longer remain isolated from each other.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="6b94f-191">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="6b94f-191">See also</span></span>

- [<span data-ttu-id="6b94f-192">SQL Server e ADO.NET</span><span class="sxs-lookup"><span data-stu-id="6b94f-192">SQL Server and ADO.NET</span></span>](index.md)
- [<span data-ttu-id="6b94f-193">Stringhe di connessione</span><span class="sxs-lookup"><span data-stu-id="6b94f-193">Connection Strings</span></span>](../connection-strings.md)
- [<span data-ttu-id="6b94f-194">Connessione a un'origine dati</span><span class="sxs-lookup"><span data-stu-id="6b94f-194">Connecting to a Data Source</span></span>](../connecting-to-a-data-source.md)
- [<span data-ttu-id="6b94f-195">Panoramica di ADO.NET</span><span class="sxs-lookup"><span data-stu-id="6b94f-195">ADO.NET Overview</span></span>](../ado-net-overview.md)
