---
title: Importazione di una libreria dei tipi come assembly
ms.date: 03/30/2017
helpviewer_keywords:
- importing type library
- type metadata
- custom wrappers
- metadata
- exposing COM components to .NET Framework
- Type Library Importer
- interoperation with unmanaged code, importing type library
- interoperation with unmanaged code, exposing COM components
- type libraries
- TypeLibConverter class, importing type library as assembly
- COM interop, importing type library
- COM interop, exposing COM components
ms.assetid: d1898229-cd40-426e-a275-f3eb65fbc79f
ms.openlocfilehash: e1a21175bcabc72b86a328d4f73ecec37140c304
ms.sourcegitcommit: 559fcfbe4871636494870a8b716bf7325df34ac5
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/30/2019
ms.locfileid: "73107594"
---
# <a name="importing-a-type-library-as-an-assembly"></a><span data-ttu-id="eec3a-102">Importazione di una libreria dei tipi come assembly</span><span class="sxs-lookup"><span data-stu-id="eec3a-102">Importing a Type Library as an Assembly</span></span>

<span data-ttu-id="eec3a-103">In genere, le definizioni dei tipi COM sono incluse in una libreria dei tipi.</span><span class="sxs-lookup"><span data-stu-id="eec3a-103">COM type definitions usually reside in a type library.</span></span> <span data-ttu-id="eec3a-104">Al contrario, i compilatori conformi a CLS producono metadati dei tipi in un assembly.</span><span class="sxs-lookup"><span data-stu-id="eec3a-104">In contrast, CLS-compliant compilers produce type metadata in an assembly.</span></span> <span data-ttu-id="eec3a-105">Le due origini delle informazioni sui tipi sono piuttosto diverse.</span><span class="sxs-lookup"><span data-stu-id="eec3a-105">The two sources of type information are quite different.</span></span> <span data-ttu-id="eec3a-106">Questo argomento descrive le tecniche per la generazione di metadati da una libreria dei tipi.</span><span class="sxs-lookup"><span data-stu-id="eec3a-106">This topic describes techniques for generating metadata from a type library.</span></span> <span data-ttu-id="eec3a-107">L'assembly risultante è definito un assembly di interoperabilità e le informazioni sui tipi che contiene permettono alle applicazioni .NET Framework di usare tipi COM.</span><span class="sxs-lookup"><span data-stu-id="eec3a-107">The resulting assembly is called an interop assembly, and the type information it contains enables .NET Framework applications to use COM types.</span></span>

<span data-ttu-id="eec3a-108">Per rendere queste informazioni sui tipi disponibili all'applicazione, è possibile usare due modi diversi:</span><span class="sxs-lookup"><span data-stu-id="eec3a-108">There are two ways to make this type information available to your application:</span></span>

- <span data-ttu-id="eec3a-109">Uso di assembly di interoperabilità solo in fase di progettazione: a partire dalla .NET Framework 4, è possibile indicare al compilatore di incorporare le informazioni sul tipo dall'assembly di interoperabilità nell'eseguibile.</span><span class="sxs-lookup"><span data-stu-id="eec3a-109">Using design-time-only interop assemblies: Beginning with the .NET Framework 4, you can instruct the compiler to embed type information from the interop assembly into your executable.</span></span> <span data-ttu-id="eec3a-110">Il compilatore incorpora solo le informazioni sui tipi usate dall'applicazione.</span><span class="sxs-lookup"><span data-stu-id="eec3a-110">The compiler embeds only the type information that your application uses.</span></span> <span data-ttu-id="eec3a-111">Non è necessario distribuire l'assembly di interoperabilità con l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="eec3a-111">You do not have to deploy the interop assembly with your application.</span></span> <span data-ttu-id="eec3a-112">Questa è la tecnica consigliata.</span><span class="sxs-lookup"><span data-stu-id="eec3a-112">This is the recommended technique.</span></span>

- <span data-ttu-id="eec3a-113">Distribuire assembly di interoperabilità: è possibile creare un riferimento standard all'assembly di interoperabilità.</span><span class="sxs-lookup"><span data-stu-id="eec3a-113">Deploying interop assemblies: You can create a standard reference to the interop assembly.</span></span> <span data-ttu-id="eec3a-114">In questo caso, l'assembly di interoperabilità deve essere distribuito con l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="eec3a-114">In this case, the interop assembly must be deployed with your application.</span></span> <span data-ttu-id="eec3a-115">Se si ricorre a questa tecnica e non si usa un componente COM privato, fare sempre riferimento all'assembly di interoperabilità primario pubblicato dall'autore del componente COM che si intende incorporare nel codice gestito.</span><span class="sxs-lookup"><span data-stu-id="eec3a-115">If you employ this technique, and you are not using a private COM component, always reference the primary interop assembly (PIA) published by the author of the COM component you intend to incorporate in your managed code.</span></span> <span data-ttu-id="eec3a-116">Per altre informazioni sulla creazione e sull'uso di assembly di interoperabilità primari, vedere [Primary Interop Assemblies](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/aax7sdch(v=vs.100)) (Assembly di interoperabilità primari).</span><span class="sxs-lookup"><span data-stu-id="eec3a-116">For more information about producing and using primary interop assemblies, see [Primary Interop Assemblies](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/aax7sdch(v=vs.100)).</span></span>

<span data-ttu-id="eec3a-117">Quando si usano assembly di interoperabilità solo in fase di progettazione, è possibile incorporare le informazioni sui tipi dall'assembly di interoperabilità primario pubblicato dall'autore del componente COM.</span><span class="sxs-lookup"><span data-stu-id="eec3a-117">When you use design-time-only interop assemblies, you can embed type information from the primary interop assembly published by the author of the COM component.</span></span> <span data-ttu-id="eec3a-118">Tuttavia, non è necessario distribuire l'assembly di interoperabilità primario con l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="eec3a-118">However, you do not have to deploy the primary interop assembly with your application.</span></span>

<span data-ttu-id="eec3a-119">L'uso di assembly di interoperabilità primari solo in fase di progettazione permette di ridurre le dimensioni dell'applicazione, perché la maggior parte delle applicazioni non usa tutte le funzionalità di un componente COM.</span><span class="sxs-lookup"><span data-stu-id="eec3a-119">Using design-time-only interop assemblies reduces the size of your application, because most applications do not use all the features of a COM component.</span></span> <span data-ttu-id="eec3a-120">Il compilatore è molto efficiente quando incorpora le informazioni sui tipi: se l'applicazione usa solo alcuni dei metodi in un'interfaccia COM, il compilatore non incorpora quelli inutilizzati.</span><span class="sxs-lookup"><span data-stu-id="eec3a-120">The compiler is very efficient when it embeds type information; if your application uses only some of the methods on a COM interface, the compiler does not embed the unused methods.</span></span> <span data-ttu-id="eec3a-121">Quando un'applicazione in cui sono incorporate informazioni sui tipi interagisce con un'altra applicazione di questo tipo o con un'applicazione che usa un assembly di interoperabilità primario, Common Language Runtime usa regole di equivalenza dei tipi per determinare se due tipi con lo stesso nome rappresentano lo stesso tipo COM.</span><span class="sxs-lookup"><span data-stu-id="eec3a-121">When an application that has embedded type information interacts with another such application, or interacts with an application that uses a primary interop assembly, the common language runtime uses type equivalence rules to determine whether two types with the same name represent the same COM type.</span></span> <span data-ttu-id="eec3a-122">La conoscenza di queste regole non è necessaria per usare oggetti COM.</span><span class="sxs-lookup"><span data-stu-id="eec3a-122">You do not have to know these rules to use COM objects.</span></span> <span data-ttu-id="eec3a-123">Tuttavia, per altre informazioni sulle regole, vedere [Equivalenza dei tipi e tipi di interoperabilità incorporati](type-equivalence-and-embedded-interop-types.md).</span><span class="sxs-lookup"><span data-stu-id="eec3a-123">However, if you are interested in the rules, see [Type Equivalence and Embedded Interop Types](type-equivalence-and-embedded-interop-types.md).</span></span>

## <a name="generating-metadata"></a><span data-ttu-id="eec3a-124">Generazione di metadati</span><span class="sxs-lookup"><span data-stu-id="eec3a-124">Generating Metadata</span></span>

<span data-ttu-id="eec3a-125">Le librerie dei tipi COM possono essere file autonomi con estensione tlb, ad esempio Loanlib.tlb.</span><span class="sxs-lookup"><span data-stu-id="eec3a-125">COM type libraries can be stand-alone files that have a .tlb extension, such as Loanlib.tlb.</span></span> <span data-ttu-id="eec3a-126">Alcune librerie dei tipi sono incorporate nella sezione delle risorse di un file DLL o EXE.</span><span class="sxs-lookup"><span data-stu-id="eec3a-126">Some type libraries are embedded in the resource section of a .dll or .exe file.</span></span> <span data-ttu-id="eec3a-127">Altre origini per le librerie dei tipi sono i file OLB e OCX.</span><span class="sxs-lookup"><span data-stu-id="eec3a-127">Other sources of type library information are .olb and .ocx files.</span></span>

<span data-ttu-id="eec3a-128">Dopo aver individuato la libreria dei tipi che contiene l'implementazione del tipo COM di destinazione, è possibile scegliere tra le opzioni seguenti per generare un assembly di interoperabilità contenente i metadati dei tipi:</span><span class="sxs-lookup"><span data-stu-id="eec3a-128">After you locate the type library that contains the implementation of your target COM type, you have the following options for generating an interop assembly containing type metadata:</span></span>

- <span data-ttu-id="eec3a-129">Visual Studio</span><span class="sxs-lookup"><span data-stu-id="eec3a-129">Visual Studio</span></span>

  <span data-ttu-id="eec3a-130">Visual Studio converte automaticamente i tipi COM in una libreria dei tipi in metadati in un assembly.</span><span class="sxs-lookup"><span data-stu-id="eec3a-130">Visual Studio automatically converts COM types in a type library to metadata in an assembly.</span></span> <span data-ttu-id="eec3a-131">Per istruzioni, vedere [procedura: aggiungere riferimenti alle librerie dei tipi](how-to-add-references-to-type-libraries.md).</span><span class="sxs-lookup"><span data-stu-id="eec3a-131">For instructions, see [How to: Add References to Type Libraries](how-to-add-references-to-type-libraries.md).</span></span>

- [<span data-ttu-id="eec3a-132">Tlbimp.exe (utilità di importazione della libreria dei tipi)</span><span class="sxs-lookup"><span data-stu-id="eec3a-132">Type Library Importer (Tlbimp.exe)</span></span>](../tools/tlbimp-exe-type-library-importer.md)

  <span data-ttu-id="eec3a-133">L'utilità di importazione della libreria dei tipi offre opzioni della riga di comando per modificare i metadati nel file di interoperabilità risultante, importare tipi da una libreria dei tipi esistente e generare un assembly di interoperabilità e uno spazio dei nomi.</span><span class="sxs-lookup"><span data-stu-id="eec3a-133">The Type Library Importer provides command-line options to adjust metadata in the resulting interop file, imports types from an existing type library, and generates an interop assembly and a namespace.</span></span> <span data-ttu-id="eec3a-134">Per istruzioni, vedere [Procedura: Generare assembly di interoperabilità da librerie dei tipi](how-to-generate-interop-assemblies-from-type-libraries.md)</span><span class="sxs-lookup"><span data-stu-id="eec3a-134">For instructions, see [How to: Generate Interop Assemblies from Type Libraries](how-to-generate-interop-assemblies-from-type-libraries.md).</span></span>

- <span data-ttu-id="eec3a-135">Classe <xref:System.Runtime.InteropServices.TypeLibConverter?displayProperty=nameWithType></span><span class="sxs-lookup"><span data-stu-id="eec3a-135"><xref:System.Runtime.InteropServices.TypeLibConverter?displayProperty=nameWithType> class</span></span>

  <span data-ttu-id="eec3a-136">Questa classe fornisce i metodi per convertire coclassi e interfacce in una libreria dei tipi in metadati in un assembly.</span><span class="sxs-lookup"><span data-stu-id="eec3a-136">This class provides methods to convert coclasses and interfaces in a type library to metadata within an assembly.</span></span> <span data-ttu-id="eec3a-137">La classe produce gli stessi metadati restituiti da Tlbimp.exe.</span><span class="sxs-lookup"><span data-stu-id="eec3a-137">It produces the same metadata output as Tlbimp.exe.</span></span> <span data-ttu-id="eec3a-138">Tuttavia, diversamente da Tlbimp.exe, la classe <xref:System.Runtime.InteropServices.TypeLibConverter> può convertire in metadati una libreria dei tipi in memoria.</span><span class="sxs-lookup"><span data-stu-id="eec3a-138">However, unlike Tlbimp.exe, the <xref:System.Runtime.InteropServices.TypeLibConverter> class can convert an in-memory type library to metadata.</span></span>

- <span data-ttu-id="eec3a-139">Wrapper personalizzati</span><span class="sxs-lookup"><span data-stu-id="eec3a-139">Custom wrappers</span></span>

  <span data-ttu-id="eec3a-140">Quando una libreria dei tipi non è disponibile o corretta, un'opzione consiste nel creare una definizione duplicata della classe o dell'interfaccia nel codice sorgente gestito.</span><span class="sxs-lookup"><span data-stu-id="eec3a-140">When a type library is unavailable or incorrect, one option is to create a duplicate definition of the class or interface in managed source code.</span></span> <span data-ttu-id="eec3a-141">È quindi necessario compilare il codice sorgente con un compilatore basato sul runtime per produrre metadati in un assembly.</span><span class="sxs-lookup"><span data-stu-id="eec3a-141">You then compile the source code with a compiler that targets the runtime to produce metadata in an assembly.</span></span>

  <span data-ttu-id="eec3a-142">Per definire tipi COM manualmente, è necessario avere accesso agli elementi seguenti:</span><span class="sxs-lookup"><span data-stu-id="eec3a-142">To define COM types manually, you must have access to the following items:</span></span>

  - <span data-ttu-id="eec3a-143">Descrizioni precise delle coclassi e delle interfacce da definire.</span><span class="sxs-lookup"><span data-stu-id="eec3a-143">Precise descriptions of the coclasses and interfaces being defined.</span></span>

  - <span data-ttu-id="eec3a-144">Compilatore, ad esempio il compilatore C#, in grado di generare le definizioni delle classi .NET Framework appropriate.</span><span class="sxs-lookup"><span data-stu-id="eec3a-144">A compiler, such as the C# compiler, that can generate the appropriate .NET Framework class definitions.</span></span>

  - <span data-ttu-id="eec3a-145">Conoscenza delle regole di conversione da librerie dei tipi ad assembly.</span><span class="sxs-lookup"><span data-stu-id="eec3a-145">Knowledge of the type library-to-assembly conversion rules.</span></span>

  <span data-ttu-id="eec3a-146">La scrittura di un wrapper personalizzato è una tecnica avanzata.</span><span class="sxs-lookup"><span data-stu-id="eec3a-146">Writing a custom wrapper is an advanced technique.</span></span> <span data-ttu-id="eec3a-147">Per altre informazioni su come generare un wrapper personalizzato, vedere [Personalizzazione di wrapper standard](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/h7hx9abd(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="eec3a-147">For additional information about how to generate a custom wrapper, see [Customizing Standard Wrappers](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/h7hx9abd(v=vs.100)).</span></span>

 <span data-ttu-id="eec3a-148">Per altre informazioni sui processi di importazione di interoperabilità COM, vedere [Riepilogo della conversione da libreria dei tipi ad assembly](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/k83zzh38(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="eec3a-148">For more information about the COM interop import process, see [Type Library to Assembly Conversion Summary](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/k83zzh38(v=vs.100)).</span></span>

## <a name="see-also"></a><span data-ttu-id="eec3a-149">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="eec3a-149">See also</span></span>

- <xref:System.Runtime.InteropServices.TypeLibConverter>
- [<span data-ttu-id="eec3a-150">Esposizione di componenti COM a .NET Framework</span><span class="sxs-lookup"><span data-stu-id="eec3a-150">Exposing COM Components to the .NET Framework</span></span>](exposing-com-components.md)
- <span data-ttu-id="eec3a-151">[Riepilogo della conversione da libreria dei tipi ad assembly](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/k83zzh38(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="eec3a-151">[Type Library to Assembly Conversion Summary](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/k83zzh38(v=vs.100))</span></span>
- [<span data-ttu-id="eec3a-152">Tlbimp.exe (utilità di importazione della libreria dei tipi)</span><span class="sxs-lookup"><span data-stu-id="eec3a-152">Tlbimp.exe (Type Library Importer)</span></span>](../tools/tlbimp-exe-type-library-importer.md)
- <span data-ttu-id="eec3a-153">[Personalizzazione di wrapper standard](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/h7hx9abd(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="eec3a-153">[Customizing Standard Wrappers](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/h7hx9abd(v=vs.100))</span></span>
- <span data-ttu-id="eec3a-154">[Uso dei tipi COM nel codice gestito](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/3y76b69k(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="eec3a-154">[Using COM Types in Managed Code](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/3y76b69k(v=vs.100))</span></span>
- [<span data-ttu-id="eec3a-155">Compilazione di un progetto di interoperabilità</span><span class="sxs-lookup"><span data-stu-id="eec3a-155">Compiling an Interop Project</span></span>](compiling-an-interop-project.md)
- [<span data-ttu-id="eec3a-156">Distribuzione di una applicazione di interoperabilità</span><span class="sxs-lookup"><span data-stu-id="eec3a-156">Deploying an Interop Application</span></span>](deploying-an-interop-application.md)
- [<span data-ttu-id="eec3a-157">Procedura: aggiungere riferimenti alle librerie dei tipi</span><span class="sxs-lookup"><span data-stu-id="eec3a-157">How to: Add References to Type Libraries</span></span>](how-to-add-references-to-type-libraries.md)
- [<span data-ttu-id="eec3a-158">Procedura: generare assembly di interoperabilità da librerie dei tipi</span><span class="sxs-lookup"><span data-stu-id="eec3a-158">How to: Generate Interop Assemblies from Type Libraries</span></span>](how-to-generate-interop-assemblies-from-type-libraries.md)
