---
title: Surrogati del contratto dati
ms.date: 03/30/2017
helpviewer_keywords:
- data contracts [WCF], surrogates
ms.assetid: 8c31134c-46c5-4ed7-94af-bab0ac0dfce5
ms.openlocfilehash: cc0772cbb35f7c149af7eac04239d7349fa79f27
ms.sourcegitcommit: d2e1dfa7ef2d4e9ffae3d431cf6a4ffd9c8d378f
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 09/07/2019
ms.locfileid: "70797208"
---
# <a name="data-contract-surrogates"></a><span data-ttu-id="9f705-102">Surrogati del contratto dati</span><span class="sxs-lookup"><span data-stu-id="9f705-102">Data Contract Surrogates</span></span>
<span data-ttu-id="9f705-103">Il *surrogato* del contratto dati è una funzionalità avanzata basata sul modello di contratto dati.</span><span class="sxs-lookup"><span data-stu-id="9f705-103">The data contract *surrogate* is an advanced feature built upon the Data Contract model.</span></span> <span data-ttu-id="9f705-104">È progettata per la personalizzazione e la sostituzione dei tipi nelle situazioni in cui gli utenti desiderano modificare il modo in cui un tipo viene serializzato, deserializzato o proiettato nei metadati.</span><span class="sxs-lookup"><span data-stu-id="9f705-104">This feature is designed to be used for type customization and substitution in situations where users want to change how a type is serialized, deserialized or projected into metadata.</span></span> <span data-ttu-id="9f705-105">Un surrogato può essere utilizzato, ad esempio, quando un contratto dati non è stato specificato per il tipo, i campi e le proprietà non sono contrassegnati con l'attributo <xref:System.Runtime.Serialization.DataMemberAttribute> o gli utenti desiderano creare dinamicamente variazioni dello schema.</span><span class="sxs-lookup"><span data-stu-id="9f705-105">Some scenarios where a surrogate may be used is when a data contract has not been specified for the type, fields and properties are not marked with the <xref:System.Runtime.Serialization.DataMemberAttribute> attribute or users wish to dynamically create schema variations.</span></span>  
  
 <span data-ttu-id="9f705-106">La serializzazione e la deserializzazione vengono eseguite con il surrogato del contratto dati quando si utilizza <xref:System.Runtime.Serialization.DataContractSerializer> per convertire da .NET Framework in un formato adatto, ad esempio XML.</span><span class="sxs-lookup"><span data-stu-id="9f705-106">Serialization and deserialization are accomplished with the data contract surrogate when using <xref:System.Runtime.Serialization.DataContractSerializer> to convert from .NET Framework to a suitable format, such as XML.</span></span> <span data-ttu-id="9f705-107">Il surrogato del contratto dati può essere utilizzato inoltre per modificare i metadati esportati per i tipi, durante la produzione di rappresentazioni dei metadati, ad esempio XSD (XML Schema Documents).</span><span class="sxs-lookup"><span data-stu-id="9f705-107">Data contract surrogate can also be used to modify the metadata exported for types, when producing metadata representations such as XML Schema Documents (XSD).</span></span> <span data-ttu-id="9f705-108">In fase di importazione viene creato codice dai metadati e in questo caso il surrogato può essere utilizzato per personalizzare anche il codice generato.</span><span class="sxs-lookup"><span data-stu-id="9f705-108">Upon import, code is created from metadata and the surrogate can be used in this case to customize the generated code as well.</span></span>  
  
## <a name="how-the-surrogate-works"></a><span data-ttu-id="9f705-109">Funzionamento del surrogato</span><span class="sxs-lookup"><span data-stu-id="9f705-109">How the Surrogate Works</span></span>  
 <span data-ttu-id="9f705-110">Un surrogato funziona eseguendo il mapping di un tipo (l'"originale") a un altro tipo (il "surrogato").</span><span class="sxs-lookup"><span data-stu-id="9f705-110">A surrogate works by mapping one type (the "original" type) to another type (the "surrogated" type).</span></span> <span data-ttu-id="9f705-111">Negli esempi seguenti sono mostrati il tipo originale `Inventory` e un nuovo tipo surrogato `InventorySurrogated`.</span><span class="sxs-lookup"><span data-stu-id="9f705-111">The following example shows the original type `Inventory` and a new surrogate `InventorySurrogated` type.</span></span> <span data-ttu-id="9f705-112">Il tipo `Inventory` non è serializzabile diversamente dal tipo `InventorySurrogated`:</span><span class="sxs-lookup"><span data-stu-id="9f705-112">The `Inventory` type is not serializable but the `InventorySurrogated` type is:</span></span>  
  
 [!code-csharp[C_IDataContractSurrogate#1](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_idatacontractsurrogate/cs/source.cs#1)]  
  
 <span data-ttu-id="9f705-113">Poiché per questa classe non è stato definito un contratto dati, è necessario convertire la classe in una classe surrogata con un contratto dati.</span><span class="sxs-lookup"><span data-stu-id="9f705-113">Because a data contract has not been defined for this class, convert the class to a surrogate class with a data contract.</span></span> <span data-ttu-id="9f705-114">La classe surrogata è illustrata nell'esempio seguente:</span><span class="sxs-lookup"><span data-stu-id="9f705-114">The surrogated class is shown in the following example:</span></span>  
  
 [!code-csharp[C_IDataContractSurrogate#2](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_idatacontractsurrogate/cs/source.cs#2)]  
  
## <a name="implementing-the-idatacontractsurrogate"></a><span data-ttu-id="9f705-115">Implementazione di IDataContractSurrogate</span><span class="sxs-lookup"><span data-stu-id="9f705-115">Implementing the IDataContractSurrogate</span></span>  
 <span data-ttu-id="9f705-116">Per utilizzare il surrogato del contratto dati, implementare l'interfaccia <xref:System.Runtime.Serialization.IDataContractSurrogate>.</span><span class="sxs-lookup"><span data-stu-id="9f705-116">To use the data contract surrogate, implement the <xref:System.Runtime.Serialization.IDataContractSurrogate> interface.</span></span>  
  
 <span data-ttu-id="9f705-117">Di seguito è fornita una panoramica di ogni metodo dell'interfaccia <xref:System.Runtime.Serialization.IDataContractSurrogate> con una possibile implementazione.</span><span class="sxs-lookup"><span data-stu-id="9f705-117">The following is an overview of each method of <xref:System.Runtime.Serialization.IDataContractSurrogate> with a possible implementation.</span></span>  
  
### <a name="getdatacontracttype"></a><span data-ttu-id="9f705-118">GetDataContractType</span><span class="sxs-lookup"><span data-stu-id="9f705-118">GetDataContractType</span></span>  
 <span data-ttu-id="9f705-119">Il metodo <xref:System.Runtime.Serialization.IDataContractSurrogate.GetDataContractType%2A> esegue il mapping di un tipo all'altro.</span><span class="sxs-lookup"><span data-stu-id="9f705-119">The <xref:System.Runtime.Serialization.IDataContractSurrogate.GetDataContractType%2A> method maps one type to another.</span></span> <span data-ttu-id="9f705-120">È necessario per la serializzazione, la deserializzazione, l'importazione e l'esportazione.</span><span class="sxs-lookup"><span data-stu-id="9f705-120">This method is required for serialization, deserialization, import, and export.</span></span>  
  
 <span data-ttu-id="9f705-121">La prima attività consiste nel definire i tipi che verranno mappati ad altri tipi.</span><span class="sxs-lookup"><span data-stu-id="9f705-121">The first task is defining what types will be mapped to other types.</span></span> <span data-ttu-id="9f705-122">Ad esempio:</span><span class="sxs-lookup"><span data-stu-id="9f705-122">For example:</span></span>  
  
 [!code-csharp[C_IDataContractSurrogate#3](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_idatacontractsurrogate/cs/source.cs#3)]  
  
- <span data-ttu-id="9f705-123">Nel caso della serializzazione, il mapping restituito da questo metodo viene successivamente utilizzato per trasformare l'istanza originale in un'istanza surrogata chiamando il metodo <xref:System.Runtime.Serialization.IDataContractSurrogate.GetObjectToSerialize%2A>.</span><span class="sxs-lookup"><span data-stu-id="9f705-123">On serialization, the mapping returned by this method is subsequently used to transform the original instance to a surrogated instance by calling the <xref:System.Runtime.Serialization.IDataContractSurrogate.GetObjectToSerialize%2A> method.</span></span>  
  
- <span data-ttu-id="9f705-124">Nel caso della deserializzazione, il mapping restituito da questo metodo viene utilizzato dal serializzatore per deserializzare in un'istanza del tipo surrogato.</span><span class="sxs-lookup"><span data-stu-id="9f705-124">On deserialization, the mapping returned by this method is used by the serializer to deserialize into an instance of the surrogate type.</span></span> <span data-ttu-id="9f705-125">Viene quindi chiamato il metodo <xref:System.Runtime.Serialization.IDataContractSurrogate.GetDeserializedObject%2A> per trasformare l'istanza surrogata in un'istanza del tipo originale.</span><span class="sxs-lookup"><span data-stu-id="9f705-125">It subsequently calls <xref:System.Runtime.Serialization.IDataContractSurrogate.GetDeserializedObject%2A> to transform the surrogated instance into an instance of the original type.</span></span>  
  
- <span data-ttu-id="9f705-126">Nel caso dell'esportazione, viene eseguita la riflessione del tipo surrogato restituito da questo metodo per ottenere il contratto dati da utilizzare per la generazione dei metadati.</span><span class="sxs-lookup"><span data-stu-id="9f705-126">On export, the surrogate type returned by this method is reflected to get the data contract to use for generating metadata.</span></span>  
  
- <span data-ttu-id="9f705-127">Nel caso dell'importazione, il tipo iniziale viene modificato in un tipo surrogato di cui viene eseguita la riflessione per ottenere il contratto dati da utilizzare per scopi come il supporto di riferimento.</span><span class="sxs-lookup"><span data-stu-id="9f705-127">On import, the initial type is changed to a surrogate type that is reflected to get the data contract to use for purposes like referencing support.</span></span>  
  
 <span data-ttu-id="9f705-128">Il parametro <xref:System.Type> è il tipo dell'oggetto in fase di serializzazione, deserializzazione, importazione o esportazione.</span><span class="sxs-lookup"><span data-stu-id="9f705-128">The <xref:System.Type> parameter is the type of the object that is being serialized, deserialized, imported, or exported.</span></span> <span data-ttu-id="9f705-129">Il metodo <xref:System.Runtime.Serialization.IDataContractSurrogate.GetDataContractType%2A> deve restituire il tipo di input se il surrogato non gestisce il tipo.</span><span class="sxs-lookup"><span data-stu-id="9f705-129">The <xref:System.Runtime.Serialization.IDataContractSurrogate.GetDataContractType%2A> method must return the input type if the surrogate does not handle the type.</span></span> <span data-ttu-id="9f705-130">In caso contrario restituisce il tipo surrogato appropriato.</span><span class="sxs-lookup"><span data-stu-id="9f705-130">Otherwise, return the appropriate surrogated type.</span></span> <span data-ttu-id="9f705-131">Se esistono vari tipi surrogati, è possibile definire vari mapping in questo metodo.</span><span class="sxs-lookup"><span data-stu-id="9f705-131">If several surrogate types exist, numerous mappings can be defined in this method.</span></span>  
  
 <span data-ttu-id="9f705-132">Il metodo <xref:System.Runtime.Serialization.IDataContractSurrogate.GetDataContractType%2A> non viene chiamato per primitivi del contratto dati incorporati, ad esempio <xref:System.Int32> o <xref:System.String>.</span><span class="sxs-lookup"><span data-stu-id="9f705-132">The <xref:System.Runtime.Serialization.IDataContractSurrogate.GetDataContractType%2A> method is not called for built-in data contract primitives, such as <xref:System.Int32> or <xref:System.String>.</span></span> <span data-ttu-id="9f705-133">Per gli altri tipi, ad esempio matrici, tipi definiti dall'utente e altre strutture di dati, questo metodo verrà chiamato per ogni tipo.</span><span class="sxs-lookup"><span data-stu-id="9f705-133">For other types, such as arrays, user-defined types, and other data structures, this method will be called for each type.</span></span>  
  
 <span data-ttu-id="9f705-134">Nell'esempio precedente il metodo verifica se il parametro `type` e `Inventory` sono confrontabili.</span><span class="sxs-lookup"><span data-stu-id="9f705-134">In the previous example, the method checks if the `type` parameter and `Inventory` are comparable.</span></span> <span data-ttu-id="9f705-135">In tal caso, il metodo lo mappa a `InventorySurrogated`.</span><span class="sxs-lookup"><span data-stu-id="9f705-135">If so, the method maps it to `InventorySurrogated`.</span></span> <span data-ttu-id="9f705-136">Ogni volta che viene chiamata una serializzazione, una deserializzazione, uno schema di importazione o di esportazione, questa funzione viene chiamata per prima per determinare il mapping tra tipi.</span><span class="sxs-lookup"><span data-stu-id="9f705-136">Whenever a serialization, deserialization, import schema, or export schema is called, this function is called first to determine the mapping between types.</span></span>  
  
### <a name="getobjecttoserialize-method"></a><span data-ttu-id="9f705-137">Metodo GetObjectToSerialize</span><span class="sxs-lookup"><span data-stu-id="9f705-137">GetObjectToSerialize Method</span></span>  
 <span data-ttu-id="9f705-138">Il metodo <xref:System.Runtime.Serialization.IDataContractSurrogate.GetObjectToSerialize%2A> converte l'istanza del tipo originale nell'istanza del tipo surrogato.</span><span class="sxs-lookup"><span data-stu-id="9f705-138">The <xref:System.Runtime.Serialization.IDataContractSurrogate.GetObjectToSerialize%2A> method converts the original type instance to the surrogated type instance.</span></span> <span data-ttu-id="9f705-139">È necessario per la serializzazione.</span><span class="sxs-lookup"><span data-stu-id="9f705-139">The method is required for serialization.</span></span>  
  
 <span data-ttu-id="9f705-140">Il passaggio successivo consiste nel definire il modo in cui i dati fisici verranno mappati dall'istanza originale al surrogato implementando il metodo <xref:System.Runtime.Serialization.IDataContractSurrogate.GetObjectToSerialize%2A>.</span><span class="sxs-lookup"><span data-stu-id="9f705-140">The next step is to define the way the physical data will be mapped from the original instance to the surrogate by implementing the <xref:System.Runtime.Serialization.IDataContractSurrogate.GetObjectToSerialize%2A> method.</span></span> <span data-ttu-id="9f705-141">Ad esempio:</span><span class="sxs-lookup"><span data-stu-id="9f705-141">For example:</span></span>  
  
 [!code-csharp[C_IDataContractSurrogate#4](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_idatacontractsurrogate/cs/source.cs#4)]  
  
 <span data-ttu-id="9f705-142">Il metodo <xref:System.Runtime.Serialization.IDataContractSurrogate.GetObjectToSerialize%2A> viene chiamato quando un oggetto viene serializzato.</span><span class="sxs-lookup"><span data-stu-id="9f705-142">The <xref:System.Runtime.Serialization.IDataContractSurrogate.GetObjectToSerialize%2A> method is called when an object is serialized.</span></span> <span data-ttu-id="9f705-143">Questo metodo trasferisce dati dal tipo originale ai campi del tipo surrogato.</span><span class="sxs-lookup"><span data-stu-id="9f705-143">This method transfers data from the original type to the fields of the surrogated type.</span></span> <span data-ttu-id="9f705-144">I campi possono essere mappati direttamente ai campi surrogati oppure è possibile archiviare le modifiche dei dati originali nel surrogato.</span><span class="sxs-lookup"><span data-stu-id="9f705-144">Fields can be directly mapped to surrogate fields, or manipulations of the original data may be stored in the surrogate.</span></span> <span data-ttu-id="9f705-145">Gli utilizzi possibili comprendono: mapping diretto dei campi, esecuzione di operazioni sui dati da archiviare nei campi surrogati, archiviazione dell'XML del tipo originale nel campo surrogato.</span><span class="sxs-lookup"><span data-stu-id="9f705-145">Some possible uses include: directly mapping the fields, performing operations on the data to be stored in the surrogated fields, or storing the XML of the original type in the surrogated field.</span></span>  
  
 <span data-ttu-id="9f705-146">Il parametro `targetType` fa riferimento al tipo dichiarato del membro.</span><span class="sxs-lookup"><span data-stu-id="9f705-146">The `targetType` parameter refers to the declared type of the member.</span></span> <span data-ttu-id="9f705-147">Questo parametro è il tipo surrogato restituito dal metodo <xref:System.Runtime.Serialization.IDataContractSurrogate.GetDataContractType%2A>.</span><span class="sxs-lookup"><span data-stu-id="9f705-147">This parameter is the surrogated type returned by the <xref:System.Runtime.Serialization.IDataContractSurrogate.GetDataContractType%2A> method.</span></span> <span data-ttu-id="9f705-148">Il serializzatore non implica che l'oggetto restituito possa essere assegnato a questo tipo.</span><span class="sxs-lookup"><span data-stu-id="9f705-148">The serializer does not enforce that the object returned is assignable to this type.</span></span> <span data-ttu-id="9f705-149">Il `obj` parametro è l'oggetto da serializzare e verrà convertito nel relativo surrogato, se necessario.</span><span class="sxs-lookup"><span data-stu-id="9f705-149">The `obj` parameter is the object to serialize, and will be converted to its surrogate if necessary.</span></span> <span data-ttu-id="9f705-150">Questo metodo deve restituire l'oggetto di input se il surrogato non gestisce l'oggetto.</span><span class="sxs-lookup"><span data-stu-id="9f705-150">This method must return the input object if the surrogated does not handle the object.</span></span> <span data-ttu-id="9f705-151">In caso contrario, verrà restituito il nuovo oggetto surrogato.</span><span class="sxs-lookup"><span data-stu-id="9f705-151">Otherwise, the new surrogate object will be returned.</span></span> <span data-ttu-id="9f705-152">Il surrogato non viene chiamato se l'oggetto è null.</span><span class="sxs-lookup"><span data-stu-id="9f705-152">The surrogate is not called if the object is null.</span></span> <span data-ttu-id="9f705-153">In questo metodo è possibile definire numerosi mapping surrogati per istanze diverse.</span><span class="sxs-lookup"><span data-stu-id="9f705-153">Numerous surrogate mappings for different instances may be defined within this method.</span></span>  
  
 <span data-ttu-id="9f705-154">Quando si crea una classe <xref:System.Runtime.Serialization.DataContractSerializer>, è possibile fare in modo che conservi i riferimenti all'oggetto.</span><span class="sxs-lookup"><span data-stu-id="9f705-154">When creating a <xref:System.Runtime.Serialization.DataContractSerializer>, you can instruct it to preserve object references.</span></span> <span data-ttu-id="9f705-155">Per ulteriori informazioni, vedere [serializzazione e deserializzazione](../feature-details/serialization-and-deserialization.md). A tale scopo, impostare il parametro `preserveObjectReferences` nel costruttore su `true`.</span><span class="sxs-lookup"><span data-stu-id="9f705-155">(For more information, see [Serialization and Deserialization](../feature-details/serialization-and-deserialization.md).) This is done by setting the `preserveObjectReferences` parameter in its constructor to `true`.</span></span> <span data-ttu-id="9f705-156">In questo caso, il surrogato viene chiamato solo una volta per un oggetto dal momento che tutte le serializzazioni successive scrivono il riferimento nel flusso.</span><span class="sxs-lookup"><span data-stu-id="9f705-156">In that case, the surrogate is called only once for an object since all subsequent serializations just write the reference into the stream.</span></span> <span data-ttu-id="9f705-157">Se il parametro `preserveObjectReferences` è impostato su `false`, il surrogato viene chiamato ogni volta che si verifica un'istanza.</span><span class="sxs-lookup"><span data-stu-id="9f705-157">If `preserveObjectReferences` is set to `false`, then the surrogate is called every time an instance is encountered.</span></span>  
  
 <span data-ttu-id="9f705-158">Se il tipo dell'istanza serializzata differisce dal tipo dichiarato, le informazioni sul tipo vengono scritte nel flusso, ad esempio `xsi:type`, per consentire la deserializzazione dell'istanza all'altra estremità.</span><span class="sxs-lookup"><span data-stu-id="9f705-158">If the type of the instance serialized differs from the declared type, type information is written into the stream, for example, `xsi:type` to allow the instance to be deserialized at the other end.</span></span> <span data-ttu-id="9f705-159">Questo processo ha luogo a prescindere dalla circostanza che l'oggetto sia surrogato o no.</span><span class="sxs-lookup"><span data-stu-id="9f705-159">This process occurs whether the object is surrogated or not.</span></span>  
  
 <span data-ttu-id="9f705-160">Nell'esempio precedente i dati dell'istanza di `Inventory` vengono convertiti nei dati di `InventorySurrogated`.</span><span class="sxs-lookup"><span data-stu-id="9f705-160">The example above converts the data of the `Inventory` instance to that of `InventorySurrogated`.</span></span> <span data-ttu-id="9f705-161">Viene verificato il tipo dell'oggetto e vengono eseguite le manipolazioni necessarie per la conversione al tipo surrogato.</span><span class="sxs-lookup"><span data-stu-id="9f705-161">It checks the type of the object and performs the necessary manipulations to convert to the surrogated type.</span></span> <span data-ttu-id="9f705-162">In questo caso, i campi della classe `Inventory` vengono copiati direttamente sui campi della classe `InventorySurrogated`.</span><span class="sxs-lookup"><span data-stu-id="9f705-162">In this case, the fields of the `Inventory` class are directly copied over to the `InventorySurrogated` class fields.</span></span>  
  
### <a name="getdeserializedobject-method"></a><span data-ttu-id="9f705-163">Metodo GetDeserializedObject</span><span class="sxs-lookup"><span data-stu-id="9f705-163">GetDeserializedObject Method</span></span>  
 <span data-ttu-id="9f705-164">Il metodo <xref:System.Runtime.Serialization.IDataContractSurrogate.GetDeserializedObject%2A> converte l'istanza del tipo surrogato nell'istanza del tipo originale.</span><span class="sxs-lookup"><span data-stu-id="9f705-164">The <xref:System.Runtime.Serialization.IDataContractSurrogate.GetDeserializedObject%2A> method converts the surrogated type instance to the original type instance.</span></span> <span data-ttu-id="9f705-165">È obbligatorio per la deserializzazione.</span><span class="sxs-lookup"><span data-stu-id="9f705-165">It is required for deserialization.</span></span>  
  
 <span data-ttu-id="9f705-166">L'attività successiva consiste nel definire il modo in cui i dati fisici verranno mappati dall'istanza surrogata all'originale.</span><span class="sxs-lookup"><span data-stu-id="9f705-166">The next task is to define the way the physical data will be mapped from the surrogate instance to the original.</span></span> <span data-ttu-id="9f705-167">Ad esempio:</span><span class="sxs-lookup"><span data-stu-id="9f705-167">For example:</span></span>  
  
 [!code-csharp[C_IDataContractSurrogate#5](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_idatacontractsurrogate/cs/source.cs#5)]  
  
 <span data-ttu-id="9f705-168">Questo metodo viene chiamato solo durante la deserializzazione di un oggetto.</span><span class="sxs-lookup"><span data-stu-id="9f705-168">This method is called only during the deserialization of an object.</span></span> <span data-ttu-id="9f705-169">Fornisce il mapping dei dati inverso per la deserializzazione dal tipo surrogato al tipo originale.</span><span class="sxs-lookup"><span data-stu-id="9f705-169">It provides reverse data mapping for the deserialization from the surrogate type back to its original type.</span></span> <span data-ttu-id="9f705-170">Analogamente al metodo `GetObjectToSerialize`, alcuni possibili utilizzi sono lo scambio diretto dei dati del campo, l'esecuzione di operazioni sui dati e l'archiviazione di dati XML.</span><span class="sxs-lookup"><span data-stu-id="9f705-170">Similar to the `GetObjectToSerialize` method, some possible uses may be to directly exchange field data, perform operations on the data, and store XML data.</span></span> <span data-ttu-id="9f705-171">Quando si deserializza, non sempre è possibile ottenere dall'originale i valori dei dati esatti a causa di modifiche intervenute durante la conversione dei dati.</span><span class="sxs-lookup"><span data-stu-id="9f705-171">When  deserializing, you may not always obtain the exact data values from original due to manipulations in the data conversion.</span></span>  
  
 <span data-ttu-id="9f705-172">Il parametro `targetType` fa riferimento al tipo dichiarato del membro.</span><span class="sxs-lookup"><span data-stu-id="9f705-172">The `targetType` parameter refers to the declared type of the member.</span></span> <span data-ttu-id="9f705-173">Questo parametro è il tipo surrogato restituito dal metodo `GetDataContractType`.</span><span class="sxs-lookup"><span data-stu-id="9f705-173">This parameter is the surrogated type returned by the `GetDataContractType` method.</span></span> <span data-ttu-id="9f705-174">Il `obj` parametro fa riferimento all'oggetto che è stato deserializzato.</span><span class="sxs-lookup"><span data-stu-id="9f705-174">The `obj` parameter refers to the object that has been deserialized.</span></span> <span data-ttu-id="9f705-175">Se surrogato, l'oggetto può essere convertito di nuovo nel tipo originale.</span><span class="sxs-lookup"><span data-stu-id="9f705-175">The object can be converted back to its original type if it is surrogated.</span></span> <span data-ttu-id="9f705-176">Questo metodo restituisce l'oggetto di input se il surrogato non gestisce l'oggetto.</span><span class="sxs-lookup"><span data-stu-id="9f705-176">This method returns the input object if the surrogate does not handle the object.</span></span> <span data-ttu-id="9f705-177">In caso contrario l'oggetto deserializzato verrà restituito dopo il completamento della conversione.</span><span class="sxs-lookup"><span data-stu-id="9f705-177">Otherwise, the deserialized object will be returned once its conversion has been completed.</span></span> <span data-ttu-id="9f705-178">Se esistono molti tipi surrogati, è possibile fornire per ognuno la conversione dei dati da surrogato a tipo originale indicando ogni tipo e la relativa conversione.</span><span class="sxs-lookup"><span data-stu-id="9f705-178">If several surrogate types exist, you may provide data conversion from surrogate to primary type for each by indicating each type and its conversion.</span></span>  
  
 <span data-ttu-id="9f705-179">Durante la restituzione di un oggetto, le tabelle degli oggetti interni vengono aggiornate con l'oggetto restituito da questo surrogato.</span><span class="sxs-lookup"><span data-stu-id="9f705-179">When returning an object, the internal object tables are updated with the object returned by this surrogate.</span></span> <span data-ttu-id="9f705-180">Qualsiasi riferimento successivo a un'istanza otterrà l'istanza del surrogato dalle tabelle degli oggetti.</span><span class="sxs-lookup"><span data-stu-id="9f705-180">Any subsequent references to an instance will obtain the surrogated instance from the object tables.</span></span>  
  
 <span data-ttu-id="9f705-181">Nell'esempio precedente gli oggetti di tipo `InventorySurrogated` vengono nuovamente convertiti nel tipo `Inventory`iniziale.</span><span class="sxs-lookup"><span data-stu-id="9f705-181">The previous example converts objects of type `InventorySurrogated` back to the initial type `Inventory`.</span></span> <span data-ttu-id="9f705-182">In questo caso, i dati sono trasferiti direttamente da `InventorySurrogated` ai campi corrispondenti in `Inventory`.</span><span class="sxs-lookup"><span data-stu-id="9f705-182">In this case, data is directly transferred back from `InventorySurrogated` to its corresponding fields in `Inventory`.</span></span> <span data-ttu-id="9f705-183">Poiché non sussistono modifiche dei dati, ogni campo membro conterrà gli stessi valori esistenti prima della serializzazione.</span><span class="sxs-lookup"><span data-stu-id="9f705-183">Because there are no data manipulations, the each of the member fields will contain the same values as before the serialization.</span></span>  
  
### <a name="getcustomdatatoexport-method"></a><span data-ttu-id="9f705-184">Metodo GetCustomDataToExport</span><span class="sxs-lookup"><span data-stu-id="9f705-184">GetCustomDataToExport Method</span></span>  
 <span data-ttu-id="9f705-185">Durante l'esportazione di uno schema, il metodo <xref:System.Runtime.Serialization.IDataContractSurrogate.GetCustomDataToExport%2A> è facoltativo.</span><span class="sxs-lookup"><span data-stu-id="9f705-185">When exporting a schema, the <xref:System.Runtime.Serialization.IDataContractSurrogate.GetCustomDataToExport%2A> method is optional.</span></span> <span data-ttu-id="9f705-186">Viene utilizzato per inserire dati aggiuntivi o suggerimenti nello schema esportato.</span><span class="sxs-lookup"><span data-stu-id="9f705-186">It is used to insert additional data or hints into the exported schema.</span></span> <span data-ttu-id="9f705-187">I dati aggiuntivi possono essere inseriti a livello di membro o a livello di tipo.</span><span class="sxs-lookup"><span data-stu-id="9f705-187">Additional data can be inserted at the member level or type level.</span></span> <span data-ttu-id="9f705-188">Ad esempio:</span><span class="sxs-lookup"><span data-stu-id="9f705-188">For example:</span></span>  
  
 [!code-csharp[C_IDataContractSurrogate#6](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_idatacontractsurrogate/cs/source.cs#6)]  
  
 <span data-ttu-id="9f705-189">Questo metodo (con due overload) consente l'inclusione di informazioni aggiuntive nei metadati a livello di membro o di tipo.</span><span class="sxs-lookup"><span data-stu-id="9f705-189">This method (with two overloads) enables the inclusion of extra information into the metadata either at the member or type level.</span></span> <span data-ttu-id="9f705-190">È possibile includere suggerimenti sulla qualità pubblica o privata di un membro e commenti che vengono conservati per tutta la durata dell'esportazione e dell'importazione dello schema.</span><span class="sxs-lookup"><span data-stu-id="9f705-190">It is possible to include hints about whether a member is public or private, and comments which would be preserved throughout the export and import of the schema.</span></span> <span data-ttu-id="9f705-191">Tali informazioni andrebbero perse senza questo metodo.</span><span class="sxs-lookup"><span data-stu-id="9f705-191">Such information would be lost without this method.</span></span> <span data-ttu-id="9f705-192">Il metodo non provoca l'inserimento o l'eliminazione di membri o tipi, piuttosto inserisce dati aggiuntivi negli schemi in corrispondenza di uno di questi livelli.</span><span class="sxs-lookup"><span data-stu-id="9f705-192">This method does not cause the insertion or deletion of members or types, but rather adds additional data to the schemas at either of these levels.</span></span>  
  
 <span data-ttu-id="9f705-193">Il metodo è sottoposto a overload e può assumere un `Type` (il parametro `clrtype`) o <xref:System.Reflection.MemberInfo> (il parametro `memberInfo`).</span><span class="sxs-lookup"><span data-stu-id="9f705-193">The method is overloaded and can take either a `Type` (`clrtype` parameter) or <xref:System.Reflection.MemberInfo> (`memberInfo` parameter).</span></span> <span data-ttu-id="9f705-194">Il secondo parametro è sempre un `Type` (il parametro `dataContractType`).</span><span class="sxs-lookup"><span data-stu-id="9f705-194">The second parameter is always a `Type` (`dataContractType` parameter).</span></span> <span data-ttu-id="9f705-195">Questo metodo viene chiamato per ogni membro e tipo del tipo `dataContractType` surrogato.</span><span class="sxs-lookup"><span data-stu-id="9f705-195">This method is called for every member and type of the surrogated `dataContractType` type.</span></span>  
  
 <span data-ttu-id="9f705-196">Uno dei due overload deve restituire `null` o un oggetto serializzabile.</span><span class="sxs-lookup"><span data-stu-id="9f705-196">Either of these overloads must return either `null` or a serializable object.</span></span> <span data-ttu-id="9f705-197">Un oggetto diverso da null verrà serializzato come annotazione nello schema esportato.</span><span class="sxs-lookup"><span data-stu-id="9f705-197">A non-null object will be serialized as annotation into the exported schema.</span></span> <span data-ttu-id="9f705-198">Per l'overload di `Type`, ogni tipo esportato nello schema viene inviato al metodo nel primo parametro unitamente al tipo surrogato come parametro `dataContractType`.</span><span class="sxs-lookup"><span data-stu-id="9f705-198">For the `Type` overload, each type that is exported to schema is sent to this method in the first parameter along with the surrogated type as the `dataContractType` parameter.</span></span> <span data-ttu-id="9f705-199">Per l'overload di `MemberInfo`, ogni membro esportato nello schema invia le rispettive informazioni come parametro `memberInfo` con il tipo surrogato nel secondo parametro.</span><span class="sxs-lookup"><span data-stu-id="9f705-199">For the `MemberInfo` overload, each member that is exported to schema sends its information as the `memberInfo` parameter with the surrogated type in the second parameter.</span></span>  
  
#### <a name="getcustomdatatoexport-method-type-type"></a><span data-ttu-id="9f705-200">Metodo GetCustomDataToExport (Type, Type)</span><span class="sxs-lookup"><span data-stu-id="9f705-200">GetCustomDataToExport Method (Type, Type)</span></span>  
 <span data-ttu-id="9f705-201">Il metodo <xref:System.Runtime.Serialization.IDataContractSurrogate.GetCustomDataToExport%28System.Type%2CSystem.Type%29?displayProperty=nameWithType> viene chiamato durante l'esportazione dello schema per ogni definizione del tipo.</span><span class="sxs-lookup"><span data-stu-id="9f705-201">The <xref:System.Runtime.Serialization.IDataContractSurrogate.GetCustomDataToExport%28System.Type%2CSystem.Type%29?displayProperty=nameWithType> method is called during schema export for every type definition.</span></span> <span data-ttu-id="9f705-202">Il metodo aggiunge informazioni ai tipi all'interno dello schema durante l'esportazione.</span><span class="sxs-lookup"><span data-stu-id="9f705-202">The method adds information to the types within the schema when exporting.</span></span> <span data-ttu-id="9f705-203">Ogni tipo definito viene inviato a questo metodo per determinare se esistono dati aggiuntivi da includere nello schema.</span><span class="sxs-lookup"><span data-stu-id="9f705-203">Each type defined is sent to this method to determine whether there is any additional data that needs to be included in the schema.</span></span>  
  
#### <a name="getcustomdatatoexport-method-memberinfo-type"></a><span data-ttu-id="9f705-204">Metodo GetCustomDataToExport (MemberInfo, Type)</span><span class="sxs-lookup"><span data-stu-id="9f705-204">GetCustomDataToExport Method (MemberInfo, Type)</span></span>  
 <span data-ttu-id="9f705-205">Il metodo <xref:System.Runtime.Serialization.IDataContractSurrogate.GetCustomDataToExport%28System.Reflection.MemberInfo%2CSystem.Type%29?displayProperty=nameWithType> viene chiamato durante l'esportazione per ogni membro esistente nei tipi esportati.</span><span class="sxs-lookup"><span data-stu-id="9f705-205">The <xref:System.Runtime.Serialization.IDataContractSurrogate.GetCustomDataToExport%28System.Reflection.MemberInfo%2CSystem.Type%29?displayProperty=nameWithType> is called during export for every member in the types that are exported.</span></span> <span data-ttu-id="9f705-206">Questa funzione consente di personalizzare eventuali commenti per i membri che verranno inclusi nello schema in fase di esportazione.</span><span class="sxs-lookup"><span data-stu-id="9f705-206">This function enables you to customize any comments for the members that will be included in the schema upon export.</span></span> <span data-ttu-id="9f705-207">Le informazioni relative a ogni membro della classe vengono inviate al metodo per appurare se è necessario aggiungere altri dati allo schema.</span><span class="sxs-lookup"><span data-stu-id="9f705-207">The information for every member within the class is sent to this method to check whether any additional data need to be added in the schema.</span></span>  
  
 <span data-ttu-id="9f705-208">Nell'esempio precedente viene analizzato `dataContractType` alla ricerca di ogni membro del surrogato.</span><span class="sxs-lookup"><span data-stu-id="9f705-208">The example above searches through the `dataContractType` for each member of the surrogate.</span></span> <span data-ttu-id="9f705-209">Viene quindi restituito il modificatore di accesso appropriato per ogni campo.</span><span class="sxs-lookup"><span data-stu-id="9f705-209">It then returns the appropriate access modifier for each field.</span></span> <span data-ttu-id="9f705-210">Senza questa personalizzazione, il valore predefinito dei modificatori di accesso è pubblico.</span><span class="sxs-lookup"><span data-stu-id="9f705-210">Without this customization, the default value for access modifiers is public.</span></span> <span data-ttu-id="9f705-211">Pertanto, tutti i membri verrebbero definiti come pubblici nel codice generato utilizzando lo schema esportato, indipendentemente dalle effettive restrizioni di accesso.</span><span class="sxs-lookup"><span data-stu-id="9f705-211">Therefore, all members would be defined as public in the code generated using the exported schema no matter what their actual access restrictions are.</span></span> <span data-ttu-id="9f705-212">Se non si utilizza questa implementazione, il membro `numpens` sarebbe pubblico nello schema esportato anche se definito come privato nel surrogato.</span><span class="sxs-lookup"><span data-stu-id="9f705-212">When not using this implementation, the member `numpens` would be public in the exported schema even though it was defined in the surrogate as private.</span></span> <span data-ttu-id="9f705-213">Con l'utilizzo di questo metodo nello schema esportato, il modificatore di accesso può essere generato come privato.</span><span class="sxs-lookup"><span data-stu-id="9f705-213">Through the use of this method, in the exported schema, the access modifier can be generated as private.</span></span>  
  
### <a name="getreferencedtypeonimport-method"></a><span data-ttu-id="9f705-214">Metodo GetReferencedTypeOnImport</span><span class="sxs-lookup"><span data-stu-id="9f705-214">GetReferencedTypeOnImport Method</span></span>  
 <span data-ttu-id="9f705-215">Questo metodo mappa la classe<xref:System.Type> del surrogato al tipo originale.</span><span class="sxs-lookup"><span data-stu-id="9f705-215">This method maps the <xref:System.Type> of the surrogate to the original type.</span></span> <span data-ttu-id="9f705-216">È facoltativo per l'importazione dello schema.</span><span class="sxs-lookup"><span data-stu-id="9f705-216">This method is optional for schema importation.</span></span>  
  
 <span data-ttu-id="9f705-217">In caso di creazione di un surrogato che importa uno schema e genera codice appositamente, l'attività successiva consiste nel definire il tipo di un'istanza surrogata rispetto al tipo originale.</span><span class="sxs-lookup"><span data-stu-id="9f705-217">When creating a surrogate that imports a schema and generates code for it, the next task is to define the type of a surrogate instance to its original type.</span></span>  
  
 <span data-ttu-id="9f705-218">Se per il codice generato è necessario fare riferimento a un tipo utente esistente, questa operazione è possibile implementando il metodo <xref:System.Runtime.Serialization.IDataContractSurrogate.GetReferencedTypeOnImport%2A>.</span><span class="sxs-lookup"><span data-stu-id="9f705-218">If the generated code needs to reference an existing user type, this is done by implementing the <xref:System.Runtime.Serialization.IDataContractSurrogate.GetReferencedTypeOnImport%2A> method.</span></span>  
  
 <span data-ttu-id="9f705-219">In caso di importazione di uno schema, questo metodo viene chiamato per ogni dichiarazione di tipo per mappare il contratto dati surrogato a un tipo.</span><span class="sxs-lookup"><span data-stu-id="9f705-219">When importing a schema, this method is called for every type declaration to map the surrogated data contract to a type.</span></span> <span data-ttu-id="9f705-220">I parametri di stringa `typeName` e `typeNamespace` definiscono il nome e lo spazio dei nomi del tipo surrogato.</span><span class="sxs-lookup"><span data-stu-id="9f705-220">The string parameters `typeName` and `typeNamespace` define the name and namespace of the surrogated type.</span></span> <span data-ttu-id="9f705-221">Il valore restituito per <xref:System.Runtime.Serialization.IDataContractSurrogate.GetReferencedTypeOnImport%2A> viene utilizzato per determinare l'esigenza di generare un tipo nuovo.</span><span class="sxs-lookup"><span data-stu-id="9f705-221">The return value for <xref:System.Runtime.Serialization.IDataContractSurrogate.GetReferencedTypeOnImport%2A> is used to determine whether a new type needs to be generated.</span></span> <span data-ttu-id="9f705-222">Questo metodo deve restituire un tipo valido o null.</span><span class="sxs-lookup"><span data-stu-id="9f705-222">This method must return either a valid type or null.</span></span> <span data-ttu-id="9f705-223">Per i tipi validi, il tipo restituito verrà utilizzato nel codice generato come tipo a cui viene fatto riferimento.</span><span class="sxs-lookup"><span data-stu-id="9f705-223">For valid types, the type returned will be used as a referenced type in the generated code.</span></span> <span data-ttu-id="9f705-224">Se viene restituito null, non verrà fatto riferimento ad alcun tipo e verrà creato un tipo nuovo.</span><span class="sxs-lookup"><span data-stu-id="9f705-224">If null is returned, no type will be referenced and a new type must be created.</span></span> <span data-ttu-id="9f705-225">Se esistono molti surrogati, è possibile eseguire di nuovo il mapping di ogni tipo surrogato al tipo iniziale.</span><span class="sxs-lookup"><span data-stu-id="9f705-225">If several surrogates exist, it is possible to perform the mapping for each surrogate type back to its initial type.</span></span>  
  
 <span data-ttu-id="9f705-226">Il parametro `customData` è l'oggetto derivato in origine da <xref:System.Runtime.Serialization.IDataContractSurrogate.GetCustomDataToExport%2A>.</span><span class="sxs-lookup"><span data-stu-id="9f705-226">The `customData` parameter is the object originally returned from <xref:System.Runtime.Serialization.IDataContractSurrogate.GetCustomDataToExport%2A>.</span></span> <span data-ttu-id="9f705-227">Il parametro `customData` viene utilizzato quando gli autori di surrogati desiderano inserire dati aggiuntivi/suggerimenti nei metadati da utilizzare durante l'importazione per generare codice.</span><span class="sxs-lookup"><span data-stu-id="9f705-227">This `customData` is used when surrogate authors want to insert extra data/hints into the metadata to use during import to generate code.</span></span>  
  
### <a name="processimportedtype-method"></a><span data-ttu-id="9f705-228">Metodo ProcessImportedType</span><span class="sxs-lookup"><span data-stu-id="9f705-228">ProcessImportedType Method</span></span>  
 <span data-ttu-id="9f705-229">Il metodo <xref:System.Runtime.Serialization.IDataContractSurrogate.ProcessImportedType%2A> personalizza qualsiasi tipo creato dall'importazione dello schema.</span><span class="sxs-lookup"><span data-stu-id="9f705-229">The <xref:System.Runtime.Serialization.IDataContractSurrogate.ProcessImportedType%2A> method customizes any type created from schema importation.</span></span> <span data-ttu-id="9f705-230">È facoltativo.</span><span class="sxs-lookup"><span data-stu-id="9f705-230">This method is optional.</span></span>  
  
 <span data-ttu-id="9f705-231">In caso di importazione di uno schema, questo metodo consente la personalizzazione di qualsiasi tipo importato e di qualsiasi informazione di compilazione.</span><span class="sxs-lookup"><span data-stu-id="9f705-231">When importing a schema, this method allows for any imported type and compilation information to be customized.</span></span> <span data-ttu-id="9f705-232">Ad esempio:</span><span class="sxs-lookup"><span data-stu-id="9f705-232">For example:</span></span>  
  
 [!code-csharp[C_IDataContractSurrogate#7](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_idatacontractsurrogate/cs/source.cs#7)]  
  
 <span data-ttu-id="9f705-233">Durante l'importazione, questo metodo viene chiamato per ogni tipo generato.</span><span class="sxs-lookup"><span data-stu-id="9f705-233">During import, this method is called for every type generated.</span></span> <span data-ttu-id="9f705-234">Modificare la classe <xref:System.CodeDom.CodeTypeDeclaration> specificata o la classe <xref:System.CodeDom.CodeCompileUnit>.</span><span class="sxs-lookup"><span data-stu-id="9f705-234">Change the specified <xref:System.CodeDom.CodeTypeDeclaration> or modify the <xref:System.CodeDom.CodeCompileUnit>.</span></span> <span data-ttu-id="9f705-235">Tale operazione include la modifica del nome, dei membri, degli attributi e di molte altre proprietà di `CodeTypeDeclaration`.</span><span class="sxs-lookup"><span data-stu-id="9f705-235">This includes changing the name, members, attributes, and many other properties of the `CodeTypeDeclaration`.</span></span> <span data-ttu-id="9f705-236">Elaborando `CodeCompileUnit`, è possibile modificare le direttive, gli spazi dei nomi, gli assembly di riferimento e molti altri aspetti.</span><span class="sxs-lookup"><span data-stu-id="9f705-236">By processing the `CodeCompileUnit`, it is possible to modify the directives, namespaces, referenced assemblies, and several other aspects.</span></span>  
  
 <span data-ttu-id="9f705-237">Il parametro `CodeTypeDeclaration` contiene la dichiarazione del tipo code DOM.</span><span class="sxs-lookup"><span data-stu-id="9f705-237">The `CodeTypeDeclaration` parameter contains the code DOM type declaration.</span></span> <span data-ttu-id="9f705-238">Il parametro `CodeCompileUnit` consente le modifiche per l'elaborazione del codice.</span><span class="sxs-lookup"><span data-stu-id="9f705-238">The `CodeCompileUnit` parameter allows for modification for processing the code.</span></span>  <span data-ttu-id="9f705-239">La restituzione di `null` sfocia nell'eliminazione della dichiarazione del tipo.</span><span class="sxs-lookup"><span data-stu-id="9f705-239">Returning `null` results in the type declaration being discarded.</span></span> <span data-ttu-id="9f705-240">Per contro, la restituzione di `CodeTypeDeclaration` comporta il mantenimento delle modifiche.</span><span class="sxs-lookup"><span data-stu-id="9f705-240">Conversely, when returning a `CodeTypeDeclaration`, the modifications are preserved.</span></span>  
  
 <span data-ttu-id="9f705-241">Se i dati personalizzati vengono inseriti durante l'esportazione dei metadati, è necessario che vengano forniti all'utente durante l'importazione perché possano essere utilizzati.</span><span class="sxs-lookup"><span data-stu-id="9f705-241">If custom data is inserted during metadata export, it needs to be provided to the user during import so that it can be used.</span></span> <span data-ttu-id="9f705-242">I dati personalizzati possono essere utilizzati per suggerimenti dei modello di programmazione o altri commenti.</span><span class="sxs-lookup"><span data-stu-id="9f705-242">This custom data can be used for programming model hints, or other comments.</span></span> <span data-ttu-id="9f705-243">Ogni istanza di `CodeTypeDeclaration` e di <xref:System.CodeDom.CodeTypeMember> comprende dati personalizzati, come la proprietà <xref:System.CodeDom.CodeObject.UserData%2A>, di cui è eseguito il cast al tipo `IDataContractSurrogate`.</span><span class="sxs-lookup"><span data-stu-id="9f705-243">Each `CodeTypeDeclaration` and <xref:System.CodeDom.CodeTypeMember> instance includes custom data as the <xref:System.CodeDom.CodeObject.UserData%2A> property, cast to the `IDataContractSurrogate` type.</span></span>  
  
 <span data-ttu-id="9f705-244">Nell'esempio precedente vengono eseguite alcune modifiche sullo schema importato.</span><span class="sxs-lookup"><span data-stu-id="9f705-244">The example above performs some changes on the schema imported.</span></span> <span data-ttu-id="9f705-245">Il codice mantiene membri privati del tipo originale utilizzando un surrogato.</span><span class="sxs-lookup"><span data-stu-id="9f705-245">The code preserves private members of the original type by using a surrogate.</span></span> <span data-ttu-id="9f705-246">Il modificatore di accesso predefinito durante l'importazione di uno schema è `public`.</span><span class="sxs-lookup"><span data-stu-id="9f705-246">The default access modifier when importing a schema is `public`.</span></span> <span data-ttu-id="9f705-247">Pertanto, tutti i membri dello schema surrogato saranno pubblici a meno che non vengano modificati, come in questo esempio.</span><span class="sxs-lookup"><span data-stu-id="9f705-247">Therefore, all members of the surrogate schema will be public unless modified, as in this example.</span></span> <span data-ttu-id="9f705-248">Durante l'esportazione, vengono inseriti nei metadati dati personalizzati relativi ai membri privati.</span><span class="sxs-lookup"><span data-stu-id="9f705-248">During export, custom data is inserted into the metadata about which members are private.</span></span> <span data-ttu-id="9f705-249">Nell'esempio vengono cercati i dati personalizzati, viene verificato se il modificatore di accesso è privato e il membro appropriato viene quindi cambiato in privato mediante l'impostazione dei relativi attributi.</span><span class="sxs-lookup"><span data-stu-id="9f705-249">The example looks up the custom data, checks whether the access modifier is private, and then modifies the appropriate member to be private by setting its attributes.</span></span> <span data-ttu-id="9f705-250">Senza questa personalizzazione, il membro `numpens` verrebbe definito pubblico anziché privato.</span><span class="sxs-lookup"><span data-stu-id="9f705-250">Without this customization, the `numpens` member would be defined as public instead of private.</span></span>  
  
### <a name="getknowncustomdatatypes-method"></a><span data-ttu-id="9f705-251">Metodo GetKnownCustomDataTypes</span><span class="sxs-lookup"><span data-stu-id="9f705-251">GetKnownCustomDataTypes Method</span></span>  
 <span data-ttu-id="9f705-252">Questo metodo ottiene dallo schema tipi di dati personalizzati definiti.</span><span class="sxs-lookup"><span data-stu-id="9f705-252">This method obtains custom data types defined from the schema.</span></span> <span data-ttu-id="9f705-253">È facoltativo per l'importazione dello schema.</span><span class="sxs-lookup"><span data-stu-id="9f705-253">The method is optional for schema importation.</span></span>  
  
 <span data-ttu-id="9f705-254">Il metodo  viene chiamato all'inizio dell'esportazione e dell'importazione dello schema.</span><span class="sxs-lookup"><span data-stu-id="9f705-254">The method is called at the beginning of schema export and import.</span></span> <span data-ttu-id="9f705-255">Restituisce i tipi di dati personalizzati utilizzati nello schema esportato o importato.</span><span class="sxs-lookup"><span data-stu-id="9f705-255">The method returns the custom data types used in the schema exported or imported.</span></span> <span data-ttu-id="9f705-256">Viene passato a <xref:System.Collections.ObjectModel.Collection%601> (il parametro `customDataTypes`), che è una raccolta di tipi.</span><span class="sxs-lookup"><span data-stu-id="9f705-256">The method is passed a <xref:System.Collections.ObjectModel.Collection%601> (the `customDataTypes` parameter), which is a collection of types.</span></span> <span data-ttu-id="9f705-257">Il metodo aggiunge ulteriori tipi noti a questa raccolta.</span><span class="sxs-lookup"><span data-stu-id="9f705-257">The method should add additional known types to this collection.</span></span> <span data-ttu-id="9f705-258">I tipi di dati personalizzati conosciuti sono indispensabili per attivare la serializzazione e la deserializzazione dei dati personalizzati utilizzando la classe <xref:System.Runtime.Serialization.DataContractSerializer>.</span><span class="sxs-lookup"><span data-stu-id="9f705-258">The known custom data types are needed to enable serialization and deserialization of custom data using the <xref:System.Runtime.Serialization.DataContractSerializer>.</span></span> <span data-ttu-id="9f705-259">Per ulteriori informazioni, vedere [tipi noti del contratto dati](../feature-details/data-contract-known-types.md).</span><span class="sxs-lookup"><span data-stu-id="9f705-259">For more information, see [Data Contract Known Types](../feature-details/data-contract-known-types.md).</span></span>  
  
## <a name="implementing-a-surrogate"></a><span data-ttu-id="9f705-260">Implementazione di un surrogato</span><span class="sxs-lookup"><span data-stu-id="9f705-260">Implementing a Surrogate</span></span>  
 <span data-ttu-id="9f705-261">Per utilizzare il surrogato del contratto dati in WCF, è necessario seguire alcune procedure speciali.</span><span class="sxs-lookup"><span data-stu-id="9f705-261">To use the data contract surrogate within WCF, you must follow a few special procedures.</span></span>  
  
### <a name="to-use-a-surrogate-for-serialization-and-deserialization"></a><span data-ttu-id="9f705-262">Per utilizzare un surrogato per serializzazione e deserializzazione</span><span class="sxs-lookup"><span data-stu-id="9f705-262">To Use a Surrogate for Serialization and Deserialization</span></span>  
 <span data-ttu-id="9f705-263">Utilizzare la classe <xref:System.Runtime.Serialization.DataContractSerializer> per eseguire serializzazione e deserializzazione di dati con il surrogato.</span><span class="sxs-lookup"><span data-stu-id="9f705-263">Use the <xref:System.Runtime.Serialization.DataContractSerializer> to perform serialization and deserialization of data with the surrogate.</span></span> <span data-ttu-id="9f705-264">L'elemento <xref:System.Runtime.Serialization.DataContractSerializer> viene creato da <xref:System.ServiceModel.Description.DataContractSerializerOperationBehavior>.</span><span class="sxs-lookup"><span data-stu-id="9f705-264">The <xref:System.Runtime.Serialization.DataContractSerializer> is created by the <xref:System.ServiceModel.Description.DataContractSerializerOperationBehavior>.</span></span> <span data-ttu-id="9f705-265">È necessario specificare anche il surrogato.</span><span class="sxs-lookup"><span data-stu-id="9f705-265">The surrogate must also be specified.</span></span>  
  
##### <a name="to-implement-serialization-and-deserialization"></a><span data-ttu-id="9f705-266">Per implementare serializzazione e deserializzazione</span><span class="sxs-lookup"><span data-stu-id="9f705-266">To implement serialization and deserialization</span></span>  
  
1. <span data-ttu-id="9f705-267">Creare un'istanza di <xref:System.ServiceModel.ServiceHost> per il servizio.</span><span class="sxs-lookup"><span data-stu-id="9f705-267">Create an instance of the <xref:System.ServiceModel.ServiceHost> for your service.</span></span> <span data-ttu-id="9f705-268">Per istruzioni complete, vedere [programmazione WCF di base](../basic-wcf-programming.md).</span><span class="sxs-lookup"><span data-stu-id="9f705-268">For complete instructions, see [Basic WCF Programming](../basic-wcf-programming.md).</span></span>  
  
2. <span data-ttu-id="9f705-269">Per ogni <xref:System.ServiceModel.Description.ServiceEndpoint> dell'host del servizio specificato, cercare il rispettivo elemento <xref:System.ServiceModel.Description.OperationDescription>.</span><span class="sxs-lookup"><span data-stu-id="9f705-269">For every <xref:System.ServiceModel.Description.ServiceEndpoint> of the specified service host, find its <xref:System.ServiceModel.Description.OperationDescription>.</span></span>  
  
3. <span data-ttu-id="9f705-270">Esaminare i comportamenti dell'operazione per stabilire se viene trovata un'istanza di <xref:System.ServiceModel.Description.DataContractSerializerOperationBehavior>.</span><span class="sxs-lookup"><span data-stu-id="9f705-270">Search through the operation behaviors to determine if an instance of the <xref:System.ServiceModel.Description.DataContractSerializerOperationBehavior> is found.</span></span>  
  
4. <span data-ttu-id="9f705-271">Se viene trovato un elemento <xref:System.ServiceModel.Description.DataContractSerializerOperationBehavior>, impostarne la proprietà <xref:System.ServiceModel.Description.DataContractSerializerOperationBehavior.DataContractSurrogate%2A> su un'istanza nuova del surrogato.</span><span class="sxs-lookup"><span data-stu-id="9f705-271">If a <xref:System.ServiceModel.Description.DataContractSerializerOperationBehavior> is found, set its <xref:System.ServiceModel.Description.DataContractSerializerOperationBehavior.DataContractSurrogate%2A> property to a new instance of the surrogate.</span></span> <span data-ttu-id="9f705-272">Se non viene trovato alcun elemento <xref:System.ServiceModel.Description.DataContractSerializerOperationBehavior>, creare un'istanza nuova e impostare il membro <xref:System.ServiceModel.Description.DataContractSerializerOperationBehavior.DataContractSurrogate%2A> del nuovo comportamento su una nuova istanza del surrogato.</span><span class="sxs-lookup"><span data-stu-id="9f705-272">If no <xref:System.ServiceModel.Description.DataContractSerializerOperationBehavior> is found, then create a new instance and set the <xref:System.ServiceModel.Description.DataContractSerializerOperationBehavior.DataContractSurrogate%2A> member of the new behavior to a new instance of the surrogate.</span></span>  
  
5. <span data-ttu-id="9f705-273">Infine, aggiungere questo nuovo comportamento ai comportamenti dell'operazione correnti, come nell'esempio seguente:</span><span class="sxs-lookup"><span data-stu-id="9f705-273">Finally, add this new behavior to the current operation behaviors, as shown in the following example:</span></span>  
  
     [!code-csharp[C_IDataContractSurrogate#8](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_idatacontractsurrogate/cs/source.cs#8)]  
  
### <a name="to-use-a-surrogate-for-metadata-import"></a><span data-ttu-id="9f705-274">Per utilizzare un surrogato per l'importazione dei metadati</span><span class="sxs-lookup"><span data-stu-id="9f705-274">To Use a Surrogate for Metadata Import</span></span>  
 <span data-ttu-id="9f705-275">Durante l'importazione di metadati come WSDL e XSD per la generazione di codice del lato client, è necessario aggiungere il surrogato al componente responsabile della generazione di codice dallo schema XSD, <xref:System.Runtime.Serialization.XsdDataContractImporter>.</span><span class="sxs-lookup"><span data-stu-id="9f705-275">When importing metadata like WSDL and XSD to generate client-side code, the surrogate needs to be added to the component responsible for generating code from XSD schema, <xref:System.Runtime.Serialization.XsdDataContractImporter>.</span></span> <span data-ttu-id="9f705-276">A questo scopo, modificare direttamente l'elemento <xref:System.ServiceModel.Description.WsdlImporter> utilizzato per importare i metadati.</span><span class="sxs-lookup"><span data-stu-id="9f705-276">To do this, directly modify the <xref:System.ServiceModel.Description.WsdlImporter> used to import metadata.</span></span>  
  
##### <a name="to-implement-a-surrogate-for-metadata-importation"></a><span data-ttu-id="9f705-277">Per implementare un surrogato per l'importazione dei metadati</span><span class="sxs-lookup"><span data-stu-id="9f705-277">To implement a surrogate for metadata importation</span></span>  
  
1. <span data-ttu-id="9f705-278">Importare i metadati utilizzando la classe <xref:System.ServiceModel.Description.WsdlImporter>.</span><span class="sxs-lookup"><span data-stu-id="9f705-278">Import the metadata using the <xref:System.ServiceModel.Description.WsdlImporter> class.</span></span>  
  
2. <span data-ttu-id="9f705-279">Utilizzare il metodo <xref:System.Collections.Generic.Dictionary%602.TryGetValue%2A> per verificare se è stato definito un elemento <xref:System.Runtime.Serialization.XsdDataContractImporter>.</span><span class="sxs-lookup"><span data-stu-id="9f705-279">Use the <xref:System.Collections.Generic.Dictionary%602.TryGetValue%2A> method to check whether an <xref:System.Runtime.Serialization.XsdDataContractImporter> has been defined.</span></span>  
  
3. <span data-ttu-id="9f705-280">Se il metodo <xref:System.Collections.Generic.Dictionary%602.TryGetValue%2A> restituisce `false`, creare un nuovo elemento <xref:System.Runtime.Serialization.XsdDataContractImporter> e impostarne la proprietà <xref:System.Runtime.Serialization.XsdDataContractImporter.Options%2A> su una nuova istanza della classe <xref:System.Runtime.Serialization.ImportOptions>.</span><span class="sxs-lookup"><span data-stu-id="9f705-280">If the <xref:System.Collections.Generic.Dictionary%602.TryGetValue%2A> method returns `false`, create a new <xref:System.Runtime.Serialization.XsdDataContractImporter> and set its <xref:System.Runtime.Serialization.XsdDataContractImporter.Options%2A> property to a new instance of the <xref:System.Runtime.Serialization.ImportOptions> class.</span></span> <span data-ttu-id="9f705-281">In caso contrario, utilizzare l'unità di importazione restituita dal parametro `out` del metodo <xref:System.Collections.Generic.Dictionary%602.TryGetValue%2A>.</span><span class="sxs-lookup"><span data-stu-id="9f705-281">Otherwise, use the importer returned by the `out` parameter of the <xref:System.Collections.Generic.Dictionary%602.TryGetValue%2A> method.</span></span>  
  
4. <span data-ttu-id="9f705-282">Se per l'elemento <xref:System.Runtime.Serialization.XsdDataContractImporter> non sono definite istanze della classe <xref:System.Runtime.Serialization.ImportOptions>, impostare la proprietà affinché sia una nuova istanza della classe <xref:System.Runtime.Serialization.ImportOptions>.</span><span class="sxs-lookup"><span data-stu-id="9f705-282">If the <xref:System.Runtime.Serialization.XsdDataContractImporter> has no <xref:System.Runtime.Serialization.ImportOptions> defined, then set the property to be a new instance of the <xref:System.Runtime.Serialization.ImportOptions> class.</span></span>  
  
5. <span data-ttu-id="9f705-283">Impostare la proprietà <xref:System.Runtime.Serialization.ImportOptions.DataContractSurrogate%2A> di <xref:System.Runtime.Serialization.ImportOptions> dell'elemento <xref:System.Runtime.Serialization.XsdDataContractImporter> su una nuova istanza del surrogato.</span><span class="sxs-lookup"><span data-stu-id="9f705-283">Set the <xref:System.Runtime.Serialization.ImportOptions.DataContractSurrogate%2A> property of the <xref:System.Runtime.Serialization.ImportOptions> of the <xref:System.Runtime.Serialization.XsdDataContractImporter> to a new instance of the surrogate.</span></span>  
  
6. <span data-ttu-id="9f705-284">Aggiungere l'elemento <xref:System.Runtime.Serialization.XsdDataContractImporter> alla raccolta restituita dalla proprietà <xref:System.ServiceModel.Description.MetadataExporter.State%2A> di <xref:System.ServiceModel.Description.WsdlImporter> (ereditato dalla classe <xref:System.ServiceModel.Description.MetadataExporter>).</span><span class="sxs-lookup"><span data-stu-id="9f705-284">Add the <xref:System.Runtime.Serialization.XsdDataContractImporter> to the collection returned by the <xref:System.ServiceModel.Description.MetadataExporter.State%2A> property of the <xref:System.ServiceModel.Description.WsdlImporter> (inherited from the <xref:System.ServiceModel.Description.MetadataExporter> class.)</span></span>  
  
7. <span data-ttu-id="9f705-285">Utilizzare il metodo <xref:System.ServiceModel.Description.WsdlImporter.ImportAllContracts%2A> di <xref:System.ServiceModel.Description.WsdlImporter> per importare tutti i contratti dati all'interno dello schema.</span><span class="sxs-lookup"><span data-stu-id="9f705-285">Use the <xref:System.ServiceModel.Description.WsdlImporter.ImportAllContracts%2A> method of the <xref:System.ServiceModel.Description.WsdlImporter> to import all of the data contracts within the schema.</span></span> <span data-ttu-id="9f705-286">Durante l'ultimo passaggio, viene generato codice dagli schemi caricati chiamando il surrogato.</span><span class="sxs-lookup"><span data-stu-id="9f705-286">During the last step, code is generated from the schemas loaded by calling into the surrogate.</span></span>  
  
     [!code-csharp[C_IDataContractSurrogate#9](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_idatacontractsurrogate/cs/source.cs#9)]  
  
### <a name="to-use-a-surrogate-for-metadata-export"></a><span data-ttu-id="9f705-287">Per utilizzare un surrogato per l'esportazione dei metadati</span><span class="sxs-lookup"><span data-stu-id="9f705-287">To Use a surrogate for Metadata Export</span></span>  
 <span data-ttu-id="9f705-288">Per impostazione predefinita, quando si esportano metadati da WCF per un servizio, è necessario generare lo schema WSDL e XSD.</span><span class="sxs-lookup"><span data-stu-id="9f705-288">By default, when exporting metadata from WCF for a service, both WSDL and XSD schema needs to be generated.</span></span> <span data-ttu-id="9f705-289">È necessario che il surrogato venga aggiunto al componente responsabile della generazione di schema XSD per i tipi di contratto dati, <xref:System.Runtime.Serialization.XsdDataContractExporter>.</span><span class="sxs-lookup"><span data-stu-id="9f705-289">The surrogate needs to be added to the component responsible for generating XSD schema for data contract types, <xref:System.Runtime.Serialization.XsdDataContractExporter>.</span></span> <span data-ttu-id="9f705-290">A tale scopo, utilizzare un comportamento che implementi <xref:System.ServiceModel.Description.IWsdlExportExtension> per modificare l'elemento <xref:System.ServiceModel.Description.WsdlExporter> oppure modificare direttamente l'elemento <xref:System.ServiceModel.Description.WsdlExporter> utilizzato per esportare metadati.</span><span class="sxs-lookup"><span data-stu-id="9f705-290">To do this, either use a behavior that implements <xref:System.ServiceModel.Description.IWsdlExportExtension> to modify the <xref:System.ServiceModel.Description.WsdlExporter>, or directly modify the <xref:System.ServiceModel.Description.WsdlExporter> used to export metadata.</span></span>  
  
##### <a name="to-use-a-surrogate-for-metadata-export"></a><span data-ttu-id="9f705-291">Per utilizzare un surrogato per l'esportazione dei metadati</span><span class="sxs-lookup"><span data-stu-id="9f705-291">To use a surrogate for metadata export</span></span>  
  
1. <span data-ttu-id="9f705-292">Creare un nuovo elemento <xref:System.ServiceModel.Description.WsdlExporter> oppure utilizzare il parametro `wsdlExporter` passato al metodo <xref:System.ServiceModel.Description.IWsdlExportExtension.ExportContract%2A>.</span><span class="sxs-lookup"><span data-stu-id="9f705-292">Create a new <xref:System.ServiceModel.Description.WsdlExporter> or use the `wsdlExporter` parameter passed to the <xref:System.ServiceModel.Description.IWsdlExportExtension.ExportContract%2A> method.</span></span>  
  
2. <span data-ttu-id="9f705-293">Utilizzare la funzione <xref:System.Collections.Generic.Dictionary%602.TryGetValue%2A> per verificare se è stato definito un elemento <xref:System.Runtime.Serialization.XsdDataContractExporter>.</span><span class="sxs-lookup"><span data-stu-id="9f705-293">Use the <xref:System.Collections.Generic.Dictionary%602.TryGetValue%2A> function to check whether an <xref:System.Runtime.Serialization.XsdDataContractExporter> has been defined.</span></span>  
  
3. <span data-ttu-id="9f705-294">Se <xref:System.Collections.Generic.Dictionary%602.TryGetValue%2A> restituisce `false`, creare un nuovo elemento <xref:System.Runtime.Serialization.XsdDataContractExporter> con gli schemi XML generati da <xref:System.ServiceModel.Description.WsdlExporter> e aggiungerlo alla raccolta restituita dalla proprietà <xref:System.ServiceModel.Description.MetadataExporter.State%2A> dell'elemento <xref:System.ServiceModel.Description.WsdlExporter>.</span><span class="sxs-lookup"><span data-stu-id="9f705-294">If <xref:System.Collections.Generic.Dictionary%602.TryGetValue%2A> returns `false`, create a new <xref:System.Runtime.Serialization.XsdDataContractExporter> with the generated XML schemas from the <xref:System.ServiceModel.Description.WsdlExporter>, and add it to the collection returned by the <xref:System.ServiceModel.Description.MetadataExporter.State%2A> property of the <xref:System.ServiceModel.Description.WsdlExporter>.</span></span> <span data-ttu-id="9f705-295">In caso contrario, utilizzare l'unità di esportazione restituita dal parametro `out` del metodo <xref:System.Collections.Generic.Dictionary%602.TryGetValue%2A>.</span><span class="sxs-lookup"><span data-stu-id="9f705-295">Otherwise, use the exporter returned by the `out` parameter of the <xref:System.Collections.Generic.Dictionary%602.TryGetValue%2A> method.</span></span>  
  
4. <span data-ttu-id="9f705-296">Se per l'elemento <xref:System.Runtime.Serialization.XsdDataContractExporter> non sono definite istanze della classe <xref:System.Runtime.Serialization.ExportOptions>, impostare la proprietà <xref:System.Runtime.Serialization.XsdDataContractExporter.Options%2A> su una nuova istanza della classe <xref:System.Runtime.Serialization.ExportOptions>.</span><span class="sxs-lookup"><span data-stu-id="9f705-296">If the <xref:System.Runtime.Serialization.XsdDataContractExporter> has no <xref:System.Runtime.Serialization.ExportOptions> defined, then set the <xref:System.Runtime.Serialization.XsdDataContractExporter.Options%2A> property to a new instance of the <xref:System.Runtime.Serialization.ExportOptions> class.</span></span>  
  
5. <span data-ttu-id="9f705-297">Impostare la proprietà <xref:System.Runtime.Serialization.ExportOptions.DataContractSurrogate%2A> di <xref:System.Runtime.Serialization.ExportOptions> dell'elemento <xref:System.Runtime.Serialization.XsdDataContractExporter> su una nuova istanza del surrogato.</span><span class="sxs-lookup"><span data-stu-id="9f705-297">Set the <xref:System.Runtime.Serialization.ExportOptions.DataContractSurrogate%2A> property of the <xref:System.Runtime.Serialization.ExportOptions> of the <xref:System.Runtime.Serialization.XsdDataContractExporter> to a new instance of the surrogate.</span></span> <span data-ttu-id="9f705-298">I passaggi successivi per l'esportazione dei metadati non richiedono modifiche.</span><span class="sxs-lookup"><span data-stu-id="9f705-298">Subsequent steps for exporting metadata do not require any changes.</span></span>  
  
     [!code-csharp[C_IDataContractSurrogate#10](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_idatacontractsurrogate/cs/source.cs#10)]  
  
## <a name="see-also"></a><span data-ttu-id="9f705-299">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="9f705-299">See also</span></span>

- <xref:System.Runtime.Serialization.DataContractSerializer>
- <xref:System.Runtime.Serialization.IDataContractSurrogate>
- <xref:System.ServiceModel.Description.DataContractSerializerOperationBehavior>
- <xref:System.Runtime.Serialization.ImportOptions>
- <xref:System.Runtime.Serialization.ExportOptions>
- [<span data-ttu-id="9f705-300">Uso di contratti di dati</span><span class="sxs-lookup"><span data-stu-id="9f705-300">Using Data Contracts</span></span>](../feature-details/using-data-contracts.md)
