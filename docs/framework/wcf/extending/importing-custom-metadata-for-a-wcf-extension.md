---
title: Importazione di metadati personalizzati per un'estensione WCF
ms.date: 03/30/2017
ms.assetid: 78beb28f-408a-4c75-9c3c-caefe9595b1a
ms.openlocfilehash: 36bc4c9291b60ae5ad6e9964c361ed9e7a7c8317
ms.sourcegitcommit: 68653db98c5ea7744fd438710248935f70020dfb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/22/2019
ms.locfileid: "69963493"
---
# <a name="importing-custom-metadata-for-a-wcf-extension"></a><span data-ttu-id="7dce7-102">Importazione di metadati personalizzati per un'estensione WCF</span><span class="sxs-lookup"><span data-stu-id="7dce7-102">Importing Custom Metadata for a WCF Extension</span></span>
<span data-ttu-id="7dce7-103">In Windows Communication Foundation (WCF) l'importazione dei metadati è il processo di generazione di una rappresentazione astratta di un servizio o delle relative parti componenti dai relativi metadati.</span><span class="sxs-lookup"><span data-stu-id="7dce7-103">In Windows Communication Foundation (WCF), metadata import is the process of generating an abstract representation of a service or its component parts from its metadata.</span></span> <span data-ttu-id="7dce7-104">Ad esempio, WCF può importare <xref:System.ServiceModel.Description.ServiceEndpoint> istanze, <xref:System.ServiceModel.Channels.Binding> istanze o <xref:System.ServiceModel.Description.ContractDescription> istanze da un documento WSDL per un servizio.</span><span class="sxs-lookup"><span data-stu-id="7dce7-104">For example, WCF can import <xref:System.ServiceModel.Description.ServiceEndpoint> instances, <xref:System.ServiceModel.Channels.Binding> instances or <xref:System.ServiceModel.Description.ContractDescription> instances from a WSDL document for a service.</span></span> <span data-ttu-id="7dce7-105">Per importare metadati del servizio in WCF, utilizzare un'implementazione della <xref:System.ServiceModel.Description.MetadataImporter?displayProperty=nameWithType> classe astratta.</span><span class="sxs-lookup"><span data-stu-id="7dce7-105">To import service metadata in WCF, use an implementation of the <xref:System.ServiceModel.Description.MetadataImporter?displayProperty=nameWithType> abstract class.</span></span> <span data-ttu-id="7dce7-106">I tipi che derivano <xref:System.ServiceModel.Description.MetadataImporter> dalla classe implementano il supporto per l'importazione di formati di metadati che sfruttano la logica di importazione WS-Policy in WCF.</span><span class="sxs-lookup"><span data-stu-id="7dce7-106">Types that derive from the <xref:System.ServiceModel.Description.MetadataImporter> class implement support for importing metadata formats that take advantage of the WS-Policy import logic in WCF.</span></span>  
  
 <span data-ttu-id="7dce7-107">I metadati personalizzati sono costituiti da elementi XML non importabili mediante le utilità di importazione dei metadati forniti dal sistema.</span><span class="sxs-lookup"><span data-stu-id="7dce7-107">Custom metadata consists of XML elements that the system-provided metadata importers cannot import.</span></span> <span data-ttu-id="7dce7-108">Esempi comuni di metadati personalizzati sono le estensioni WSDL personalizzate e le asserzioni di criteri personalizzate.</span><span class="sxs-lookup"><span data-stu-id="7dce7-108">Typically, this includes custom WSDL extensions and custom policy assertions.</span></span>  
  
 <span data-ttu-id="7dce7-109">Questa sezione descrive come importare le estensioni WSDL e le asserzioni di criteri personalizzate,</span><span class="sxs-lookup"><span data-stu-id="7dce7-109">This section describes how to import custom WSDL extensions and policy assertions.</span></span> <span data-ttu-id="7dce7-110">senza tuttavia tratta il processo di importazione in sé.</span><span class="sxs-lookup"><span data-stu-id="7dce7-110">It does not focus on the importing process itself.</span></span> <span data-ttu-id="7dce7-111">Per ulteriori informazioni sull'utilizzo dei tipi che esportano e importano metadati indipendentemente dal fatto che i metadati siano personalizzati o supportati dal sistema, vedere [esportazione e importazione di metadati](../../../../docs/framework/wcf/feature-details/exporting-and-importing-metadata.md).</span><span class="sxs-lookup"><span data-stu-id="7dce7-111">For more information about how to use the types that export and import metadata regardless of whether the metadata is custom or system-supported, see [Exporting and Importing Metadata](../../../../docs/framework/wcf/feature-details/exporting-and-importing-metadata.md).</span></span>  
  
## <a name="overview"></a><span data-ttu-id="7dce7-112">Panoramica</span><span class="sxs-lookup"><span data-stu-id="7dce7-112">Overview</span></span>  
 <span data-ttu-id="7dce7-113">Il <xref:System.ServiceModel.Description.WsdlImporter?displayProperty=nameWithType> tipo è l'implementazione <xref:System.ServiceModel.Description.MetadataImporter> della classe astratta inclusa in WCF.</span><span class="sxs-lookup"><span data-stu-id="7dce7-113">The <xref:System.ServiceModel.Description.WsdlImporter?displayProperty=nameWithType> type is the implementation of the <xref:System.ServiceModel.Description.MetadataImporter> abstract class included with WCF.</span></span> <span data-ttu-id="7dce7-114">Il tipo <xref:System.ServiceModel.Description.WsdlImporter> importa metadati WSDL insieme ai relativi criteri allegati. Questi elementi vengono quindi raggruppati in un oggetto <xref:System.ServiceModel.Description.MetadataSet?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="7dce7-114">The <xref:System.ServiceModel.Description.WsdlImporter> type imports WSDL metadata with attached policies that are bundled in a <xref:System.ServiceModel.Description.MetadataSet?displayProperty=nameWithType> object.</span></span> <span data-ttu-id="7dce7-115">Le asserzioni di criteri e le estensioni WSDL non riconosciute dalle unità di importazione predefinite vengono importate tramite una delle unità di importazione personalizzate e registrate di documenti WSDL e di criteri.</span><span class="sxs-lookup"><span data-stu-id="7dce7-115">Policy assertions and WSDL extensions that the default importers do not recognize are passed to any registered custom policy and WSDL importers for importing.</span></span> <span data-ttu-id="7dce7-116">In genere, le unità di importazione vengono implementate per supportare gli elementi di associazione definiti dall'utente o per modificare il contratto importato.</span><span class="sxs-lookup"><span data-stu-id="7dce7-116">Typically, importers are implemented to support user-defined binding elements or to modify the imported contract.</span></span>  
  
 <span data-ttu-id="7dce7-117">Contenuto della sezione sono descritti gli argomenti seguenti:</span><span class="sxs-lookup"><span data-stu-id="7dce7-117">This section describes:</span></span>  
  
1. <span data-ttu-id="7dce7-118">Implementazione e utilizzo dell'interfaccia <xref:System.ServiceModel.Description.IWsdlImportExtension?displayProperty=nameWithType>, che espone i dati WSDL alle unità di importazione personalizzate prima di generare descrizioni e codice.</span><span class="sxs-lookup"><span data-stu-id="7dce7-118">How to implement and use the <xref:System.ServiceModel.Description.IWsdlImportExtension?displayProperty=nameWithType> interface, which exposes the WSDL data to custom importers prior to the generation of descriptions and the generation of code.</span></span> <span data-ttu-id="7dce7-119">Questa interfaccia può essere utilizzata per esaminare o modificare i tipi di descrizione e la compilazione del codice eseguita utilizzando un determinato set di metadati.</span><span class="sxs-lookup"><span data-stu-id="7dce7-119">You can use this interface to examine or modify the description types and code compilation performed using a given set of metadata.</span></span>  
  
2. <span data-ttu-id="7dce7-120">Implementazione e utilizzo dell'interfaccia <xref:System.ServiceModel.Description.IPolicyImportExtension?displayProperty=nameWithType>, che espone le asserzioni di criteri alle unità di importazione prima di generare oggetti descrizione.</span><span class="sxs-lookup"><span data-stu-id="7dce7-120">How to implement and use the <xref:System.ServiceModel.Description.IPolicyImportExtension?displayProperty=nameWithType> interface, which exposes policy assertions to importers prior to the generation of description objects.</span></span> <span data-ttu-id="7dce7-121">Questa interfaccia può essere utilizzata per esaminare o modificare l'associazione o il contratto in base ai criteri scaricati.</span><span class="sxs-lookup"><span data-stu-id="7dce7-121">You can use this interface to examine or modify the binding or contract based on the downloaded policies.</span></span>  
  
 <span data-ttu-id="7dce7-122">Per ulteriori informazioni sull'esportazione di asserzioni di criteri e WSDL personalizzati, vedere [esportazione di metadati personalizzati per un'estensione WCF](../../../../docs/framework/wcf/extending/exporting-custom-metadata-for-a-wcf-extension.md).</span><span class="sxs-lookup"><span data-stu-id="7dce7-122">For more information about exporting custom WSDL and policy assertions, see [Exporting Custom Metadata for a WCF Extension](../../../../docs/framework/wcf/extending/exporting-custom-metadata-for-a-wcf-extension.md).</span></span>  
  
## <a name="importing-custom-wsdl-extensions"></a><span data-ttu-id="7dce7-123">Importazione di estensioni WSDL personalizzate</span><span class="sxs-lookup"><span data-stu-id="7dce7-123">Importing Custom WSDL Extensions</span></span>  
 <span data-ttu-id="7dce7-124">Per includere il supporto per l'importazione di estensioni WSDL, implementare l'interfaccia <xref:System.ServiceModel.Description.IWsdlImportExtension> e quindi aggiungere tale implementazione alla proprietà <xref:System.ServiceModel.Description.WsdlImporter.WsdlImportExtensions%2A>.</span><span class="sxs-lookup"><span data-stu-id="7dce7-124">To add support for importing WSDL extensions, implement the <xref:System.ServiceModel.Description.IWsdlImportExtension> interface and then add your implementation to the <xref:System.ServiceModel.Description.WsdlImporter.WsdlImportExtensions%2A> property.</span></span> <span data-ttu-id="7dce7-125">È inoltre possibile utilizzare il tipo <xref:System.ServiceModel.Description.WsdlImporter> per caricare implementazioni dell'interfaccia <xref:System.ServiceModel.Description.IWsdlImportExtension> registrate nel file di configurazione dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="7dce7-125">The <xref:System.ServiceModel.Description.WsdlImporter> can also load implementations of the <xref:System.ServiceModel.Description.IWsdlImportExtension> interface registered in your application configuration file.</span></span> <span data-ttu-id="7dce7-126">Si noti che alcune unità di importazione WSDL sono registrate per impostazione predefinita e che l'ordine delle unità di importazione WSDL registrate è rilevante.</span><span class="sxs-lookup"><span data-stu-id="7dce7-126">Note that a number of WSDL importers are registered by default and the order of the registered WSDL importers is significant.</span></span>  
  
 <span data-ttu-id="7dce7-127">Quando l'unità di importazione WSDL personalizzata viene caricata e utilizzata dal tipo <xref:System.ServiceModel.Description.WsdlImporter>, prima di eseguire il processo di importazione il sistema chiama il metodo <xref:System.ServiceModel.Description.IWsdlImportExtension.BeforeImport%2A> per consentire la modifica dei metadati.</span><span class="sxs-lookup"><span data-stu-id="7dce7-127">When the custom WSDL importer is loaded and used by the <xref:System.ServiceModel.Description.WsdlImporter>, first the <xref:System.ServiceModel.Description.IWsdlImportExtension.BeforeImport%2A> method is called to enable the modification of metadata prior to the import process.</span></span> <span data-ttu-id="7dce7-128">Quindi, dopo aver importato i contratti, il sistema chiama il metodo <xref:System.ServiceModel.Description.IWsdlImportExtension.ImportContract%2A> per consentire la modifica dei contratti importati dai metadati.</span><span class="sxs-lookup"><span data-stu-id="7dce7-128">Next, the contracts are imported after which the <xref:System.ServiceModel.Description.IWsdlImportExtension.ImportContract%2A> method is called to enable the modification of the contracts imported from the metadata.</span></span> <span data-ttu-id="7dce7-129">Infine, il sistema chiama il metodo <xref:System.ServiceModel.Description.IWsdlImportExtension.ImportEndpoint%2A> per consentire la modifica degli endpoint importati.</span><span class="sxs-lookup"><span data-stu-id="7dce7-129">Finally, the <xref:System.ServiceModel.Description.IWsdlImportExtension.ImportEndpoint%2A> method is called to enable the modification of the imported endpoints.</span></span>  
  
 <span data-ttu-id="7dce7-130">Per altre informazioni, vedere [Procedura: Importa WSDL](../../../../docs/framework/wcf/extending/how-to-import-custom-wsdl.md)personalizzato.</span><span class="sxs-lookup"><span data-stu-id="7dce7-130">For more information, see [How to: Import Custom WSDL](../../../../docs/framework/wcf/extending/how-to-import-custom-wsdl.md).</span></span>  
  
### <a name="importing-custom-policy-assertions"></a><span data-ttu-id="7dce7-131">Importazione di asserzioni di criteri personalizzati</span><span class="sxs-lookup"><span data-stu-id="7dce7-131">Importing Custom Policy Assertions</span></span>  
 <span data-ttu-id="7dce7-132">Il <xref:System.ServiceModel.Description.WsdlImporter> tipo e lo [strumento ServiceModel Metadata Utility Tool (Svcutil. exe)](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md) gestiscono automaticamente l'elaborazione di un'ampia gamma di tipi di asserzione di criteri nelle espressioni di criteri associate ai documenti WSDL.</span><span class="sxs-lookup"><span data-stu-id="7dce7-132">The <xref:System.ServiceModel.Description.WsdlImporter> type and the [ServiceModel Metadata Utility Tool (Svcutil.exe)](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md) automatically handle processing a variety of policy assertion types in policy expressions attached to WSDL documents.</span></span> <span data-ttu-id="7dce7-133">Questi strumenti raccolgono, normalizzano e uniscono le espressioni di criteri allegate alle associazioni e alle porte WSDL.</span><span class="sxs-lookup"><span data-stu-id="7dce7-133">These tools collect, normalize, and merge policy expressions attached to WSDL bindings and WSDL ports.</span></span>  
  
 <span data-ttu-id="7dce7-134">Per includere il supporto per l'importazione di asserzioni di criteri personalizzate, implementare l'interfaccia <xref:System.ServiceModel.Description.IPolicyImportExtension> e quindi aggiungere tale implementazione alla proprietà <xref:System.ServiceModel.Description.MetadataImporter.PolicyImportExtensions%2A>.</span><span class="sxs-lookup"><span data-stu-id="7dce7-134">To add support for importing custom policy assertions, implement the <xref:System.ServiceModel.Description.IPolicyImportExtension> interface and then add your implementation to the <xref:System.ServiceModel.Description.MetadataImporter.PolicyImportExtensions%2A> property.</span></span> <span data-ttu-id="7dce7-135">È inoltre possibile utilizzare il tipo <xref:System.ServiceModel.Description.MetadataImporter> per caricare implementazioni dell'interfaccia <xref:System.ServiceModel.Description.IPolicyImportExtension> registrate nel file di configurazione dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="7dce7-135">The <xref:System.ServiceModel.Description.MetadataImporter> can also load implementations of the <xref:System.ServiceModel.Description.IPolicyImportExtension> interface registered in your application configuration file.</span></span> <span data-ttu-id="7dce7-136">Si noti che alcune unità di importazione dei criteri sono registrate per impostazione predefinita e che l'ordine delle unità di importazione dei criteri registrate è rilevante.</span><span class="sxs-lookup"><span data-stu-id="7dce7-136">Note that a number of policy importers are registered by default and the order of the registered policy importers is significant.</span></span>  
  
 <span data-ttu-id="7dce7-137">Il sistema dei metadati chiama più volte il metodo <xref:System.ServiceModel.Description.IPolicyImportExtension.ImportPolicy%2A?displayProperty=nameWithType> in tutte le estensioni di importazione criteri registrate per ogni combinazione di alternative criteri allegate ai soggetti di criterio di messaggio, operazione ed endpoint.</span><span class="sxs-lookup"><span data-stu-id="7dce7-137">The metadata system repeatedly calls the <xref:System.ServiceModel.Description.IPolicyImportExtension.ImportPolicy%2A?displayProperty=nameWithType> method on all registered policy import extensions for each combination of policy alternatives attached to the message, operation, and endpoint policy subjects.</span></span> <span data-ttu-id="7dce7-138">Quando si importa una porta WSDL, i criteri allegati alla porta e all'associazione WSDL corrispondente vengono uniti prima di chiamare le estensioni di importazione criteri.</span><span class="sxs-lookup"><span data-stu-id="7dce7-138">When importing a WSDL port, policies attached to the port and to the corresponding WSDL binding are merged before calling into the policy import extensions.</span></span> <span data-ttu-id="7dce7-139">Le alternative criteri sono rese disponibili sottoforma di oggetti <xref:System.ServiceModel.Description.PolicyConversionContext> tramite un contesto <xref:System.ServiceModel.Description.PolicyAssertionCollection>.</span><span class="sxs-lookup"><span data-stu-id="7dce7-139">The policy alternatives are made available through a <xref:System.ServiceModel.Description.PolicyConversionContext> as <xref:System.ServiceModel.Description.PolicyAssertionCollection> objects.</span></span> <span data-ttu-id="7dce7-140">Ogni oggetto <xref:System.ServiceModel.Description.PolicyAssertionCollection> è una raccolta di asserzioni di criteri rappresentato dagli oggetti <xref:System.Xml.XmlElement>.</span><span class="sxs-lookup"><span data-stu-id="7dce7-140">Each <xref:System.ServiceModel.Description.PolicyAssertionCollection> is a collection of policy assertions represented by <xref:System.Xml.XmlElement> objects.</span></span>  
  
 <span data-ttu-id="7dce7-141">Le proprietà <xref:System.ServiceModel.Description.PolicyConversionContext.Contract%2A> e <xref:System.ServiceModel.Description.PolicyConversionContext.BindingElements%2A> dell'oggetto <xref:System.ServiceModel.Description.PolicyConversionContext> espongono gli oggetti <xref:System.ServiceModel.Description.ContractDescription> e <xref:System.ServiceModel.Channels.BindingElement> importati dal documento WSDL.</span><span class="sxs-lookup"><span data-stu-id="7dce7-141">The <xref:System.ServiceModel.Description.PolicyConversionContext.Contract%2A> and <xref:System.ServiceModel.Description.PolicyConversionContext.BindingElements%2A> properties on the <xref:System.ServiceModel.Description.PolicyConversionContext> object expose the <xref:System.ServiceModel.Description.ContractDescription> and <xref:System.ServiceModel.Channels.BindingElement> objects that were imported from the WSDL.</span></span> <span data-ttu-id="7dce7-142">Le estensioni di importazione criteri elaborano le asserzioni di criteri individuando le istanze di un determinato tipo di asserzione di criteri, apportando le modifiche corrispondenti agli oggetti <xref:System.ServiceModel.Description.ContractDescription> o <xref:System.ServiceModel.Channels.BindingElement> e quindi rimuovendo le asserzioni di criteri dall'istanza <xref:System.ServiceModel.Description.PolicyAssertionCollection> corrispondente.</span><span class="sxs-lookup"><span data-stu-id="7dce7-142">Policy import extensions process policy assertions by finding instances of a particular policy assertion type, making corresponding changes to the <xref:System.ServiceModel.Description.ContractDescription> or <xref:System.ServiceModel.Channels.BindingElement> objects and then removing the policy assertions from the corresponding <xref:System.ServiceModel.Description.PolicyAssertionCollection> instance.</span></span>  
  
 <span data-ttu-id="7dce7-143">Poiché l'attributo `wsp:Optional` e le espressioni di criteri annidate non sono normalizzate, le estensioni di importazione criteri devono gestire questi costrutti di criterio.</span><span class="sxs-lookup"><span data-stu-id="7dce7-143">The `wsp:Optional` attribute and nested policy expressions are not normalized, so policy import extensions must handle these policy constructs.</span></span> <span data-ttu-id="7dce7-144">Inoltre, poiché le estensioni di importazione criteri possono essere chiamate più volte con gli stessi oggetti <xref:System.ServiceModel.Description.ContractDescription> e <xref:System.ServiceModel.Channels.BindingElement>, le estensioni di importazione criteri devono essere in grado di gestire questo tipo di comportamento.</span><span class="sxs-lookup"><span data-stu-id="7dce7-144">Also, policy import extensions may be called multiple times with the same <xref:System.ServiceModel.Description.ContractDescription> and <xref:System.ServiceModel.Channels.BindingElement> objects, so policy import extensions should be robust to this behavior.</span></span>  
  
> [!IMPORTANT]
> <span data-ttu-id="7dce7-145">È possibile che all'unità di importazione vengano passati metadati non validi o inappropriati.</span><span class="sxs-lookup"><span data-stu-id="7dce7-145">Invalid or improper metadata can be passed to the importer.</span></span> <span data-ttu-id="7dce7-146">È pertanto necessario garantire che le unità di importazione personalizzate siano in grado di gestire qualsiasi formato XML.</span><span class="sxs-lookup"><span data-stu-id="7dce7-146">Ensure that custom importers are robust to all forms of XML.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="7dce7-147">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="7dce7-147">See also</span></span>

- [<span data-ttu-id="7dce7-148">Procedura: Importa WSDL personalizzato</span><span class="sxs-lookup"><span data-stu-id="7dce7-148">How to: Import Custom WSDL</span></span>](../../../../docs/framework/wcf/extending/how-to-import-custom-wsdl.md)
- [<span data-ttu-id="7dce7-149">Procedura: Importa asserzioni di criteri personalizzate</span><span class="sxs-lookup"><span data-stu-id="7dce7-149">How to: Import Custom Policy Assertions</span></span>](../../../../docs/framework/wcf/extending/how-to-import-custom-policy-assertions.md)
- [<span data-ttu-id="7dce7-150">Procedura: Scrivere un'estensione per ServiceContractGenerator</span><span class="sxs-lookup"><span data-stu-id="7dce7-150">How to: Write an Extension for the ServiceContractGenerator</span></span>](../../../../docs/framework/wcf/extending/how-to-write-an-extension-for-the-servicecontractgenerator.md)
