---
title: Estensione di dispatcher
ms.date: 03/30/2017
helpviewer_keywords:
- dispatcher extensions [WCF]
ms.assetid: d0ad15ac-fa12-4f27-80e8-7ac2271e5985
ms.openlocfilehash: 9250ca09fb5e28655e39f8d91d991fdb3bffcdbd
ms.sourcegitcommit: d2e1dfa7ef2d4e9ffae3d431cf6a4ffd9c8d378f
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 09/07/2019
ms.locfileid: "70795741"
---
# <a name="extending-dispatchers"></a><span data-ttu-id="17097-102">Estensione di dispatcher</span><span class="sxs-lookup"><span data-stu-id="17097-102">Extending Dispatchers</span></span>
<span data-ttu-id="17097-103">I dispatcher sono responsabili dell'estrazione dei messaggi in arrivo dai canali sottostanti, della loro conversione in chiamate al metodo nel codice dell'applicazione e della restituzione dei risultati al chiamante.</span><span class="sxs-lookup"><span data-stu-id="17097-103">Dispatchers are responsible for pulling incoming messages out of the underlying channels, translating them into method invocations in application code, and sending the results back to the caller.</span></span> <span data-ttu-id="17097-104">Le estensioni del dispatcher consentono di modificare questa elaborazione.</span><span class="sxs-lookup"><span data-stu-id="17097-104">Dispatcher extensions allow you to modify this processing.</span></span>  <span data-ttu-id="17097-105">È possibile implementare controlli di parametri e messaggi che controllano o modificano il contenuto dei messaggi o dei parametri.</span><span class="sxs-lookup"><span data-stu-id="17097-105">You can implement message or parameter inspectors that inspect or modify the contents of messages or parameters.</span></span>  <span data-ttu-id="17097-106">È possibile modificare la modalità in cui i messaggi vengono indirizzati alle operazioni o forniscono altre funzionalità.</span><span class="sxs-lookup"><span data-stu-id="17097-106">You can change the way messages are routed to operations or provide some other functionality.</span></span>

<span data-ttu-id="17097-107">In questo argomento viene descritto come utilizzare <xref:System.ServiceModel.Dispatcher.DispatchRuntime> le <xref:System.ServiceModel.Dispatcher.DispatchOperation> classi e in un'applicazione di servizio Windows Communication Foundation (WCF) per modificare il comportamento di esecuzione predefinito di un dispatcher o per intercettare o modificare messaggi, parametri o restituire valori prima o dopo l'invio o il recupero dal livello del canale.</span><span class="sxs-lookup"><span data-stu-id="17097-107">This topic describes how to use the <xref:System.ServiceModel.Dispatcher.DispatchRuntime> and <xref:System.ServiceModel.Dispatcher.DispatchOperation> classes in a Windows Communication Foundation (WCF) service application to modify the default execution behavior of a dispatcher or to intercept or modify messages, parameters, or return values prior to or subsequent to sending or retrieving them from the channel layer.</span></span> <span data-ttu-id="17097-108">Per ulteriori informazioni sull'elaborazione di messaggi di runtime client equivalenti, vedere [estensione dei client](extending-clients.md).</span><span class="sxs-lookup"><span data-stu-id="17097-108">For more information about the equivalent client runtime message processing, see [Extending Clients](extending-clients.md).</span></span> <span data-ttu-id="17097-109">Per comprendere il ruolo <xref:System.ServiceModel.IExtensibleObject%601> svolto dai tipi nell'accesso allo stato condiviso tra vari oggetti di personalizzazione del runtime, vedere [oggetti estensibili](extensible-objects.md).</span><span class="sxs-lookup"><span data-stu-id="17097-109">To understand the role that <xref:System.ServiceModel.IExtensibleObject%601> types play in accessing shared state between various runtime customization objects, see [Extensible Objects](extensible-objects.md).</span></span>

## <a name="dispatchers"></a><span data-ttu-id="17097-110">Dispatcher</span><span class="sxs-lookup"><span data-stu-id="17097-110">Dispatchers</span></span>

<span data-ttu-id="17097-111">Il livello del modello di servizi esegue la conversione tra il modello di programmazione dello sviluppatore e lo scambio di messaggi sottostante, comunemente denominato livello del canale.</span><span class="sxs-lookup"><span data-stu-id="17097-111">The service model layer performs the conversion between the developer’s programming model and the underlying message exchange, commonly called the channel layer.</span></span> <span data-ttu-id="17097-112">In WCF i dispatcher del canale e dell'endpoint (<xref:System.ServiceModel.Dispatcher.ChannelDispatcher> e <xref:System.ServiceModel.Dispatcher.EndpointDispatcher>rispettivamente) sono i componenti del servizio responsabili dell'accettazione di nuovi canali, della ricezione di messaggi, della chiamata e dell'invio delle operazioni e dell'elaborazione delle risposte.</span><span class="sxs-lookup"><span data-stu-id="17097-112">In WCF the channel and endpoint dispatchers (<xref:System.ServiceModel.Dispatcher.ChannelDispatcher> and <xref:System.ServiceModel.Dispatcher.EndpointDispatcher>, respectively) are the service components responsible for accepting new channels, receiving messages, operation dispatch and invocation, and response processing.</span></span> <span data-ttu-id="17097-113">Gli oggetti dispatcher sono oggetti destinatario, ma anche le implementazioni del contratto di callback nei servizi duplex espongono oggetti dispatcher per ispezione, modifica o estensione.</span><span class="sxs-lookup"><span data-stu-id="17097-113">Dispatcher objects are receiver objects, but callback contract implementations in duplex services also expose their dispatcher objects for inspection, modification, or extension.</span></span>

<span data-ttu-id="17097-114">Il dispatcher del canale (e la classe <xref:System.ServiceModel.Channels.IChannelListener> complementare) estrae i messaggi dal canale sottostante e li passa ai rispettivi dispatcher dell'endpoint.</span><span class="sxs-lookup"><span data-stu-id="17097-114">The channel dispatcher (and companion <xref:System.ServiceModel.Channels.IChannelListener>) pulls messages out of the underling channel and passes the messages to their respective endpoint dispatchers.</span></span> <span data-ttu-id="17097-115">Ogni dispatcher dell'endpoint ha una classe <xref:System.ServiceModel.Dispatcher.DispatchRuntime> che indirizza i messaggi alla classe <xref:System.ServiceModel.Dispatcher.DispatchOperation> appropriata, responsabile della chiamata al metodo che implementa l'operazione.</span><span class="sxs-lookup"><span data-stu-id="17097-115">Each endpoint dispatcher has a <xref:System.ServiceModel.Dispatcher.DispatchRuntime> that routes messages to the appropriate <xref:System.ServiceModel.Dispatcher.DispatchOperation>, which is responsible for calling the method that implements the operation.</span></span> <span data-ttu-id="17097-116">Durante il processo vengono richiamate varie classi di estensione facoltative e obbligatorie.</span><span class="sxs-lookup"><span data-stu-id="17097-116">Various optional and required extension classes are invoked along the way.</span></span> <span data-ttu-id="17097-117">In questo argomento viene illustrato come vengono assemblati questi pezzi e come è possibile modificare proprietà e inserirvi il proprio codice per estendere la funzionalità di base.</span><span class="sxs-lookup"><span data-stu-id="17097-117">This topic explains how these pieces fit together, and how you might modify properties and plug your own code in to extend the base functionality.</span></span>

<span data-ttu-id="17097-118">Le proprietà dispatcher e gli oggetti di personalizzazione modificati vengono inseriti usando oggetti comportamento di servizi, endpoint, contratti o operazioni.</span><span class="sxs-lookup"><span data-stu-id="17097-118">Dispatcher properties and modified customization objects are inserted by using service, endpoint, contract, or operation behavior objects.</span></span> <span data-ttu-id="17097-119">In questo argomento non viene descritto come usare i comportamenti.</span><span class="sxs-lookup"><span data-stu-id="17097-119">This topic does not describe how to use behaviors.</span></span> <span data-ttu-id="17097-120">Per ulteriori informazioni sui tipi utilizzati per inserire le modifiche al dispatcher, vedere [configurazione ed estensione del runtime con i comportamenti](configuring-and-extending-the-runtime-with-behaviors.md).</span><span class="sxs-lookup"><span data-stu-id="17097-120">For more information about the types used to insert dispatcher modifications, see [Configuring and Extending the Runtime with Behaviors](configuring-and-extending-the-runtime-with-behaviors.md).</span></span>

<span data-ttu-id="17097-121">Nel grafico seguente viene fornita una panoramica dettagliata degli elementi architettonici di un servizio.</span><span class="sxs-lookup"><span data-stu-id="17097-121">The following graphic provides a high-level view of the architectural items in a service.</span></span>

<span data-ttu-id="17097-122">![Architettura del runtime di invio](./media/wcfc-dispatchruntimearchc.gif "wcfc_DispatchRuntimeArchc")</span><span class="sxs-lookup"><span data-stu-id="17097-122">![The dispatch runtime architecture](./media/wcfc-dispatchruntimearchc.gif "wcfc_DispatchRuntimeArchc")</span></span>

### <a name="channel-dispatchers"></a><span data-ttu-id="17097-123">Dispatcher del canale</span><span class="sxs-lookup"><span data-stu-id="17097-123">Channel Dispatchers</span></span>

<span data-ttu-id="17097-124">Viene creato un oggetto <xref:System.ServiceModel.Dispatcher.ChannelDispatcher> per associare una classe <xref:System.ServiceModel.Channels.IChannelListener> in un particolare URI (denominato URI di ascolto) a un'istanza di un servizio.</span><span class="sxs-lookup"><span data-stu-id="17097-124">A <xref:System.ServiceModel.Dispatcher.ChannelDispatcher> object is created to associate an <xref:System.ServiceModel.Channels.IChannelListener> at a particular URI (called a listen URI) with an instance of a service.</span></span> <span data-ttu-id="17097-125">Ogni oggetto <xref:System.ServiceModel.ServiceHost> può avere numerosi oggetti <xref:System.ServiceModel.Dispatcher.ChannelDispatcher>, ognuno associato a un solo listener e URI di ascolto.</span><span class="sxs-lookup"><span data-stu-id="17097-125">Each <xref:System.ServiceModel.ServiceHost> object can have many <xref:System.ServiceModel.Dispatcher.ChannelDispatcher> objects, each associated with only one listener and listen URI.</span></span> <span data-ttu-id="17097-126">All'arrivo di un messaggio <xref:System.ServiceModel.Dispatcher.ChannelDispatcher> esegue una query su ognuno degli oggetti <xref:System.ServiceModel.Dispatcher.EndpointDispatcher> associati per scoprire se l'endpoint può accettare il messaggio, quindi passa il messaggio all'endpoint che ne ha la possibilità.</span><span class="sxs-lookup"><span data-stu-id="17097-126">When a message arrives, the <xref:System.ServiceModel.Dispatcher.ChannelDispatcher> queries each of the associated <xref:System.ServiceModel.Dispatcher.EndpointDispatcher> objects whether the endpoint can accept the message, and passes the message to the one that can.</span></span>

<span data-ttu-id="17097-127">Tutte le proprietà che controllano la durata e il comportamento di una sessione del canale sono disponibili per essere controllate o modificate sull'oggetto <xref:System.ServiceModel.Dispatcher.ChannelDispatcher>.</span><span class="sxs-lookup"><span data-stu-id="17097-127">All properties that control the lifetime and behavior of a channel session are available for inspection or modification on the <xref:System.ServiceModel.Dispatcher.ChannelDispatcher> object.</span></span> <span data-ttu-id="17097-128">Sono inclusi gli inizializzatori di canale personalizzati, il listener del canale, l'host, l'oggetto <xref:System.ServiceModel.InstanceContext>e associato e così via.</span><span class="sxs-lookup"><span data-stu-id="17097-128">These include custom channel initializers, the channel listener, the host, the associated <xref:System.ServiceModel.InstanceContext>, and so on.</span></span>

### <a name="endpoint-dispatchers"></a><span data-ttu-id="17097-129">Dispatcher dell'endpoint</span><span class="sxs-lookup"><span data-stu-id="17097-129">Endpoint Dispatchers</span></span>

<span data-ttu-id="17097-130">L'oggetto <xref:System.ServiceModel.Dispatcher.EndpointDispatcher> è responsabile dell'elaborazione dei messaggi da una classe <xref:System.ServiceModel.Dispatcher.ChannelDispatcher>, quando l'indirizzo di destinazione di un messaggio corrisponde alla proprietà <xref:System.ServiceModel.Dispatcher.EndpointDispatcher.AddressFilter%2A> e l'azione del messaggio corrisponde alla proprietà <xref:System.ServiceModel.Dispatcher.EndpointDispatcher.ContractFilter%2A>.</span><span class="sxs-lookup"><span data-stu-id="17097-130">The <xref:System.ServiceModel.Dispatcher.EndpointDispatcher> object is responsible for processing messages from a <xref:System.ServiceModel.Dispatcher.ChannelDispatcher> when the destination address of a message matches the <xref:System.ServiceModel.Dispatcher.EndpointDispatcher.AddressFilter%2A> and the message action matches the <xref:System.ServiceModel.Dispatcher.EndpointDispatcher.ContractFilter%2A> property.</span></span> <span data-ttu-id="17097-131">Se due oggetti <xref:System.ServiceModel.Dispatcher.EndpointDispatcher> possono accettare un messaggio, il valore della proprietà <xref:System.ServiceModel.Dispatcher.EndpointDispatcher.FilterPriority%2A> determina l'endpoint con la priorità più elevata.</span><span class="sxs-lookup"><span data-stu-id="17097-131">If two <xref:System.ServiceModel.Dispatcher.EndpointDispatcher> objects can accept a message, the <xref:System.ServiceModel.Dispatcher.EndpointDispatcher.FilterPriority%2A> property value determines the higher priority endpoint.</span></span>

<span data-ttu-id="17097-132">Usare <xref:System.ServiceModel.Dispatcher.EndpointDispatcher> per acquisire i due principali punti di estensione del modello di servizi, ovvero le classi <xref:System.ServiceModel.Dispatcher.DispatchRuntime> e <xref:System.ServiceModel.Dispatcher.DispatchOperation>, utilizzabili per personalizzare l'elaborazione del dispatcher.</span><span class="sxs-lookup"><span data-stu-id="17097-132">Use the <xref:System.ServiceModel.Dispatcher.EndpointDispatcher> to acquire the two main service model extension points – the <xref:System.ServiceModel.Dispatcher.DispatchRuntime> and <xref:System.ServiceModel.Dispatcher.DispatchOperation> classes – that you can use to customize the processing of the dispatcher.</span></span> <span data-ttu-id="17097-133">La classe <xref:System.ServiceModel.Dispatcher.DispatchRuntime> consente agli utenti di intercettare ed estendere il dispatcher nell'ambito del contratto, ovvero per tutti i messaggi del contratto.</span><span class="sxs-lookup"><span data-stu-id="17097-133">The <xref:System.ServiceModel.Dispatcher.DispatchRuntime> class allows users to intercept and extend the dispatcher at the contract scope (that is, for all messages in a contract).</span></span> <span data-ttu-id="17097-134">La classe <xref:System.ServiceModel.Dispatcher.DispatchOperation> consente agli utenti di intercettare ed estendere il dispatcher nell'ambito di un'operazione, ovvero per tutti i messaggi in un'operazione.</span><span class="sxs-lookup"><span data-stu-id="17097-134">The <xref:System.ServiceModel.Dispatcher.DispatchOperation> class allows users to intercept and extend the dispatcher at an operation scope (that is, for all messages in an operation).</span></span>

## <a name="scenarios"></a><span data-ttu-id="17097-135">Scenari</span><span class="sxs-lookup"><span data-stu-id="17097-135">Scenarios</span></span>

<span data-ttu-id="17097-136">Esistono vari motivi per estendere il dispatcher:</span><span class="sxs-lookup"><span data-stu-id="17097-136">There a number of reasons to extend the dispatcher:</span></span>

- <span data-ttu-id="17097-137">Convalida di messaggi personalizzata.</span><span class="sxs-lookup"><span data-stu-id="17097-137">Custom Message Validation.</span></span> <span data-ttu-id="17097-138">Gli utenti possono imporre che un messaggio sia valido per un certo schema.</span><span class="sxs-lookup"><span data-stu-id="17097-138">Users can enforce that a message is valid for a certain schema.</span></span> <span data-ttu-id="17097-139">A questo scopo, è possibile implementare le interfacce degli intercettori di messaggi.</span><span class="sxs-lookup"><span data-stu-id="17097-139">This can be done by implementing the message interceptor interfaces.</span></span> <span data-ttu-id="17097-140">Per un esempio, vedere [controlli messaggi](../samples/message-inspectors.md).</span><span class="sxs-lookup"><span data-stu-id="17097-140">For an example, see [Message Inspectors](../samples/message-inspectors.md).</span></span>

- <span data-ttu-id="17097-141">Registrazione di messaggi personalizzata.</span><span class="sxs-lookup"><span data-stu-id="17097-141">Custom Message Logging.</span></span> <span data-ttu-id="17097-142">Gli utenti possono controllare e registrare un set di messaggi dell'applicazione che passano attraverso un endpoint.</span><span class="sxs-lookup"><span data-stu-id="17097-142">Users can inspect and log some set of application messages that flow through an endpoint.</span></span> <span data-ttu-id="17097-143">Questa operazione può essere eseguita anche con le interfacce degli intercettori di messaggi.</span><span class="sxs-lookup"><span data-stu-id="17097-143">This can also be accomplished with the message interceptor interfaces.</span></span>

- <span data-ttu-id="17097-144">Trasformazioni di messaggi personalizzate.</span><span class="sxs-lookup"><span data-stu-id="17097-144">Custom Message Transformations.</span></span> <span data-ttu-id="17097-145">Gli utenti possono applicare determinate trasformazioni al messaggio nel runtime (ad esempio per il controllo delle versioni).</span><span class="sxs-lookup"><span data-stu-id="17097-145">Users can apply certain transformations to the message in the runtime (for example, for versioning).</span></span> <span data-ttu-id="17097-146">Anche in questo caso, l'operazione può essere eseguita con le interfacce degli intercettori di messaggi.</span><span class="sxs-lookup"><span data-stu-id="17097-146">This can be accomplished, again, with the message interceptor interfaces.</span></span>

- <span data-ttu-id="17097-147">Modello di dati personalizzato.</span><span class="sxs-lookup"><span data-stu-id="17097-147">Custom Data Model.</span></span> <span data-ttu-id="17097-148">Gli utenti possono disporre di un modello di serializzazione dei dati diverso da quelli supportati per impostazione predefinita <xref:System.Runtime.Serialization.DataContractSerializer?displayProperty=nameWithType>in <xref:System.Xml.Serialization.XmlSerializer?displayProperty=nameWithType>WCF (ossia,, e messaggi non elaborati).</span><span class="sxs-lookup"><span data-stu-id="17097-148">Users can have a data serialization model other than those supported by default in WCF (namely, <xref:System.Runtime.Serialization.DataContractSerializer?displayProperty=nameWithType>, <xref:System.Xml.Serialization.XmlSerializer?displayProperty=nameWithType>, and raw messages).</span></span> <span data-ttu-id="17097-149">A questo scopo, è possibile implementare le interfacce dei formattatori di messaggi.</span><span class="sxs-lookup"><span data-stu-id="17097-149">This can be done by implement the message formatter interfaces.</span></span> <span data-ttu-id="17097-150">Per un esempio, vedere il [formattatore dell'operazione e il selettore dell'operazione](../samples/operation-formatter-and-operation-selector.md).</span><span class="sxs-lookup"><span data-stu-id="17097-150">For an example, see [Operation Formatter and Operation Selector](../samples/operation-formatter-and-operation-selector.md).</span></span>

- <span data-ttu-id="17097-151">Convalida di parametri personalizzata.</span><span class="sxs-lookup"><span data-stu-id="17097-151">Custom Parameter Validation.</span></span> <span data-ttu-id="17097-152">Gli utenti possono imporre che i parametri tipizzati siano validi (a differenza di XML).</span><span class="sxs-lookup"><span data-stu-id="17097-152">Users can enforce that typed parameters are valid (as opposed to XML).</span></span> <span data-ttu-id="17097-153">A questo scopo, è possibile usare le interfacce di controllo dei parametri.</span><span class="sxs-lookup"><span data-stu-id="17097-153">This can be done using the parameter inspector interfaces.</span></span>

- <span data-ttu-id="17097-154">Invio di operazioni personalizzato.</span><span class="sxs-lookup"><span data-stu-id="17097-154">Custom Operation Dispatching.</span></span> <span data-ttu-id="17097-155">Gli utenti possono implementare l'invio su un elemento diverso dall'azione, ad esempio, sull'elemento corpo o su una proprietà del messaggio personalizzata.</span><span class="sxs-lookup"><span data-stu-id="17097-155">Users can implement dispatching on something other than action – for example, on the body element, or on a custom message property.</span></span> <span data-ttu-id="17097-156">A questo scopo, usare l'interfaccia <xref:System.ServiceModel.Dispatcher.IDispatchOperationSelector>.</span><span class="sxs-lookup"><span data-stu-id="17097-156">This can be done using the <xref:System.ServiceModel.Dispatcher.IDispatchOperationSelector> interface.</span></span> <span data-ttu-id="17097-157">Per un esempio, vedere il [formattatore dell'operazione e il selettore dell'operazione](../samples/operation-formatter-and-operation-selector.md).</span><span class="sxs-lookup"><span data-stu-id="17097-157">For an example, see [Operation Formatter and Operation Selector](../samples/operation-formatter-and-operation-selector.md).</span></span>

- <span data-ttu-id="17097-158">Pool di oggetti.</span><span class="sxs-lookup"><span data-stu-id="17097-158">Object Pooling.</span></span> <span data-ttu-id="17097-159">Gli utenti possono eseguire il pool delle istanze invece di allocare una nuova istanza per ogni chiamata.</span><span class="sxs-lookup"><span data-stu-id="17097-159">Users can pool instances rather than allocating a new one for every call.</span></span> <span data-ttu-id="17097-160">A questo scopo, usare le interfacce del provider di istanze.</span><span class="sxs-lookup"><span data-stu-id="17097-160">This can be implemented using the instance provider interfaces.</span></span> <span data-ttu-id="17097-161">Per un esempio, vedere [pooling](../samples/pooling.md).</span><span class="sxs-lookup"><span data-stu-id="17097-161">For an example, see [Pooling](../samples/pooling.md).</span></span>

- <span data-ttu-id="17097-162">Leasing di istanza.</span><span class="sxs-lookup"><span data-stu-id="17097-162">Instance Leasing.</span></span> <span data-ttu-id="17097-163">Gli utenti possono implementare un modello di leasing per la durata dell'istanza, simile a quello di .NET Framework Remoting.</span><span class="sxs-lookup"><span data-stu-id="17097-163">Users can implement a leasing pattern for instance lifetime, similar to that of .NET Framework Remoting.</span></span> <span data-ttu-id="17097-164">A questo scopo, è possibile usare le interfacce di durata del contesto dell'istanza.</span><span class="sxs-lookup"><span data-stu-id="17097-164">This can be done using the instance context lifetime interfaces.</span></span>

- <span data-ttu-id="17097-165">Gestione degli errori personalizzata.</span><span class="sxs-lookup"><span data-stu-id="17097-165">Custom Error Handling.</span></span> <span data-ttu-id="17097-166">Gli utenti possono controllare come vengono elaborati gli errori locali e come vengono comunicati ai client.</span><span class="sxs-lookup"><span data-stu-id="17097-166">Users can control how both local errors are processed and how faults are communicated back to clients.</span></span> <span data-ttu-id="17097-167">A questo scopo, usare le interfacce <xref:System.ServiceModel.Dispatcher.IErrorHandler>.</span><span class="sxs-lookup"><span data-stu-id="17097-167">This can be implemented using the <xref:System.ServiceModel.Dispatcher.IErrorHandler> interfaces.</span></span>

- <span data-ttu-id="17097-168">Comportamenti di autorizzazione personalizzati.</span><span class="sxs-lookup"><span data-stu-id="17097-168">Custom Authorization Behaviors.</span></span> <span data-ttu-id="17097-169">Gli utenti possono implementare il controllo di accesso personalizzato estendendo i pezzi di runtime Contratto o Operazione e aggiungendo controlli di sicurezza basati sui token presenti nel messaggio.</span><span class="sxs-lookup"><span data-stu-id="17097-169">Users can implement custom access control by extending the Contract or Operation run-time pieces and adding security checks based upon the tokens present in the message.</span></span> <span data-ttu-id="17097-170">L'operazione può essere eseguita con le interfacce degli intercettori di messaggi o di parametri.</span><span class="sxs-lookup"><span data-stu-id="17097-170">This can be accomplished using either the message interceptor or parameter interceptor interfaces.</span></span> <span data-ttu-id="17097-171">Per esempi, vedere [estensibilità di sicurezza](../samples/security-extensibility.md).</span><span class="sxs-lookup"><span data-stu-id="17097-171">For examples, see [Security Extensibility](../samples/security-extensibility.md).</span></span>

  > [!CAUTION]
  > <span data-ttu-id="17097-172">Poiché la modifica delle proprietà di sicurezza può compromettere la sicurezza delle applicazioni WCF, è consigliabile intraprendere le modifiche relative alla sicurezza con attenzione ed eseguire test approfonditi prima della distribuzione.</span><span class="sxs-lookup"><span data-stu-id="17097-172">Because altering security properties has the potential to compromise the security of WCF applications, it is strongly recommended that you undertake security-related modifications with care and test thoroughly prior to deployment.</span></span>

- <span data-ttu-id="17097-173">Validator del runtime WCF personalizzati.</span><span class="sxs-lookup"><span data-stu-id="17097-173">Custom WCF Runtime Validators.</span></span> <span data-ttu-id="17097-174">È possibile installare validator personalizzati che esaminano i servizi, i contratti e le associazioni per applicare i criteri a livello di organizzazione rispetto alle applicazioni WCF.</span><span class="sxs-lookup"><span data-stu-id="17097-174">You can install custom validators that examine services, contracts, and bindings to enforce enterprise-level policies with respect to WCF applications.</span></span> <span data-ttu-id="17097-175">(Ad esempio, vedere [procedura: Bloccare gli endpoint nell'organizzazione](how-to-lock-down-endpoints-in-the-enterprise.md).</span><span class="sxs-lookup"><span data-stu-id="17097-175">(For example, see [How to: Lock Down Endpoints in the Enterprise](how-to-lock-down-endpoints-in-the-enterprise.md).)</span></span>

### <a name="using-the-dispatchruntime-class"></a><span data-ttu-id="17097-176">Utilizzo della classe DispatchRuntime</span><span class="sxs-lookup"><span data-stu-id="17097-176">Using the DispatchRuntime Class</span></span>

<span data-ttu-id="17097-177">Usare la classe <xref:System.ServiceModel.Dispatcher.DispatchRuntime> per modificare il comportamento predefinito di un servizio o di un singolo endpoint oppure per inserire oggetti che implementano modifiche personalizzate in uno o entrambi i processi del servizio (o i processi client nel caso di un client duplex) seguenti:</span><span class="sxs-lookup"><span data-stu-id="17097-177">Use the <xref:System.ServiceModel.Dispatcher.DispatchRuntime> class either to modify the default behavior of a service or individual endpoint, or to insert objects that implement custom modifications to one or both of the following service processes (or client processes in the case of a duplex client):</span></span>

- <span data-ttu-id="17097-178">Trasformazione di messaggi in arrivo in oggetti e rilascio di tali oggetti come chiamate al metodo su un oggetto servizio.</span><span class="sxs-lookup"><span data-stu-id="17097-178">The transformation of incoming messages into objects and releasing those objects as method invocations on a service object.</span></span>

- <span data-ttu-id="17097-179">Trasformazione di oggetti ricevuti dalla risposta a una chiamata a operazioni del servizio in messaggi in uscita.</span><span class="sxs-lookup"><span data-stu-id="17097-179">The transformation of objects received from the response to a service operation invocation into outbound messages.</span></span>

<span data-ttu-id="17097-180"><xref:System.ServiceModel.Dispatcher.DispatchRuntime> consente di intercettare ed estendere il dispatcher del canale o dell'endpoint per tutti i messaggi di un particolare contratto, anche quando un messaggio non viene riconosciuto.</span><span class="sxs-lookup"><span data-stu-id="17097-180">The <xref:System.ServiceModel.Dispatcher.DispatchRuntime> enables you to intercept and extend the channel or endpoint dispatcher for all messages across a particular contract, even when a message is not recognized.</span></span> <span data-ttu-id="17097-181">Quando arriva un messaggio che non corrisponde ad alcun messaggio dichiarato nel contratto, viene inviato all'operazione restituita dalla proprietà <xref:System.ServiceModel.Dispatcher.DispatchRuntime.UnhandledDispatchOperation%2A>.</span><span class="sxs-lookup"><span data-stu-id="17097-181">When a message arrives that does not match any declared in the contract it is dispatched to the operation returned by the <xref:System.ServiceModel.Dispatcher.DispatchRuntime.UnhandledDispatchOperation%2A> property.</span></span> <span data-ttu-id="17097-182">Per l'intercettazione o l'estensione in tutti i messaggi relativi a una particolare operazione, vedere la classe <xref:System.ServiceModel.Dispatcher.DispatchOperation>.</span><span class="sxs-lookup"><span data-stu-id="17097-182">To intercept or extend across all messages for a particular operation, see the <xref:System.ServiceModel.Dispatcher.DispatchOperation> class.</span></span>

<span data-ttu-id="17097-183">Sono presenti quattro aree principali di estendibilità del dispatcher esposto dalla classe <xref:System.ServiceModel.Dispatcher.DispatchRuntime>:</span><span class="sxs-lookup"><span data-stu-id="17097-183">There are four main areas of dispatcher extensibility exposed by the <xref:System.ServiceModel.Dispatcher.DispatchRuntime> class:</span></span>

1. <span data-ttu-id="17097-184">I componenti del canale usano le proprietà di <xref:System.ServiceModel.Dispatcher.DispatchRuntime> e quelle del dispatcher del canale associato, restituito dalla proprietà <xref:System.ServiceModel.Dispatcher.DispatchRuntime.ChannelDispatcher%2A>, per personalizzare la modalità usata dal dispatcher del canale per accettare e chiudere canali.</span><span class="sxs-lookup"><span data-stu-id="17097-184">Channel components use the properties of the <xref:System.ServiceModel.Dispatcher.DispatchRuntime> and those of the associated channel dispatcher returned by the <xref:System.ServiceModel.Dispatcher.DispatchRuntime.ChannelDispatcher%2A> property to customize how the channel dispatcher accepts and closes channels.</span></span> <span data-ttu-id="17097-185">In questa categoria sono incluse le proprietà <xref:System.ServiceModel.Dispatcher.ChannelDispatcher.ChannelInitializers%2A> e <xref:System.ServiceModel.Dispatcher.DispatchRuntime.InputSessionShutdownHandlers%2A>.</span><span class="sxs-lookup"><span data-stu-id="17097-185">This category includes the <xref:System.ServiceModel.Dispatcher.ChannelDispatcher.ChannelInitializers%2A> and <xref:System.ServiceModel.Dispatcher.DispatchRuntime.InputSessionShutdownHandlers%2A> properties.</span></span>

2. <span data-ttu-id="17097-186">I componenti dei messaggi vengono personalizzati per ogni messaggio elaborato.</span><span class="sxs-lookup"><span data-stu-id="17097-186">Message components are customized for each message processed.</span></span> <span data-ttu-id="17097-187">In questa categoria sono incluse le proprietà <xref:System.ServiceModel.Dispatcher.DispatchRuntime.MessageInspectors%2A>, <xref:System.ServiceModel.Dispatcher.DispatchRuntime.OperationSelector%2A>, <xref:System.ServiceModel.Dispatcher.DispatchRuntime.Operations%2A> e <xref:System.ServiceModel.Dispatcher.ChannelDispatcher.ErrorHandlers%2A>.</span><span class="sxs-lookup"><span data-stu-id="17097-187">This category includes the <xref:System.ServiceModel.Dispatcher.DispatchRuntime.MessageInspectors%2A>, <xref:System.ServiceModel.Dispatcher.DispatchRuntime.OperationSelector%2A>, <xref:System.ServiceModel.Dispatcher.DispatchRuntime.Operations%2A>, and the <xref:System.ServiceModel.Dispatcher.ChannelDispatcher.ErrorHandlers%2A> properties.</span></span>

3. <span data-ttu-id="17097-188">I componenti dell'istanza personalizzano la creazione, la durata e l'eliminazione di istanze del tipo di servizio.</span><span class="sxs-lookup"><span data-stu-id="17097-188">Instance components customize the creation, lifetime, and disposal of instances of the service type.</span></span> <span data-ttu-id="17097-189">Per altre informazioni sulle durate degli oggetti di servizio, vedere la proprietà <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A>.</span><span class="sxs-lookup"><span data-stu-id="17097-189">For more information about service object lifetimes, see the <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A> property.</span></span> <span data-ttu-id="17097-190">In questa categoria sono incluse le proprietà <xref:System.ServiceModel.Dispatcher.DispatchRuntime.InstanceContextInitializers%2A> e <xref:System.ServiceModel.Dispatcher.DispatchRuntime.InstanceProvider%2A>.</span><span class="sxs-lookup"><span data-stu-id="17097-190">This category includes the <xref:System.ServiceModel.Dispatcher.DispatchRuntime.InstanceContextInitializers%2A> and the <xref:System.ServiceModel.Dispatcher.DispatchRuntime.InstanceProvider%2A> properties.</span></span>

4. <span data-ttu-id="17097-191">I componenti correlati alla protezione possono usare le proprietà seguenti:</span><span class="sxs-lookup"><span data-stu-id="17097-191">Security-related components can use the following properties:</span></span>

    - <span data-ttu-id="17097-192"><xref:System.ServiceModel.Dispatcher.DispatchRuntime.SecurityAuditLogLocation%2A> indica dove vengono scritti gli eventi di controllo.</span><span class="sxs-lookup"><span data-stu-id="17097-192"><xref:System.ServiceModel.Dispatcher.DispatchRuntime.SecurityAuditLogLocation%2A> indicates where audit events are written.</span></span>

    - <span data-ttu-id="17097-193"><xref:System.ServiceModel.Dispatcher.DispatchRuntime.ImpersonateCallerForAllOperations%2A> controlla se il servizio tenta di eseguire una rappresentazione usando le credenziali fornite dal messaggio in ingresso.</span><span class="sxs-lookup"><span data-stu-id="17097-193"><xref:System.ServiceModel.Dispatcher.DispatchRuntime.ImpersonateCallerForAllOperations%2A> controls whether the service attempts to impersonate using the credentials provided by the incoming message.</span></span>

    - <span data-ttu-id="17097-194"><xref:System.ServiceModel.Dispatcher.DispatchRuntime.MessageAuthenticationAuditLevel%2A> controlla se nel registro eventi specificato da <xref:System.ServiceModel.Dispatcher.DispatchRuntime.SecurityAuditLogLocation%2A> vengono scritti eventi di autenticazione riuscita dei messaggi.</span><span class="sxs-lookup"><span data-stu-id="17097-194"><xref:System.ServiceModel.Dispatcher.DispatchRuntime.MessageAuthenticationAuditLevel%2A> controls whether successful message authentication events are written to the event log specified by <xref:System.ServiceModel.Dispatcher.DispatchRuntime.SecurityAuditLogLocation%2A>.</span></span>

    - <span data-ttu-id="17097-195"><xref:System.ServiceModel.Dispatcher.DispatchRuntime.PrincipalPermissionMode%2A> controlla le modalità di impostazione della proprietà <xref:System.Threading.Thread.CurrentPrincipal%2A>.</span><span class="sxs-lookup"><span data-stu-id="17097-195"><xref:System.ServiceModel.Dispatcher.DispatchRuntime.PrincipalPermissionMode%2A> controls how the <xref:System.Threading.Thread.CurrentPrincipal%2A> property is set.</span></span>

    - <span data-ttu-id="17097-196"><xref:System.ServiceModel.Dispatcher.DispatchRuntime.ServiceAuthorizationAuditLevel%2A>specifica le modalità di esecuzione del controllo degli eventi di autorizzazione.</span><span class="sxs-lookup"><span data-stu-id="17097-196"><xref:System.ServiceModel.Dispatcher.DispatchRuntime.ServiceAuthorizationAuditLevel%2A> specifies how the auditing of authorization events is performed.</span></span>

    - <span data-ttu-id="17097-197"><xref:System.ServiceModel.Dispatcher.DispatchRuntime.SuppressAuditFailure%2A> specifica se sopprimere le eccezioni non critiche che si verificano durante il processo di registrazione.</span><span class="sxs-lookup"><span data-stu-id="17097-197"><xref:System.ServiceModel.Dispatcher.DispatchRuntime.SuppressAuditFailure%2A> specifies whether to suppress non-critical exceptions that occur during the logging process.</span></span>

<span data-ttu-id="17097-198">In genere, gli oggetti di estensione personalizzati vengono assegnati a una proprietà <xref:System.ServiceModel.Dispatcher.DispatchRuntime> o inseriti in una raccolta da un comportamento del servizio (un oggetto che implementa <xref:System.ServiceModel.Description.IServiceBehavior>), un comportamento del contratto (un oggetto che implementa <xref:System.ServiceModel.Description.IContractBehavior>) o un comportamento dell'endpoint (un oggetto che implementa <xref:System.ServiceModel.Description.IEndpointBehavior>).</span><span class="sxs-lookup"><span data-stu-id="17097-198">Typically, custom extension objects are assigned to a <xref:System.ServiceModel.Dispatcher.DispatchRuntime> property or inserted into a collection by a service behavior (an object that implements <xref:System.ServiceModel.Description.IServiceBehavior>), a contract behavior (an object that implements <xref:System.ServiceModel.Description.IContractBehavior>), or an endpoint behavior (an object that implements <xref:System.ServiceModel.Description.IEndpointBehavior>).</span></span> <span data-ttu-id="17097-199">L'oggetto del comportamento da installare viene quindi aggiunto alla raccolta appropriata di comportamenti a livello di programmazione o implementando un oggetto <xref:System.ServiceModel.Configuration.BehaviorExtensionElement> personalizzato per consentire l'inserimento del comportamento usando un file di configurazione dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="17097-199">Then the installing behavior object is added to the appropriate collection of behaviors either programmatically or by implementing a custom <xref:System.ServiceModel.Configuration.BehaviorExtensionElement> object to enable the behavior to be inserted using an application configuration file.</span></span>

<span data-ttu-id="17097-200">I client duplex (client che implementano un contratto di callback specificato da un servizio duplex) hanno anche un oggetto <xref:System.ServiceModel.Dispatcher.DispatchRuntime> a cui è possibile accedere usando la proprietà <xref:System.ServiceModel.Dispatcher.ClientRuntime.CallbackDispatchRuntime%2A>.</span><span class="sxs-lookup"><span data-stu-id="17097-200">Duplex clients (clients that implement a callback contract specified by a duplex service) also have a <xref:System.ServiceModel.Dispatcher.DispatchRuntime> object that can be accessed using the <xref:System.ServiceModel.Dispatcher.ClientRuntime.CallbackDispatchRuntime%2A> property.</span></span>

### <a name="using-the-dispatchoperation-class"></a><span data-ttu-id="17097-201">Utilizzo della classe DispatchOperation</span><span class="sxs-lookup"><span data-stu-id="17097-201">Using the DispatchOperation Class</span></span>

<span data-ttu-id="17097-202">La classe <xref:System.ServiceModel.Dispatcher.DispatchOperation> è il luogo in cui è possibile eseguire modifiche del runtime ed è il punto di inserimento per estensioni personalizzate nell'ambito di una sola operazione del servizio.</span><span class="sxs-lookup"><span data-stu-id="17097-202">The <xref:System.ServiceModel.Dispatcher.DispatchOperation> class is the location for run-time modifications and the insertion point for custom extensions that are scoped to only one service operation.</span></span> <span data-ttu-id="17097-203">Per modificare il comportamento del runtime del servizio per tutti i messaggi di un contratto, usare la classe <xref:System.ServiceModel.Dispatcher.DispatchRuntime>.</span><span class="sxs-lookup"><span data-stu-id="17097-203">(To modify service run-time behavior for all messages in a contract, use the <xref:System.ServiceModel.Dispatcher.DispatchRuntime> class.)</span></span>

<span data-ttu-id="17097-204">Installare modifiche di <xref:System.ServiceModel.Dispatcher.DispatchOperation> usando un oggetto comportamento del servizio personalizzato.</span><span class="sxs-lookup"><span data-stu-id="17097-204">Install <xref:System.ServiceModel.Dispatcher.DispatchOperation> modifications using a custom service behavior object.</span></span>

<span data-ttu-id="17097-205">Usare la proprietà <xref:System.ServiceModel.Dispatcher.DispatchRuntime.Operations%2A> per individuare l'oggetto <xref:System.ServiceModel.Dispatcher.DispatchOperation> che rappresenta un'operazione specifica del servizio.</span><span class="sxs-lookup"><span data-stu-id="17097-205">Use the <xref:System.ServiceModel.Dispatcher.DispatchRuntime.Operations%2A> property to locate the <xref:System.ServiceModel.Dispatcher.DispatchOperation> object that represents a particular service operation.</span></span>

<span data-ttu-id="17097-206">Le proprietà seguenti controllano l'esecuzione del runtime a livello di operazione:</span><span class="sxs-lookup"><span data-stu-id="17097-206">The following properties control runtime execution at the operation level:</span></span>

- <span data-ttu-id="17097-207">Le proprietà <xref:System.ServiceModel.Dispatcher.DispatchOperation.Action%2A>, <xref:System.ServiceModel.Dispatcher.DispatchOperation.ReplyAction%2A>, <xref:System.ServiceModel.Dispatcher.DispatchOperation.FaultContractInfos%2A>, <xref:System.ServiceModel.Dispatcher.DispatchOperation.IsOneWay%2A>, <xref:System.ServiceModel.Dispatcher.DispatchOperation.IsTerminating%2A> e <xref:System.ServiceModel.Dispatcher.DispatchOperation.Name%2A> ottengono i rispettivi valori dell'operazione.</span><span class="sxs-lookup"><span data-stu-id="17097-207">The <xref:System.ServiceModel.Dispatcher.DispatchOperation.Action%2A>, <xref:System.ServiceModel.Dispatcher.DispatchOperation.ReplyAction%2A>, <xref:System.ServiceModel.Dispatcher.DispatchOperation.FaultContractInfos%2A>, <xref:System.ServiceModel.Dispatcher.DispatchOperation.IsOneWay%2A>, <xref:System.ServiceModel.Dispatcher.DispatchOperation.IsTerminating%2A>, and <xref:System.ServiceModel.Dispatcher.DispatchOperation.Name%2A> properties obtain the respective values for the operation.</span></span>

- <span data-ttu-id="17097-208"><xref:System.ServiceModel.Dispatcher.DispatchOperation.TransactionAutoComplete%2A> e <xref:System.ServiceModel.Dispatcher.DispatchOperation.TransactionRequired%2A> specificano il comportamento della transazione.</span><span class="sxs-lookup"><span data-stu-id="17097-208">The <xref:System.ServiceModel.Dispatcher.DispatchOperation.TransactionAutoComplete%2A> and <xref:System.ServiceModel.Dispatcher.DispatchOperation.TransactionRequired%2A> specify transaction behavior.</span></span>

- <span data-ttu-id="17097-209">Le proprietà <xref:System.ServiceModel.Dispatcher.DispatchOperation.ReleaseInstanceBeforeCall%2A> e <xref:System.ServiceModel.Dispatcher.DispatchOperation.ReleaseInstanceAfterCall%2A> controllano la durata dell'oggetto di servizio definito dall'utente relativo alla classe <xref:System.ServiceModel.InstanceContext>.</span><span class="sxs-lookup"><span data-stu-id="17097-209">The <xref:System.ServiceModel.Dispatcher.DispatchOperation.ReleaseInstanceBeforeCall%2A> and <xref:System.ServiceModel.Dispatcher.DispatchOperation.ReleaseInstanceAfterCall%2A> properties control the lifetime of the user-defined service object relative to the <xref:System.ServiceModel.InstanceContext>.</span></span>

- <span data-ttu-id="17097-210">Le proprietà <xref:System.ServiceModel.Dispatcher.DispatchOperation.DeserializeRequest%2A>, <xref:System.ServiceModel.Dispatcher.DispatchOperation.SerializeReply%2A> e <xref:System.ServiceModel.Dispatcher.DispatchOperation.Formatter%2A> consentono di controllare esplicitamente la conversione dei messaggi in oggetti e viceversa.</span><span class="sxs-lookup"><span data-stu-id="17097-210">The <xref:System.ServiceModel.Dispatcher.DispatchOperation.DeserializeRequest%2A>, <xref:System.ServiceModel.Dispatcher.DispatchOperation.SerializeReply%2A>, and the <xref:System.ServiceModel.Dispatcher.DispatchOperation.Formatter%2A> properties enable explicit control over the conversion from messages to objects and objects to messages.</span></span>

- <span data-ttu-id="17097-211">La proprietà <xref:System.ServiceModel.Dispatcher.DispatchOperation.Impersonation%2A> specifica il livello di rappresentazione dell'operazione.</span><span class="sxs-lookup"><span data-stu-id="17097-211">The <xref:System.ServiceModel.Dispatcher.DispatchOperation.Impersonation%2A> property specifies the operation impersonation level.</span></span>

- <span data-ttu-id="17097-212">La proprietà <xref:System.ServiceModel.Dispatcher.DispatchOperation.CallContextInitializers%2A> inserisce estensioni del contesto di chiamata personalizzate per l'operazione.</span><span class="sxs-lookup"><span data-stu-id="17097-212">The <xref:System.ServiceModel.Dispatcher.DispatchOperation.CallContextInitializers%2A> property inserts custom call context extensions for the operation.</span></span>

- <span data-ttu-id="17097-213">La proprietà <xref:System.ServiceModel.Dispatcher.DispatchOperation.AutoDisposeParameters%2A> controlla quando vengono eliminati definitivamente gli oggetti parametro.</span><span class="sxs-lookup"><span data-stu-id="17097-213">The <xref:System.ServiceModel.Dispatcher.DispatchOperation.AutoDisposeParameters%2A> property controls when parameter objects are destroyed.</span></span>

- <span data-ttu-id="17097-214">La proprietà <xref:System.ServiceModel.Dispatcher.DispatchOperation.Invoker%2A> consente di inserire un oggetto invoker personalizzato.</span><span class="sxs-lookup"><span data-stu-id="17097-214">The <xref:System.ServiceModel.Dispatcher.DispatchOperation.Invoker%2A> property to insert a custom invoker object.</span></span>

- <span data-ttu-id="17097-215">La proprietà <xref:System.ServiceModel.Dispatcher.DispatchOperation.ParameterInspectors%2A> consente di inserire un controllo del parametro personalizzato utilizzabile per controllare o modificare parametri e valori restituiti.</span><span class="sxs-lookup"><span data-stu-id="17097-215">The <xref:System.ServiceModel.Dispatcher.DispatchOperation.ParameterInspectors%2A> property enables you to insert a custom parameter inspector that you can use to inspect or modify parameters and return values.</span></span>

## <a name="see-also"></a><span data-ttu-id="17097-216">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="17097-216">See also</span></span>

- <xref:System.ServiceModel.Dispatcher.DispatchRuntime>
- <xref:System.ServiceModel.Dispatcher.DispatchOperation>
- [<span data-ttu-id="17097-217">Procedura: Esaminare e modificare i messaggi nel servizio</span><span class="sxs-lookup"><span data-stu-id="17097-217">How to: Inspect and Modify Messages on the Service</span></span>](how-to-inspect-and-modify-messages-on-the-service.md)
- [<span data-ttu-id="17097-218">Procedura: Controllare o modificare i parametri</span><span class="sxs-lookup"><span data-stu-id="17097-218">How to: Inspect or Modify Parameters</span></span>](how-to-inspect-or-modify-parameters.md)
- [<span data-ttu-id="17097-219">Procedura: Bloccare gli endpoint nell'organizzazione</span><span class="sxs-lookup"><span data-stu-id="17097-219">How to: Lock Down Endpoints in the Enterprise</span></span>](how-to-lock-down-endpoints-in-the-enterprise.md)
