---
title: Attributi della transazione di ServiceModel
ms.date: 03/30/2017
helpviewer_keywords:
- transactions [WCF], ServiceModel attributes
ms.assetid: 1e0d2436-6ae5-439b-9765-a448d6f60000
ms.openlocfilehash: d4b7482431404241577111d8dd3841319b65696e
ms.sourcegitcommit: d6e27023aeaffc4b5a3cb4b88685018d6284ada4
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 07/09/2019
ms.locfileid: "67663692"
---
# <a name="servicemodel-transaction-attributes"></a><span data-ttu-id="3d979-102">Attributi della transazione di ServiceModel</span><span class="sxs-lookup"><span data-stu-id="3d979-102">ServiceModel Transaction Attributes</span></span>

<span data-ttu-id="3d979-103">Windows Communication Foundation (WCF) fornisce le proprietà standard tre <xref:System.ServiceModel> gli attributi che consentono di configurare il comportamento delle transazioni per un servizio WCF:</span><span class="sxs-lookup"><span data-stu-id="3d979-103">Windows Communication Foundation (WCF) provides properties on three standard <xref:System.ServiceModel> attributes that enable you to configure the behavior of transactions for a WCF service:</span></span>

- <xref:System.ServiceModel.TransactionFlowAttribute>

- <xref:System.ServiceModel.ServiceBehaviorAttribute>

- <xref:System.ServiceModel.OperationBehaviorAttribute>

## <a name="transactionflowattribute"></a><span data-ttu-id="3d979-104">TransactionFlowAttribute</span><span class="sxs-lookup"><span data-stu-id="3d979-104">TransactionFlowAttribute</span></span>

<span data-ttu-id="3d979-105">L'attributo <xref:System.ServiceModel.TransactionFlowAttribute> specifica la disponibilità di un'operazione in un contratto di servizio ad accettare transazioni in ingresso da un client.</span><span class="sxs-lookup"><span data-stu-id="3d979-105">The <xref:System.ServiceModel.TransactionFlowAttribute> attribute specifies the willingness of an operation in a service contract to accept incoming transactions from a client.</span></span> <span data-ttu-id="3d979-106">L'attributo fornisce questo controllo con la proprietà seguente: Le transazioni utilizzano le <xref:System.ServiceModel.TransactionFlowOption> enumerazione per specificare se una transazione in ingresso <xref:System.ServiceModel.TransactionFlowOption.Mandatory>, <xref:System.ServiceModel.TransactionFlowOption.Allowed>, o <xref:System.ServiceModel.TransactionFlowOption.NotAllowed>.</span><span class="sxs-lookup"><span data-stu-id="3d979-106">The attribute provides this control with the following property: Transactions use the <xref:System.ServiceModel.TransactionFlowOption> enumeration to specify whether an incoming transaction is <xref:System.ServiceModel.TransactionFlowOption.Mandatory>, <xref:System.ServiceModel.TransactionFlowOption.Allowed>, or <xref:System.ServiceModel.TransactionFlowOption.NotAllowed>.</span></span>

<span data-ttu-id="3d979-107">Questo è l'unico attributo che correla le operazioni di assistenza alle interazioni esterne con un client.</span><span class="sxs-lookup"><span data-stu-id="3d979-107">This is the only attribute that relates service operations to external interactions with a client.</span></span> <span data-ttu-id="3d979-108">Gli attributi descritti nelle sezioni seguenti si riferiscono all'utilizzo di transazioni all'interno dell'esecuzione dell'operazione.</span><span class="sxs-lookup"><span data-stu-id="3d979-108">The attributes described in the following sections relate to the use of transactions within the execution of the operation.</span></span>

## <a name="servicebehaviorattribute"></a><span data-ttu-id="3d979-109">ServiceBehaviorAttribute</span><span class="sxs-lookup"><span data-stu-id="3d979-109">ServiceBehaviorAttribute</span></span>

<span data-ttu-id="3d979-110">L'attributo <xref:System.ServiceModel.ServiceBehaviorAttribute> specifica il comportamento di esecuzione interno di un'implementazione del contratto di servizio.</span><span class="sxs-lookup"><span data-stu-id="3d979-110">The <xref:System.ServiceModel.ServiceBehaviorAttribute> attribute specifies the internal execution behavior of a service contract implementation.</span></span> <span data-ttu-id="3d979-111">Le proprietà specifiche della transazione di questo attributo includono:</span><span class="sxs-lookup"><span data-stu-id="3d979-111">Transaction-specific properties of this attribute include:</span></span>

- <span data-ttu-id="3d979-112"><xref:System.ServiceModel.ServiceBehaviorAttribute.TransactionAutoCompleteOnSessionClose%2A> specifica se completare una transazione incompiuta alla chiusura della sessione.</span><span class="sxs-lookup"><span data-stu-id="3d979-112"><xref:System.ServiceModel.ServiceBehaviorAttribute.TransactionAutoCompleteOnSessionClose%2A> specifies whether to complete an uncompleted transaction when the session closes.</span></span> <span data-ttu-id="3d979-113">Il valore predefinito di questa proprietà è `false`.</span><span class="sxs-lookup"><span data-stu-id="3d979-113">The default value for this property is `false`.</span></span> <span data-ttu-id="3d979-114">Se questa proprietà è `true` e la sessione in ingresso è stata chiusa correttamente e non per problemi di rete o errori client, tutte le transazioni incompiute vengono completate correttamente.</span><span class="sxs-lookup"><span data-stu-id="3d979-114">If this property is `true`, and the incoming session was gracefully shut down instead of closing due to network or client faults, any uncompleted transaction is successfully completed.</span></span> <span data-ttu-id="3d979-115">In caso contrario, se questa proprietà è `false` o se la sessione non è stata chiusa normalmente, alla chiusura della sessione viene eseguito il rollback di tutte le transazioni incompiute.</span><span class="sxs-lookup"><span data-stu-id="3d979-115">Otherwise, if this property is `false` or if the session was not gracefully closed, any uncompleted transaction is rolled back when the session closes.</span></span> <span data-ttu-id="3d979-116">Se questa proprietà è `true`, il canale in ingresso deve essere basato sulla sessione.</span><span class="sxs-lookup"><span data-stu-id="3d979-116">If this property is `true`, the incoming channel must be session-based.</span></span>

- <span data-ttu-id="3d979-117"><xref:System.ServiceModel.ServiceBehaviorAttribute.ReleaseServiceInstanceOnTransactionComplete%2A> specifica se l'istanza del servizio sottostante viene rilasciata al completamento di una transazione.</span><span class="sxs-lookup"><span data-stu-id="3d979-117"><xref:System.ServiceModel.ServiceBehaviorAttribute.ReleaseServiceInstanceOnTransactionComplete%2A> specifies whether the underlying service instance is released when a transaction completes.</span></span> <span data-ttu-id="3d979-118">Il valore predefinito di questa proprietà è `true`.</span><span class="sxs-lookup"><span data-stu-id="3d979-118">The default value for this property is `true`.</span></span> <span data-ttu-id="3d979-119">Il messaggio in ingresso successivo provoca la creazione di una nuova istanza sottostante, ignorando qualsiasi stato per transazione dell'istanza precedente.</span><span class="sxs-lookup"><span data-stu-id="3d979-119">The next inbound message causes a new underlying instance to be created, discarding any per-transaction state that the previous instance might have held.</span></span> <span data-ttu-id="3d979-120">Il rilascio di un'istanza del servizio è un'azione interna eseguita dal servizio e non ha alcun impatto su nessuna connessione o sessione esistente che i client potrebbero aver stabilito.</span><span class="sxs-lookup"><span data-stu-id="3d979-120">Releasing a service instance is an internal action the service takes and has no impact on any existing connections or sessions that clients might have established.</span></span> <span data-ttu-id="3d979-121">Questa funzionalità equivale a quella di attivazione JIT fornita da COM+.</span><span class="sxs-lookup"><span data-stu-id="3d979-121">This functionality is equivalent to the just-in-time activation feature COM+ provides.</span></span> <span data-ttu-id="3d979-122">Se la proprietà è `true`, <xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A> deve essere uguale a <xref:System.ServiceModel.ConcurrencyMode.Single>.</span><span class="sxs-lookup"><span data-stu-id="3d979-122">If the property is `true`, <xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A> must be equal to <xref:System.ServiceModel.ConcurrencyMode.Single>.</span></span> <span data-ttu-id="3d979-123">In caso contrario, il servizio genera un'eccezione di convalida di configurazione non valida durante l'avvio.</span><span class="sxs-lookup"><span data-stu-id="3d979-123">Otherwise, the service throws an invalid configuration validation exception during startup.</span></span>

- <span data-ttu-id="3d979-124"><xref:System.ServiceModel.ServiceBehaviorAttribute.TransactionIsolationLevel%2A> specifica il livello di isolamento da utilizzare per le transazioni all'interno del servizio. Questa proprietà prende uno dei valori <xref:System.Transactions.IsolationLevel>.</span><span class="sxs-lookup"><span data-stu-id="3d979-124"><xref:System.ServiceModel.ServiceBehaviorAttribute.TransactionIsolationLevel%2A> specifies the isolation level to use for transactions within the service; this property takes one of the <xref:System.Transactions.IsolationLevel> values.</span></span> <span data-ttu-id="3d979-125">Se la proprietà del livello di isolamento locale è diversa da <xref:System.Transactions.IsolationLevel.Unspecified>, il livello di isolamento di una transazione in ingresso deve corrispondere all'impostazione di questa proprietà locale.</span><span class="sxs-lookup"><span data-stu-id="3d979-125">If the local isolation level property is anything other than <xref:System.Transactions.IsolationLevel.Unspecified>, the isolation level of an incoming transaction must match the setting of this local property.</span></span> <span data-ttu-id="3d979-126">In caso contrario, la transazione in ingresso viene rifiutata e al client viene restituito un errore.</span><span class="sxs-lookup"><span data-stu-id="3d979-126">Otherwise, the incoming transaction is rejected, and a fault is sent back to the client.</span></span> <span data-ttu-id="3d979-127">Se <xref:System.ServiceModel.OperationBehaviorAttribute.TransactionScopeRequired%2A> è `true` e non viene propagata nessuna transazione, questa proprietà determina il valore <xref:System.Transactions.IsolationLevel> da utilizzare per la transazione creata localmente.</span><span class="sxs-lookup"><span data-stu-id="3d979-127">If <xref:System.ServiceModel.OperationBehaviorAttribute.TransactionScopeRequired%2A> is `true`, and no transaction is flowed, this property determines the <xref:System.Transactions.IsolationLevel> value to use for the locally created transaction.</span></span> <span data-ttu-id="3d979-128">Se <xref:System.Transactions.IsolationLevel> è impostato su <xref:System.Transactions.IsolationLevel.Unspecified>, viene utilizzato <xref:System.Transactions.IsolationLevel><xref:System.Transactions.IsolationLevel.Serializable>.</span><span class="sxs-lookup"><span data-stu-id="3d979-128">If <xref:System.Transactions.IsolationLevel> is set to <xref:System.Transactions.IsolationLevel.Unspecified>, <xref:System.Transactions.IsolationLevel><xref:System.Transactions.IsolationLevel.Serializable> is used.</span></span>

- <span data-ttu-id="3d979-129"><xref:System.ServiceModel.ServiceBehaviorAttribute.TransactionTimeout%2A> specifica il periodo di tempo entro il quale deve essere completata una nuova transazione creata nel servizio.</span><span class="sxs-lookup"><span data-stu-id="3d979-129"><xref:System.ServiceModel.ServiceBehaviorAttribute.TransactionTimeout%2A> specifies the time period within which a new transaction created at the service must complete.</span></span> <span data-ttu-id="3d979-130">Allo scadere di questo periodo di tempo, se la transazione non è stata completata, si interromperà.</span><span class="sxs-lookup"><span data-stu-id="3d979-130">If this time is reached and the transaction has not been completed, it will abort.</span></span> <span data-ttu-id="3d979-131">Il <xref:System.TimeSpan> viene utilizzato come timeout di <xref:System.Transactions.TransactionScope> per qualsiasi operazione il cui <xref:System.ServiceModel.OperationBehaviorAttribute.TransactionScopeRequired%2A> sia impostato su `true` e per la quale sia stata creata una nuova transazione.</span><span class="sxs-lookup"><span data-stu-id="3d979-131">The <xref:System.TimeSpan> is used as the <xref:System.Transactions.TransactionScope> time-out for any operations that have <xref:System.ServiceModel.OperationBehaviorAttribute.TransactionScopeRequired%2A> set to `true` and for which a new transaction was created.</span></span> <span data-ttu-id="3d979-132">Il timeout è la durata consentita massima dalla creazione della transazione al completamento della fase 1 nel protocollo di commit a due fasi.</span><span class="sxs-lookup"><span data-stu-id="3d979-132">The time-out is the maximum allowed duration from the creation of the transaction to the completion of phase 1 in the two-phase commit protocol.</span></span> <span data-ttu-id="3d979-133">Il valore di timeout utilizzato è sempre il valore inferiore tra la proprietà <xref:System.ServiceModel.ServiceBehaviorAttribute.TransactionTimeout%2A> e l'impostazione della configurazione di `transactionTimeout`.</span><span class="sxs-lookup"><span data-stu-id="3d979-133">The time-out value used is always the lower value between the <xref:System.ServiceModel.ServiceBehaviorAttribute.TransactionTimeout%2A> property and the `transactionTimeout` configuration setting.</span></span>

## <a name="operationbehaviorattribute"></a><span data-ttu-id="3d979-134">OperationBehaviorAttribute</span><span class="sxs-lookup"><span data-stu-id="3d979-134">OperationBehaviorAttribute</span></span>

<span data-ttu-id="3d979-135">L'attributo <xref:System.ServiceModel.OperationBehaviorAttribute> specifica i comportamenti dei metodi nell'implementazione del servizio.</span><span class="sxs-lookup"><span data-stu-id="3d979-135">The <xref:System.ServiceModel.OperationBehaviorAttribute> attribute specifies the behaviors of the methods in the service implementation.</span></span> <span data-ttu-id="3d979-136">È possibile utilizzarlo per indicare il comportamento di esecuzione specifico dell'operazione.</span><span class="sxs-lookup"><span data-stu-id="3d979-136">You can use it to indicate the operation's specific execution behavior.</span></span> <span data-ttu-id="3d979-137">Proprietà di questo attributo non influiscono le descrizione Web Service Description Language (WSDL) del contratto di servizio e sono esclusivamente elementi del modello di programmazione WCF che abilita funzionalità comuni che gli sviluppatori in caso contrario, sono necessario implementare autonomamente.</span><span class="sxs-lookup"><span data-stu-id="3d979-137">Properties of this attribute do not affect the Web Service Description Language (WSDL) description of the service contract, and are purely elements of the WCF programming model that enable common features that developers otherwise have to implement themselves.</span></span>

<span data-ttu-id="3d979-138">Questo attributo ha le seguenti proprietà specifiche per la transazione:</span><span class="sxs-lookup"><span data-stu-id="3d979-138">This attribute has the following transaction-specific properties:</span></span>

- <span data-ttu-id="3d979-139"><xref:System.ServiceModel.OperationBehaviorAttribute.TransactionScopeRequired%2A> specifica se un metodo deve essere eseguito entro l'ambito di una transazione attiva.</span><span class="sxs-lookup"><span data-stu-id="3d979-139"><xref:System.ServiceModel.OperationBehaviorAttribute.TransactionScopeRequired%2A> specifies whether a method must execute within an active transaction scope.</span></span> <span data-ttu-id="3d979-140">Il valore predefinito è `false`.</span><span class="sxs-lookup"><span data-stu-id="3d979-140">The default is `false`.</span></span> <span data-ttu-id="3d979-141">Se per un metodo non è impostato l'attributo <xref:System.ServiceModel.OperationBehaviorAttribute>, il metodo non verrà eseguito in una transazione.</span><span class="sxs-lookup"><span data-stu-id="3d979-141">If the <xref:System.ServiceModel.OperationBehaviorAttribute> attribute is not set for a method, it also implies that the method will not execute in a transaction.</span></span> <span data-ttu-id="3d979-142">Se per un'operazione non è richiesto un ambito della transazione, nessuna transazione presente nell'intestazione del messaggio viene attivata e rimane come elemento di <xref:System.ServiceModel.OperationContext.IncomingMessageProperties%2A> di <xref:System.ServiceModel.OperationContext>.</span><span class="sxs-lookup"><span data-stu-id="3d979-142">If a transaction scope is not required for an operation, any transaction that is present within the message header is not activated and remains as an element of the <xref:System.ServiceModel.OperationContext.IncomingMessageProperties%2A> of the <xref:System.ServiceModel.OperationContext>.</span></span> <span data-ttu-id="3d979-143">Se per un'operazione è richiesto un ambito della transazione, l'origine per la transazione viene derivata da uno degli elementi seguenti:</span><span class="sxs-lookup"><span data-stu-id="3d979-143">If a transaction scope is required for an operation, the source for the transaction is derived from one of the following:</span></span>

  - <span data-ttu-id="3d979-144">Se una transazione viene propagata dal client, il metodo viene eseguito nell'ambito di una transazione creato utilizzando quella transazione distribuita.</span><span class="sxs-lookup"><span data-stu-id="3d979-144">If a transaction is flowed from the client, the method is executed under a transaction scope created using that distributed transaction.</span></span>

  - <span data-ttu-id="3d979-145">Con un trasporto in coda, viene utilizzata la transazione utilizzata per annullare l'accodamento del messaggio.</span><span class="sxs-lookup"><span data-stu-id="3d979-145">With a queued transport, the transaction used to dequeue the message is used.</span></span> <span data-ttu-id="3d979-146">Si noti che la transazione utilizzata non è una transazione propagata, in quanto non è stata fornita dal mittente originale del messaggio.</span><span class="sxs-lookup"><span data-stu-id="3d979-146">Note that the transaction used is not a flowed transaction, in that it was not provided by the original sender of the message.</span></span>

  - <span data-ttu-id="3d979-147">Un trasporto personalizzato può fornire una transazione tramite l'utilizzo di `TransportTransactionProperty`.</span><span class="sxs-lookup"><span data-stu-id="3d979-147">A custom transport can provide a transaction through the use of the `TransportTransactionProperty`.</span></span>

  - <span data-ttu-id="3d979-148">Se in nessuno dei casi precedenti viene fornita un'origine esterna per una transazione, subito prima di chiamare il metodo viene creata una nuova istanza <xref:System.Transactions.Transaction>.</span><span class="sxs-lookup"><span data-stu-id="3d979-148">If none of the above provides an external source for a transaction, a new <xref:System.Transactions.Transaction> instance is created immediately prior to calling the method.</span></span>

- <span data-ttu-id="3d979-149"><xref:System.ServiceModel.OperationBehaviorAttribute.TransactionAutoComplete%2A> specifica se la transazione in cui viene eseguito il metodo viene completata automaticamente nel caso in cui non venga generata alcuna eccezione non gestita.</span><span class="sxs-lookup"><span data-stu-id="3d979-149"><xref:System.ServiceModel.OperationBehaviorAttribute.TransactionAutoComplete%2A> specifies whether the transaction in which the method executes is automatically completed if no unhandled exceptions are thrown.</span></span> <span data-ttu-id="3d979-150">Se questa proprietà è `true`, l'infrastruttura chiamante contrassegna automaticamente la transazione come "completata" se il metodo dell'utente viene restituito senza generare un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="3d979-150">If this property is `true`, the calling infrastructure automatically marks the transaction as "completed" if the user method returns without throwing an exception.</span></span> <span data-ttu-id="3d979-151">Se questa proprietà è `false`, la transazione viene allegata all'istanza e viene contrassegnata come "completata" solo se il client chiama un metodo successivo contrassegnato con questa proprietà uguale con `true` o se un metodo successivo chiama in modo esplicito <xref:System.ServiceModel.OperationContext.SetTransactionComplete%2A>.</span><span class="sxs-lookup"><span data-stu-id="3d979-151">If this property is `false`, the transaction is attached to the instance, and is only marked as "completed" if the client calls a subsequent method that is marked with this property equal to `true`, or if a subsequent method explicitly calls <xref:System.ServiceModel.OperationContext.SetTransactionComplete%2A>.</span></span> <span data-ttu-id="3d979-152">Se non si verifica nessuno dei casi precedenti, la transazione non verrà mai "completata" e non verrà eseguito il commit del lavoro, a meno che la proprietà <xref:System.ServiceModel.ServiceBehaviorAttribute.TransactionAutoCompleteOnSessionClose%2A> non sia impostata su `true`.</span><span class="sxs-lookup"><span data-stu-id="3d979-152">Failure to perform either of these results in the transaction never being "completed," and the contained work is not committed, unless the <xref:System.ServiceModel.ServiceBehaviorAttribute.TransactionAutoCompleteOnSessionClose%2A> property is set to `true`.</span></span> <span data-ttu-id="3d979-153">Se questa proprietà è impostata su `true`, è necessario utilizzare un canale con una sessione e <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A> deve essere impostato su <xref:System.ServiceModel.InstanceContextMode.PerSession>.</span><span class="sxs-lookup"><span data-stu-id="3d979-153">If this property is set to `true`, you must use a channel with a session, and the <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A> must be set to <xref:System.ServiceModel.InstanceContextMode.PerSession>.</span></span>
