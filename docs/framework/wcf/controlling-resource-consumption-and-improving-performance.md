---
title: Controllo dell'utilizzo di risorse e miglioramento delle prestazioni
ms.date: 03/30/2017
ms.assetid: 9a829669-5f76-4c88-80ec-92d0c62c0660
ms.openlocfilehash: 16d6f29235455ff30e115b7aff3425412bc7ba6a
ms.sourcegitcommit: 32a575bf4adccc901f00e264f92b759ced633379
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 12/04/2019
ms.locfileid: "74802253"
---
# <a name="controlling-resource-consumption-and-improving-performance"></a><span data-ttu-id="5f33c-102">Controllo dell'utilizzo di risorse e miglioramento delle prestazioni</span><span class="sxs-lookup"><span data-stu-id="5f33c-102">Controlling Resource Consumption and Improving Performance</span></span>
<span data-ttu-id="5f33c-103">In questo argomento vengono descritte le diverse proprietà in aree diverse dell'architettura Windows Communication Foundation (WCF) che consentono di controllare l'utilizzo delle risorse e di influenzare le metriche delle prestazioni.</span><span class="sxs-lookup"><span data-stu-id="5f33c-103">This topic describes various properties in different areas of the Windows Communication Foundation (WCF) architecture that work to control resource consumption and affect performance metrics.</span></span>

## <a name="properties-that-constrain-resource-consumption-in-wcf"></a><span data-ttu-id="5f33c-104">Proprietà che limitano l'utilizzo di risorse in WCF</span><span class="sxs-lookup"><span data-stu-id="5f33c-104">Properties that Constrain Resource Consumption in WCF</span></span>
 <span data-ttu-id="5f33c-105">Windows Communication Foundation (WCF) applica vincoli a determinati tipi di processi a scopo di sicurezza o di prestazioni.</span><span class="sxs-lookup"><span data-stu-id="5f33c-105">Windows Communication Foundation (WCF) applies constraints on certain types of processes for either security or performance purposes.</span></span> <span data-ttu-id="5f33c-106">I vincoli si presentano in due forme principali: quote e velocità.</span><span class="sxs-lookup"><span data-stu-id="5f33c-106">These constraints come in two main forms, either quotas and throttles.</span></span> <span data-ttu-id="5f33c-107">Le *quote* sono limiti che, quando raggiunto o superato, attivano un'eccezione immediata in un determinato punto del sistema.</span><span class="sxs-lookup"><span data-stu-id="5f33c-107">*Quotas* are limits that when reached or exceeded trigger an immediate exception at some point in the system.</span></span> <span data-ttu-id="5f33c-108">Le *limitazioni sono limiti* che non generano immediatamente un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="5f33c-108">*Throttles* are limits that do not immediately cause an exception to be thrown.</span></span> <span data-ttu-id="5f33c-109">Quando viene raggiunto un limite di velocità, invece, l'elaborazione continua rimanendo nei limiti impostati dal valore della velocità.</span><span class="sxs-lookup"><span data-stu-id="5f33c-109">Instead, when a throttle limit is reached, processing continues but within the limits set by that throttle value.</span></span> <span data-ttu-id="5f33c-110">Questa elaborazione limitata potrebbe generare un'eccezione in un altro punto, ma questo dipende dall'applicazione.</span><span class="sxs-lookup"><span data-stu-id="5f33c-110">This limited processing might trigger an exception elsewhere, but this depends upon the application.</span></span>

 <span data-ttu-id="5f33c-111">Oltre alla distinzione tra quote e velocità, alcune proprietà di limitazione si trovano al livello della serializzazione, alcune al livello del trasporto e alcune al livello dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="5f33c-111">In addition to the distinction between quotas and throttles, some constraining properties are located at the serialization level, some at the transport level, and some at the application level.</span></span> <span data-ttu-id="5f33c-112">La proprietà <xref:System.ServiceModel.Channels.TransportBindingElement.MaxReceivedMessageSize%2A?displayProperty=nameWithType> della quota, ad esempio, implementata da tutti gli elementi dell'associazione del trasporto forniti dal sistema, è pari a 65.536 byte per impostazione predefinita per impedire a client dannosi di effettuare attacchi Denial of Service contro un servizio provocando un consumo di memoria eccessivo.</span><span class="sxs-lookup"><span data-stu-id="5f33c-112">For example, the quota <xref:System.ServiceModel.Channels.TransportBindingElement.MaxReceivedMessageSize%2A?displayProperty=nameWithType>, which is implemented by all system-supplied transport binding elements, is set to 65,536 bytes by default to hinder malicious clients from engaging in denial-of-service attacks against a service by causing excessive memory consumption.</span></span> <span data-ttu-id="5f33c-113">È in genere possibile migliorare le prestazioni abbassando questo valore.</span><span class="sxs-lookup"><span data-stu-id="5f33c-113">(Typically, you can increase performance by lowering this value.)</span></span>

 <span data-ttu-id="5f33c-114">Un esempio di quota di serializzazione è la proprietà <xref:System.Runtime.Serialization.DataContractSerializer.MaxItemsInObjectGraph%2A?displayProperty=nameWithType>, che specifica il numero massimo di oggetti serializzati o deserializzati dal serializzatore in una sola chiamata al metodo <xref:System.Runtime.Serialization.DataContractSerializer.ReadObject%2A>.</span><span class="sxs-lookup"><span data-stu-id="5f33c-114">An example of a serialization quota is the <xref:System.Runtime.Serialization.DataContractSerializer.MaxItemsInObjectGraph%2A?displayProperty=nameWithType> property, which specifies the maximum number of objects that the serializer serializes or deserializes in a single <xref:System.Runtime.Serialization.DataContractSerializer.ReadObject%2A> method call.</span></span> <span data-ttu-id="5f33c-115">Un esempio di limite a livello di applicazione è la proprietà <xref:System.ServiceModel.Dispatcher.ServiceThrottle.MaxConcurrentSessions%2A?displayProperty=nameWithType> che per impostazione predefinita limita a 10 il numero di connessioni simultanee del canale con sessione.</span><span class="sxs-lookup"><span data-stu-id="5f33c-115">An example of an application-level throttle is the <xref:System.ServiceModel.Dispatcher.ServiceThrottle.MaxConcurrentSessions%2A?displayProperty=nameWithType> property, which by default restricts the number of concurrent sessionful channel connections to 10.</span></span> <span data-ttu-id="5f33c-116">A differenza delle quote, se viene raggiunto questo valore limite, l'applicazione continua l'elaborazione ma non accetta nuovi canali con sessione. Non è quindi possibile connettere nuovi client fino a quando uno degli altri canali con sessione non è stato terminato.</span><span class="sxs-lookup"><span data-stu-id="5f33c-116">(Unlike the quotas, if this throttle value is reached, the application continues processing but accepts no new sessionful channels, which means that new clients cannot connect until one of the other sessionful channels is ended.)</span></span>

 <span data-ttu-id="5f33c-117">Questi controlli sono stati progettati per fornire una mitigazione automatica di alcuni tipi di attacchi o per migliorare la misurazione delle prestazioni, ad esempio footprint di memoria, ora di avvio e così via.</span><span class="sxs-lookup"><span data-stu-id="5f33c-117">These controls are designed to provide an out-of-the-box mitigation against certain types of attacks or to improve performance metrics such as memory footprint, start-up time, and so on.</span></span> <span data-ttu-id="5f33c-118">A seconda dell'applicazione, tuttavia, questi controlli possono limitare le prestazioni dell'applicazione di servizio o ostacolare del tutto il funzionamento dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="5f33c-118">However, depending on the application, these controls can impede service application performance or prevent the application from working at all.</span></span> <span data-ttu-id="5f33c-119">Un'applicazione progettata per trasmettere video, ad esempio, può facilmente superare il valore della proprietà <xref:System.ServiceModel.Channels.TransportBindingElement.MaxReceivedMessageSize%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="5f33c-119">For example, an application designed to stream video can easily exceed the default <xref:System.ServiceModel.Channels.TransportBindingElement.MaxReceivedMessageSize%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="5f33c-120">In questo argomento viene fornita una panoramica dei vari controlli applicati alle applicazioni a tutti i livelli di WCF, vengono descritti i vari modi per ottenere ulteriori informazioni sulla presenza di un'impostazione che ostacola l'applicazione e vengono descritti i modi per correggere diversi problemi.</span><span class="sxs-lookup"><span data-stu-id="5f33c-120">This topic provides an overview of the various controls applied to applications at all levels of WCF, describes various ways to obtain more information about whether a setting is hindering your application, and describes ways to correct various problems.</span></span> <span data-ttu-id="5f33c-121">Molte velocità e alcune quote sono disponibili a livello di applicazione, anche quando la proprietà di base è un limite per la serializzazione o il trasporto.</span><span class="sxs-lookup"><span data-stu-id="5f33c-121">Most throttles and some quotas are available at the application level, even when the base property is a serialization or transport constraint.</span></span> <span data-ttu-id="5f33c-122">È ad esempio possibile impostare la proprietà <xref:System.Runtime.Serialization.DataContractSerializer.MaxItemsInObjectGraph%2A?displayProperty=nameWithType> utilizzando la proprietà <xref:System.ServiceModel.ServiceBehaviorAttribute.MaxItemsInObjectGraph%2A?displayProperty=nameWithType> nella classe del servizio.</span><span class="sxs-lookup"><span data-stu-id="5f33c-122">For example, you can set the <xref:System.Runtime.Serialization.DataContractSerializer.MaxItemsInObjectGraph%2A?displayProperty=nameWithType> property using the <xref:System.ServiceModel.ServiceBehaviorAttribute.MaxItemsInObjectGraph%2A?displayProperty=nameWithType> property on the service class.</span></span>

> [!NOTE]
> <span data-ttu-id="5f33c-123">In caso di problemi specifici, è consigliabile leggere prima la [Guida introduttiva alla risoluzione dei problemi di WCF](wcf-troubleshooting-quickstart.md) per verificare se il problema (e una soluzione) è elencato in questa pagina.</span><span class="sxs-lookup"><span data-stu-id="5f33c-123">If you have a particular problem, you should first read the [WCF Troubleshooting Quickstart](wcf-troubleshooting-quickstart.md) to see whether your problem (and a solution) is listed there.</span></span>

 <span data-ttu-id="5f33c-124">Le proprietà che limitano i processi di serializzazione sono elencate in [considerazioni sulla sicurezza per i dati](./feature-details/security-considerations-for-data.md).</span><span class="sxs-lookup"><span data-stu-id="5f33c-124">Properties that restrict serialization processes are listed in [Security Considerations for Data](./feature-details/security-considerations-for-data.md).</span></span> <span data-ttu-id="5f33c-125">Le proprietà che limitano l'utilizzo di risorse correlate ai trasporti sono elencate in [quote di trasporto](./feature-details/transport-quotas.md).</span><span class="sxs-lookup"><span data-stu-id="5f33c-125">Properties that restrict the consumption of resources related to transports are listed in [Transport Quotas](./feature-details/transport-quotas.md).</span></span> <span data-ttu-id="5f33c-126">Le proprietà che limitano l'utilizzo di risorse a livello di applicazione sono membri della classe <xref:System.ServiceModel.Dispatcher.ServiceThrottle>.</span><span class="sxs-lookup"><span data-stu-id="5f33c-126">Properties that restrict the consumption of resources at the application layer are the members of the <xref:System.ServiceModel.Dispatcher.ServiceThrottle> class.</span></span>

## <a name="detecting-application-and-performance-issues-related-to-quota-settings"></a><span data-ttu-id="5f33c-127">Rilevazione di problemi in applicazioni e prestazioni relativi alle impostazioni delle quote</span><span class="sxs-lookup"><span data-stu-id="5f33c-127">Detecting Application and Performance Issues Related to Quota Settings</span></span>
 <span data-ttu-id="5f33c-128">Le impostazioni predefinite dei valori precedenti sono state scelte per abilitare le funzionalità di base dell'applicazione in un'ampia gamma di tipi di applicazioni pur fornendo una protezione di base nei confronti di problemi di sicurezza comuni.</span><span class="sxs-lookup"><span data-stu-id="5f33c-128">The defaults of the preceding values have been chosen to enable basic application functionality across a wide range of application types while providing basic protection against common security issues.</span></span> <span data-ttu-id="5f33c-129">Concezioni diverse delle applicazioni possono, tuttavia, superare una o più impostazioni della velocità sebbene l'applicazione sia per altri versi protetta e il suo funzionamento sia quello previsto.</span><span class="sxs-lookup"><span data-stu-id="5f33c-129">However, different application designs might exceed one or more throttle settings although the application otherwise is secure and would work as designed.</span></span> <span data-ttu-id="5f33c-130">In questi casi è necessario identificare il valore di velocità superato e il livello al quale si è verificato il superamento e decidere l'intervento appropriato per aumentare la velocità effettiva dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="5f33c-130">In these cases, you must identify which throttle values are being exceeded and at what level, and decide on the appropriate course of action to increase application throughput.</span></span>

 <span data-ttu-id="5f33c-131">In genere, durante la scrittura dell'applicazione e l'esecuzione del debug, la proprietà <xref:System.ServiceModel.Description.ServiceDebugBehavior.IncludeExceptionDetailInFaults%2A?displayProperty=nameWithType> viene impostata su `true` nel file di configurazione o a livello di programmazione.</span><span class="sxs-lookup"><span data-stu-id="5f33c-131">Typically, when writing the application and debugging it, you set the <xref:System.ServiceModel.Description.ServiceDebugBehavior.IncludeExceptionDetailInFaults%2A?displayProperty=nameWithType> property to `true` in the configuration file or programmatically.</span></span> <span data-ttu-id="5f33c-132">Indica a WCF di restituire le analisi dello stack di eccezioni del servizio all'applicazione client per la visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="5f33c-132">This instructs WCF to return service exception stack traces to the client application for viewing.</span></span> <span data-ttu-id="5f33c-133">Questa funzionalità consente di segnalare la maggior parte delle eccezioni a livello di applicazione in modo da visualizzare le impostazioni delle quote interessate, se questo è il problema.</span><span class="sxs-lookup"><span data-stu-id="5f33c-133">This feature reports most application-level exceptions in such a way as to display which quota settings might be involved, if that is the problem.</span></span>

 <span data-ttu-id="5f33c-134">Alcune eccezioni si verificano in fase di esecuzione e non sono visibili al livello dell'applicazione, quindi non vengono restituite con questo meccanismo e potrebbero non essere gestite da un'implementazione <xref:System.ServiceModel.Dispatcher.IErrorHandler?displayProperty=nameWithType> personalizzata.</span><span class="sxs-lookup"><span data-stu-id="5f33c-134">Some exceptions happen at run time below the visibility of the application layer and are not returned using this mechanism, and they might not be handled by a custom <xref:System.ServiceModel.Dispatcher.IErrorHandler?displayProperty=nameWithType> implementation.</span></span> <span data-ttu-id="5f33c-135">In un ambiente di sviluppo quale Microsoft Visual Studio la maggior parte di queste eccezioni viene visualizzata automaticamente.</span><span class="sxs-lookup"><span data-stu-id="5f33c-135">If you are in a development environment like Microsoft Visual Studio, most of these exceptions are displayed automatically.</span></span> <span data-ttu-id="5f33c-136">Tuttavia, alcune eccezioni possono essere mascherate da impostazioni dell'ambiente di sviluppo, ad esempio [Just My Code](/visualstudio/debugger/just-my-code) Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="5f33c-136">However, some exceptions can be masked by development environment settings such as [Just My Code](/visualstudio/debugger/just-my-code) Visual Studio.</span></span>

 <span data-ttu-id="5f33c-137">Indipendentemente dalle funzionalità dell'ambiente di sviluppo, è possibile utilizzare le funzionalità di traccia e registrazione dei messaggi di WCF per eseguire il debug di tutte le eccezioni e ottimizzare le prestazioni delle applicazioni.</span><span class="sxs-lookup"><span data-stu-id="5f33c-137">Regardless of the capabilities of your development environment, you can use capabilities of WCF tracing and message logging to debug all exceptions and tune the performance of your applications.</span></span> <span data-ttu-id="5f33c-138">Per altre informazioni, vedere [uso della traccia per risolvere i problemi dell'applicazione](./diagnostics/tracing/using-tracing-to-troubleshoot-your-application.md).</span><span class="sxs-lookup"><span data-stu-id="5f33c-138">For more information, see [Using Tracing to Troubleshoot Your Application](./diagnostics/tracing/using-tracing-to-troubleshoot-your-application.md).</span></span>

## <a name="performance-issues-and-xmlserializer"></a><span data-ttu-id="5f33c-139">Problemi di prestazioni e XmlSerializer</span><span class="sxs-lookup"><span data-stu-id="5f33c-139">Performance Issues and XmlSerializer</span></span>
 <span data-ttu-id="5f33c-140">I servizi e le applicazioni client che utilizzano tipi di dati serializzabili tramite <xref:System.Xml.Serialization.XmlSerializer> generano e compilano il codice di serializzazione per tali dati in fase di esecuzione, il che può rallentare le prestazioni all'avvio.</span><span class="sxs-lookup"><span data-stu-id="5f33c-140">Services and client applications that use data types that are serializable using the <xref:System.Xml.Serialization.XmlSerializer> generate and compile serialization code for those data types at run time, which can result in slow start-up performance.</span></span>

> [!NOTE]
> <span data-ttu-id="5f33c-141">Un codice di serializzazione pregenerato può essere utilizzato solamente nelle applicazioni client e non nei servizi.</span><span class="sxs-lookup"><span data-stu-id="5f33c-141">Pre-generated serialization code can be used only in client applications and not in services.</span></span>

 <span data-ttu-id="5f33c-142">Lo [strumento ServiceModel Metadata Utility Tool (Svcutil. exe)](servicemodel-metadata-utility-tool-svcutil-exe.md) può migliorare le prestazioni di avvio per queste applicazioni generando il codice di serializzazione necessario dagli assembly compilati per l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="5f33c-142">The [ServiceModel Metadata Utility Tool (Svcutil.exe)](servicemodel-metadata-utility-tool-svcutil-exe.md) can improve start-up performance for these applications by generating the necessary serialization code from the compiled assemblies for the application.</span></span> <span data-ttu-id="5f33c-143">Per ulteriori informazioni, vedere [procedura: migliorare il tempo di avvio delle applicazioni client WCF utilizzando XmlSerializer](./feature-details/startup-time-of-wcf-client-applications-using-the-xmlserializer.md).</span><span class="sxs-lookup"><span data-stu-id="5f33c-143">For more information, see [How to: Improve the Startup Time of WCF Client Applications using the XmlSerializer](./feature-details/startup-time-of-wcf-client-applications-using-the-xmlserializer.md).</span></span>

## <a name="performance-issues-when-hosting-wcf-services-under-aspnet"></a><span data-ttu-id="5f33c-144">Problemi di prestazioni quando ASP.NET ospita servizi WCF</span><span class="sxs-lookup"><span data-stu-id="5f33c-144">Performance Issues When Hosting WCF Services Under ASP.NET</span></span>

<span data-ttu-id="5f33c-145">Quando un servizio WCF viene ospitato da IIS e ASP.NET, le impostazioni di configurazione di IIS e ASP.NET possono influire sulla velocità effettiva e sul footprint di memoria del servizio WCF.</span><span class="sxs-lookup"><span data-stu-id="5f33c-145">When a WCF service is hosted under IIS and ASP.NET, the configuration settings of IIS and ASP.NET can affect the throughput and memory footprint of the WCF service.</span></span>  <span data-ttu-id="5f33c-146">Per altre informazioni sulle prestazioni di ASP.NET, vedere [miglioramento delle prestazioni di ASP.NET](https://docs.microsoft.com/previous-versions/msp-n-p/ff647787(v=pandp.10)).</span><span class="sxs-lookup"><span data-stu-id="5f33c-146">For more information about ASP.NET performance, see [Improving ASP.NET Performance](https://docs.microsoft.com/previous-versions/msp-n-p/ff647787(v=pandp.10)).</span></span> <span data-ttu-id="5f33c-147">Un'impostazione che potrebbe avere conseguenze impreviste è <xref:System.Web.Configuration.ProcessModelSection.MinWorkerThreads%2A>, che è una proprietà di <xref:System.Web.Configuration.ProcessModelSection>.</span><span class="sxs-lookup"><span data-stu-id="5f33c-147">One setting that might have unintended consequences is <xref:System.Web.Configuration.ProcessModelSection.MinWorkerThreads%2A>, which is a property of the <xref:System.Web.Configuration.ProcessModelSection>.</span></span> <span data-ttu-id="5f33c-148">Se l'applicazione dispone di un numero fisso o piccolo di client, l'impostazione di <xref:System.Web.Configuration.ProcessModelSection.MinWorkerThreads%2A> su 2 potrebbe fornire una spinta di velocità effettiva in un computer con multiprocessore con un utilizzo della CPU vicino al 100%.</span><span class="sxs-lookup"><span data-stu-id="5f33c-148">If your application has a fixed or small number of clients, setting <xref:System.Web.Configuration.ProcessModelSection.MinWorkerThreads%2A> to 2 might provide a throughput boost on a multiprocessor machine that has a CPU utilization close to 100%.</span></span> <span data-ttu-id="5f33c-149">Questo aumento nelle prestazioni ha comunque un costo: determinerà anche un aumento dell'utilizzo della memoria, con conseguente riduzione della scalabilità.</span><span class="sxs-lookup"><span data-stu-id="5f33c-149">This increase in performance comes with a cost: it will also cause an increase in memory usage, which could reduce scalability.</span></span>

## <a name="see-also"></a><span data-ttu-id="5f33c-150">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="5f33c-150">See also</span></span>

- [<span data-ttu-id="5f33c-151">Amministrazione e diagnostica</span><span class="sxs-lookup"><span data-stu-id="5f33c-151">Administration and Diagnostics</span></span>](./diagnostics/index.md)
- [<span data-ttu-id="5f33c-152">Dati di grandi dimensioni e streaming</span><span class="sxs-lookup"><span data-stu-id="5f33c-152">Large Data and Streaming</span></span>](./feature-details/large-data-and-streaming.md)
