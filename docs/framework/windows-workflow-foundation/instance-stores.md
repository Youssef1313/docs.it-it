---
title: Archivio di istanze
ms.date: 03/30/2017
ms.assetid: f2629668-0923-4987-b943-67477131c1e0
ms.openlocfilehash: 69b50942c36406bd29147d243e0501b8048d56dc
ms.sourcegitcommit: 32a575bf4adccc901f00e264f92b759ced633379
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 12/04/2019
ms.locfileid: "74802557"
---
# <a name="instance-stores"></a><span data-ttu-id="3b40e-102">Archivio di istanze</span><span class="sxs-lookup"><span data-stu-id="3b40e-102">Instance Stores</span></span>
<span data-ttu-id="3b40e-103">Un archivio di istanze è un contenitore logico di istanze,</span><span class="sxs-lookup"><span data-stu-id="3b40e-103">An instance store is a logical container of instances.</span></span> <span data-ttu-id="3b40e-104">ovvero lo spazio in cui vengono archiviati i dati e i metadati dell'istanza.</span><span class="sxs-lookup"><span data-stu-id="3b40e-104">It is the place where the instance data and metadata is stored.</span></span> <span data-ttu-id="3b40e-105">Un archivio di istanze non implica l'archiviazione fisica dedicata</span><span class="sxs-lookup"><span data-stu-id="3b40e-105">An instance store does not imply dedicated physical storage.</span></span> <span data-ttu-id="3b40e-106">e può contenere informazioni durevoli in un database di SQL Server o informazioni sullo stato non durevoli in una memoria.</span><span class="sxs-lookup"><span data-stu-id="3b40e-106">An instance store could contain durable information in a SQL Server database or non-durable state information in a memory.</span></span> <span data-ttu-id="3b40e-107">In [!INCLUDE[netfx_current_long](../../../includes/netfx-current-long-md.md)] è disponibile l'archivio di istanze del flusso di lavoro SQL, vale a dire un'implementazione concreta di un archivio di istanze che consente ai flussi di lavoro di rendere persistenti i dati e i metadati dell'istanza in un database di SQL Server 2005 o di SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="3b40e-107">The [!INCLUDE[netfx_current_long](../../../includes/netfx-current-long-md.md)] ships with the SQL Workflow Instance Store, which is a concrete implementation of an instance store that allows workflows to persist instance data and metadata into a SQL Server 2005 or SQL Server 2008 database.</span></span> <span data-ttu-id="3b40e-108">Windows Server AppFabric fornisce inoltre un'implementazione concreta di un archivio di istanze.</span><span class="sxs-lookup"><span data-stu-id="3b40e-108">In addition Windows Server App Fabric also provides a concrete implementation of an instance store.</span></span> <span data-ttu-id="3b40e-109">Per ulteriori informazioni, vedere l' [Archivio di istanze di Windows Server AppFabric, i provider di query e di controllo](https://docs.microsoft.com/previous-versions/appfabric/ff383417(v=azure.10)).</span><span class="sxs-lookup"><span data-stu-id="3b40e-109">For more information, see [Windows Server App Fabric Instance Store, Query, and Control Providers](https://docs.microsoft.com/previous-versions/appfabric/ff383417(v=azure.10)).</span></span>  
  
 <span data-ttu-id="3b40e-110">L'API di persistenza è l'interfaccia tra un host e un archivio di istanze che consente all'host di inviare richieste di comando (ad esempio <xref:System.Activities.DurableInstancing.LoadWorkflowCommand> e <xref:System.Activities.DurableInstancing.SaveWorkflowCommand>) all'archivio di istanze.</span><span class="sxs-lookup"><span data-stu-id="3b40e-110">The persistence API is the interface between a host and an instance store that allows the host to send command requests (for example, <xref:System.Activities.DurableInstancing.LoadWorkflowCommand> and <xref:System.Activities.DurableInstancing.SaveWorkflowCommand>) to the instance store.</span></span> <span data-ttu-id="3b40e-111">L'implementazione concreta di questa API viene definita provider di persistenza.</span><span class="sxs-lookup"><span data-stu-id="3b40e-111">The concrete implementation of this API is called a persistence provider.</span></span> <span data-ttu-id="3b40e-112">Il provider di persistenza riceve richieste da un host e modifica l'archivio di istanze.</span><span class="sxs-lookup"><span data-stu-id="3b40e-112">The persistence provider receives requests from a host and modifies the instance store.</span></span>  
  
 <span data-ttu-id="3b40e-113">Gli host e gli archivi di istanze sono modulari in modo che un host possa essere usato con molti archivi di istanze e un archivio di istanze possa essere usato con molti host.</span><span class="sxs-lookup"><span data-stu-id="3b40e-113">Hosts and instance stores are pluggable so that a host can be used with many instance stores, and an instance store can be used with many hosts.</span></span> <span data-ttu-id="3b40e-114">Un archivio di istanze viene ottimizzato in genere per i modelli di utilizzo di un particolare host, anche se l'archivio di istanze e l'host possono evolvere in cicli di vita indipendenti.</span><span class="sxs-lookup"><span data-stu-id="3b40e-114">An instance store is typically optimized for the usage patterns of a particular host, although the instance store and host may evolve on independent life cycles.</span></span> <span data-ttu-id="3b40e-115">Ad esempio, **WorkflowServiceHost** e **SqlWorkflowInstanceStore** sono progettati per funzionare correttamente insieme.</span><span class="sxs-lookup"><span data-stu-id="3b40e-115">For example, the **WorkflowServiceHost** and the **SqlWorkflowInstanceStore** are designed to work well together.</span></span> <span data-ttu-id="3b40e-116">È possibile creare un archivio di istanze personalizzato per salvare in modo permanente i dati e i metadati delle istanze del servizio flusso di lavoro e usare tale archivio di istanze con **WorkflowServiceHost**.</span><span class="sxs-lookup"><span data-stu-id="3b40e-116">You can create your own instance store to persist data and metadata of workflow service instances and use that instance store with the **WorkflowServiceHost**.</span></span> <span data-ttu-id="3b40e-117">È possibile creare ad esempio un oggetto OracleWorkflowInstanceStore che consenta ai flussi di lavoro di rendere persistenti le informazioni in un database Oracle anziché salvarle in un database di SQL Server.</span><span class="sxs-lookup"><span data-stu-id="3b40e-117">For example, you can create an OracleWorkflowInstanceStore that lets workflows persist information into an Oracle database instead of saving them into a SQL Server database.</span></span>  
  
 <span data-ttu-id="3b40e-118">In genere gli host possono essere estesi con funzionalità aggiuntiva che modifica gli oggetti persistenti.</span><span class="sxs-lookup"><span data-stu-id="3b40e-118">It is common for hosts to be extended with additional functionality that modifies the persisted objects.</span></span> <span data-ttu-id="3b40e-119">Un sistema di persistenza dell'istanza, ad esempio, può avere un host del flusso di lavoro, un'estensione che supporta l'operazione "suspend" e un archivio di istanze SQL.</span><span class="sxs-lookup"><span data-stu-id="3b40e-119">For example, an instance persistence system may have a workflow host, an extension that supports the "Suspend" operation, and an SQL instance store.</span></span>  <span data-ttu-id="3b40e-120">L'host del flusso di lavoro potrebbe inviare un comando standard quale Salva o Carica per salvare o caricare un flusso di lavoro da un archivio di istanze o per salvare un flusso di lavoro in un archivio di istanze.</span><span class="sxs-lookup"><span data-stu-id="3b40e-120">The workflow host might send a standard command such as Save or Load to save or load a workflow from an instance store or to save a workflow into an instance store.</span></span> <span data-ttu-id="3b40e-121">L'estensione di sospensione potrebbe aggiungere ulteriore semantica ai comandi per il salvataggio e il caricamento di istanze del flusso di lavoro in modo che un'istanza del flusso di lavoro sospesa non possa essere caricata.</span><span class="sxs-lookup"><span data-stu-id="3b40e-121">The suspend extension might add additional semantics to the commands for saving and loading workflow instances so that a suspended workflow instance cannot be loaded.</span></span> <span data-ttu-id="3b40e-122">Il provider di persistenza per l'archivio di istanze SQL riconosce i comandi per il salvataggio e il caricamento di istanze del flusso di lavoro e li implementa chiamando stored procedure appropriate che modificano le tabelle degli oggetti persistenti in un database di SQL Server.</span><span class="sxs-lookup"><span data-stu-id="3b40e-122">The persistence provider for the SQL instance store understands the commands for saving and loading workflow instances, and implements the commands by calling appropriate stored procedures that change the tables of persistent objects in an SQL Server database.</span></span>  
  
 <span data-ttu-id="3b40e-123">Un host funge da proprietario di istanza all'interno di un archivio di istanze</span><span class="sxs-lookup"><span data-stu-id="3b40e-123">A host acts as an instance owner within an instance store.</span></span> <span data-ttu-id="3b40e-124">e può operare come più proprietari di istanza con più archivi di istanze contemporaneamente.</span><span class="sxs-lookup"><span data-stu-id="3b40e-124">A host may act as more than one instance owner with more than one instance store at the same time.</span></span> <span data-ttu-id="3b40e-125">L'host fornisce i GUID per chiavi di istanza associate alle istanze.</span><span class="sxs-lookup"><span data-stu-id="3b40e-125">The host provides GUIDs for instance keys associated with the instances.</span></span> <span data-ttu-id="3b40e-126">Una chiave di istanza è un alias univoco che identifica un'istanza.</span><span class="sxs-lookup"><span data-stu-id="3b40e-126">An instance key is a unique alias that identifies an instance.</span></span> <span data-ttu-id="3b40e-127">Il sistema di persistenza crea, aggiorna ed elimina le informazioni del proprietario di istanza quando esegue i comandi richiesti dagli host.</span><span class="sxs-lookup"><span data-stu-id="3b40e-127">The persistence system creates, updates, and deletes instance owner information as it executes commands requested by hosts.</span></span>  
  
 <span data-ttu-id="3b40e-128">Nell'elenco seguente sono indicati i passaggi importanti relativi all'interazione dell'host con l'archivio di istanze:</span><span class="sxs-lookup"><span data-stu-id="3b40e-128">The following list contains the important steps involved in the host’s interaction with the instance store:</span></span>  
  
1. <span data-ttu-id="3b40e-129">Ottenere un **InstanceStore** da un provider di persistenza.</span><span class="sxs-lookup"><span data-stu-id="3b40e-129">Obtain an **InstanceStore** from a persistence provider.</span></span>  

2. <span data-ttu-id="3b40e-130">Ottenere l'handle per un'istanza chiamando il metodo <xref:System.Runtime.DurableInstancing.InstanceStore.CreateInstanceHandle%2A> su **InstanceStore**.</span><span class="sxs-lookup"><span data-stu-id="3b40e-130">Obtain the handle to an instance by calling the <xref:System.Runtime.DurableInstancing.InstanceStore.CreateInstanceHandle%2A> method on the **InstanceStore**.</span></span>  
  
3. <span data-ttu-id="3b40e-131">Richiamare i comandi sull'handle di istanza chiamando il metodo <xref:System.Runtime.DurableInstancing.InstanceStore.Execute%2A> su **InstanceStore**.</span><span class="sxs-lookup"><span data-stu-id="3b40e-131">Invoke commands against the instance handle by calling the <xref:System.Runtime.DurableInstancing.InstanceStore.Execute%2A> method on the **InstanceStore**.</span></span>  
  
4. <span data-ttu-id="3b40e-132">Esaminare la <xref:System.Runtime.DurableInstancing.InstanceView> restituita da **InstanceStore. Execute** per determinare i risultati dei comandi.</span><span class="sxs-lookup"><span data-stu-id="3b40e-132">Examine the <xref:System.Runtime.DurableInstancing.InstanceView> returned by **InstanceStore.Execute** to determine the results of the commands.</span></span>
