---
title: Metadati delle proprietà di dipendenza
ms.date: 03/30/2017
helpviewer_keywords:
- APIs [WPF], metadata
- dependency properties [WPF], metadata
- metadata [WPF], for dependency properties
- overriding metadata [WPF]
ms.assetid: d01ed009-b722-41bf-b82f-fe1a8cdc50dd
ms.openlocfilehash: 66628e8cc1e56bff2227721d6f6b3e511be7453e
ms.sourcegitcommit: 83ecdf731dc1920bca31f017b1556c917aafd7a0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 07/12/2019
ms.locfileid: "67860051"
---
# <a name="dependency-property-metadata"></a>Metadati delle proprietà di dipendenza
Il sistema di proprietà di [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] include un sistema di segnalazione dei metadati che va al di là di ciò che è possibile segnalare riguardo una proprietà tramite la reflection o le caratteristiche generali di [!INCLUDE[TLA#tla_clr](../../../../includes/tlasharptla-clr-md.md)]. I metadati di una proprietà di dipendenza possono anche essere assegnati in modo univoco dalla classe che definisce una proprietà di dipendenza, possono essere modificati quando la proprietà di dipendenza viene aggiunta a una classe diversa ed è possibile eseguirne specificatamente l'override tramite tutte le classi derivate che ereditano la proprietà di dipendenza dalla classe di base in fase di definizione.  

<a name="prerequisites"></a>   
## <a name="prerequisites"></a>Prerequisiti  
 Questo argomento presuppone la conoscenza delle proprietà di dipendenza dal punto di vista di un consumer delle proprietà di dipendenza esistenti nelle classi di [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)], nonché la lettura dell'argomento [Panoramica sulle proprietà di dipendenza](dependency-properties-overview.md). Per seguire gli esempi illustrati in questo argomento, è anche necessario conoscere [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] e saper scrivere applicazioni [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].  
  
<a name="dp_metadata_contents"></a>   
## <a name="how-dependency-property-metadata-is-used"></a>Come usare i metadati delle proprietà di dipendenza  
 I metadati della proprietà di dipendenza sono un oggetto sul quale è possibile eseguire query per esaminare le caratteristiche di una proprietà di dipendenza. Anche il sistema di proprietà accede frequentemente ai metadati durante l'elaborazione di qualsiasi proprietà di dipendenza. L'oggetto metadati di una proprietà di dipendenza può contenere i seguenti tipi di informazioni:  
  
- Valore predefinito della proprietà di dipendenza, se non è possibile determinare altri valori per la proprietà di dipendenza in base a valore locale, stile, ereditarietà e così via. Per una discussione dettagliata del ruolo dei valori predefiniti nella precedenza usata dal sistema di proprietà durante l'assegnazione dei valori per le proprietà di dipendenza, vedere [Precedenza del valore della proprietà di dipendenza](dependency-property-value-precedence.md).  
  
- I riferimenti a implementazioni di callback che influiscono sui comportamenti di coercizione o di notifica di modifica in base al tipo di proprietario. Notare che questi callback vengono spesso definiti con un livello di accesso non pubblico, pertanto in genere non è possibile ottenere i riferimenti effettivi dai metadati, a meno che i riferimenti non rientrino nell'ambito di accesso consentito. Per altre informazioni sui callback per le proprietà di dipendenza, vedere [Callback e convalida delle proprietà di dipendenza](dependency-property-callbacks-and-validation.md).  
  
- Se la proprietà di dipendenza in questione viene considerata come una proprietà a livello di framework WPF, i metadati potrebbero contenere caratteristiche della proprietà di dipendenza a livello di framework WPF, che segnalano informazioni e stato per servizi come la logica di ereditarietà delle proprietà e il motore di layout a livello di framework WPF. Per altre informazioni su questo aspetto dei metadati delle proprietà di dipendenza, vedere [Metadati delle proprietà del framework](framework-property-metadata.md).  
  
<a name="APIs"></a>   
## <a name="metadata-apis"></a>API dei metadati  
 Il tipo che segnala la maggior parte delle informazioni sui metadati utilizzate dal sistema di proprietà è il <xref:System.Windows.PropertyMetadata> classe. Le istanze dei metadati possono essere specificate facoltativamente quando le proprietà di dipendenza vengono registrate nel sistema di proprietà e una seconda volta per i tipi che si aggiungono come proprietari o che eseguono l'override dei metadati ereditati dalla definizione della proprietà di dipendenza della classe di base. (Per i casi in cui una registrazione di proprietà non specifica i metadati, un valore predefinito <xref:System.Windows.PropertyMetadata> viene creato con i valori predefiniti per tale classe.) I metadati registrati vengono restituiti come <xref:System.Windows.PropertyMetadata> quando si chiama le varie <xref:System.Windows.DependencyProperty.GetMetadata%2A> overload che ottengono i metadati da una proprietà di dipendenza in un <xref:System.Windows.DependencyObject> istanza.  
  
 Il <xref:System.Windows.PropertyMetadata> classe viene quindi derivata per fornire metadati specifici per le divisioni architetturali quali le classi a livello di framework WPF. <xref:System.Windows.UIPropertyMetadata> aggiunge segnalazioni di animazione e <xref:System.Windows.FrameworkPropertyMetadata> fornisce le proprietà a livello di framework WPF indicate nella sezione precedente. Quando le proprietà di dipendenza vengono registrate, possono essere registrati con questi <xref:System.Windows.PropertyMetadata> classi derivate. Quando i metadati vengono esaminati, la base <xref:System.Windows.PropertyMetadata> è potenzialmente possibile eseguire il cast per le classi derivate in modo che sia possibile esaminare le proprietà più specifiche.  
  
> [!NOTE]
>  Le caratteristiche della proprietà che possono essere specificate in <xref:System.Windows.FrameworkPropertyMetadata> vengono talvolta definiti nella presente documentazione come "flag". Quando si creano nuove istanze di metadati da utilizzare nella dipendenza le registrazioni delle proprietà o esegue l'override dei metadati, specificare questi valori usando l'enumerazione flag per flag <xref:System.Windows.FrameworkPropertyMetadataOptions> e quindi fornire valori possibilmente concatenati dell'enumerazione per il <xref:System.Windows.FrameworkPropertyMetadata> costruttore. Tuttavia, una volta costruito, queste caratteristiche dell'opzione vengono esposte all'interno di un <xref:System.Windows.FrameworkPropertyMetadata> come una serie di proprietà booleane, anziché il valore di enumerazione di creazione. Le proprietà booleane consentono di verificare ogni istruzione condizionale anziché richiedere l'applicazione di una maschera a un valore di enumerazione basato su flag per ottenere le informazioni necessarie. Il costruttore Usa concatenati <xref:System.Windows.FrameworkPropertyMetadataOptions> per mantenere la lunghezza della firma del costruttore entro limiti ragionevoli, mentre i metadati effettivamente costruiti espone le proprietà discrete per l'esecuzione di query di metadati più intuitivo.  
  
<a name="override_or_subclass"></a>   
## <a name="when-to-override-metadata-when-to-derive-a-class"></a>Esecuzione dell'override dei metadati e derivazione di una classe  
 Il sistema di proprietà di [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] include funzionalità consolidate che consentono di modificare alcune caratteristiche delle proprietà di dipendenza senza richiederne una implementazione nuova e completa. Questo risultato si ottiene creando un'istanza diversa dei metadati della proprietà per la proprietà di dipendenza presente in un tipo particolare. Notare che le proprietà di dipendenza non sono per la maggior parte proprietà virtuali, pertanto, a rigor di termini, "una nuova implementazione" di queste proprietà nelle classi ereditate potrebbe essere realizzata solo nascondendo il membro esistente.  
  
 Se lo scenario che si tenta di abilitare per una proprietà di dipendenza in un tipo non può essere realizzato modificando le caratteristiche delle proprietà di dipendenza esistenti, potrebbe essere necessario creare una classe derivata e successivamente dichiarare una proprietà di dipendenza personalizzata nella classe derivata. Proprietà di dipendenza personalizzate si comporta esattamente come proprietà di dipendenza definite dal [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] API. Per altri dettagli sulle proprietà di dipendenza personalizzate, vedere [Proprietà di dipendenza personalizzate](custom-dependency-properties.md).  
  
 Una caratteristica rilevante di una proprietà di dipendenza di cui non è possibile eseguire l'override è il tipo di valore. Se si eredita una proprietà di dipendenza che si comporta nel modo richiesto, ma è richiesto un tipo diverso per questa proprietà, sarà necessario implementare una proprietà di dipendenza personalizzata e forse collegare le proprietà tramite la conversione dei tipi oppure un'altra implementazione nella classe personalizzata. Inoltre, non è possibile sostituire un oggetto esistente <xref:System.Windows.ValidateValueCallback>, perché questo callback è presente nel campo di registrazione stesso e non all'interno dei metadati.  
  
<a name="scenarios"></a>   
## <a name="scenarios-for-changing-existing-metadata"></a>Scenari per la modifica dei metadati esistenti  
 Se si usano i metadati di una proprietà di dipendenza esistente, uno scenario comune per modificare i metadati della proprietà di dipendenza consiste nella modifica del valore predefinito. La modifica o l'aggiunta di callback del sistema di proprietà rappresenta uno scenario più avanzato. Questa operazione può essere necessaria quando l'implementazione di una classe derivata ha molte interrelazioni tra le proprietà di dipendenza. Una delle condizioni per poter disporre di un modello di programmazione che supporti l'utilizzo del codice e l'utilizzo dichiarativo consiste nella possibilità di impostare le proprietà in qualsiasi ordine. Le proprietà dipendenti devono quindi essere impostate JIT senza contesto e senza la possibilità di basarsi sulla conoscenza di un ordine di impostazione, come potrebbe accadere in un costruttore. Per altre informazioni su questo aspetto del sistema di proprietà, vedere [Callback e convalida delle proprietà di dipendenza](dependency-property-callbacks-and-validation.md). Notare che i callback di convalida non fanno parte dei metadati, ma dell'identificatore della proprietà di dipendenza. I callback di convalida non possono quindi essere modificati mediante l'override dei metadati.  
  
 In alcuni casi, è possibile che si decida di modificare le opzioni dei metadati delle proprietà a livello di framework WPF nelle proprietà di dipendenza esistenti. Queste opzioni consentono di comunicare alcune condizioni note relative alle proprietà a livello di framework WPF ad altri processi a livello di framework WPF, ad esempio il sistema di layout.  Impostazione delle opzioni in genere viene eseguita solo quando si registra una nuova proprietà di dipendenza, ma è anche possibile modificare i metadati della proprietà a livello di framework WPF come parte di un <xref:System.Windows.DependencyProperty.OverrideMetadata%2A> o <xref:System.Windows.DependencyProperty.AddOwner%2A> chiamare. Per conoscere i valori specifici da usare e per altre informazioni, vedere [Metadati delle proprietà del framework](framework-property-metadata.md). Per altre informazioni relative alla modalità di impostazione di queste opzioni per una proprietà di dipendenza appena registrata, vedere [Proprietà di dipendenza personalizzate](custom-dependency-properties.md).  
  
<a name="dp_override_metadata"></a>   
### <a name="overriding-metadata"></a>Override dei metadati  
 Lo scopo dell'override dei metadati è principalmente la possibilità di modificare i diversi comportamenti derivati dai metadati applicati alla proprietà di dipendenza esistente per il tipo. Le ragioni di questa operazione vengono spiegate più dettagliatamente nella sezione [Metadati](#dp_metadata_contents). Per altre informazioni e alcuni esempi di codice, vedere [Eseguire l'override dei metadati per una proprietà di dipendenza](how-to-override-metadata-for-a-dependency-property.md).  
  
 I metadati della proprietà possono essere forniti per una proprietà di dipendenza durante la chiamata di registrazione (<xref:System.Windows.DependencyProperty.Register%2A>). Tuttavia, in molti casi è possibile fornire metadati specifici del tipo per la classe, quando questa eredita tale proprietà di dipendenza. È possibile farlo tramite una chiamata di <xref:System.Windows.DependencyProperty.OverrideMetadata%2A> (metodo).  Per un esempio tratto dal [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] API, il <xref:System.Windows.FrameworkElement> è il tipo che esegue la registrazione prima di tutto la <xref:System.Windows.UIElement.Focusable%2A> proprietà di dipendenza. Ma il <xref:System.Windows.Controls.Control> classe esegue l'override dei metadati della proprietà di dipendenza fornire il proprio valore predefinito iniziale, modificandolo da `false` al `true`e in caso contrario riutilizza l'originale <xref:System.Windows.UIElement.Focusable%2A> implementazione.  
  
 Quando si esegue l'override dei metadati, le diverse caratteristiche dei metadati vengono unite oppure sostituite.  
  
- <xref:System.Windows.PropertyMetadata.PropertyChangedCallback%2A> viene unito. Se si aggiunge un nuovo <xref:System.Windows.PropertyMetadata.PropertyChangedCallback%2A>, quel callback viene archiviato nei metadati. Se non si specifica un <xref:System.Windows.PropertyMetadata.PropertyChangedCallback%2A> nell'override, il valore di <xref:System.Windows.PropertyMetadata.PropertyChangedCallback%2A> viene promosso come riferimento dal predecessore più vicino che lo aveva specificato nei metadati.  
  
- Il comportamento effettivo della proprietà del sistema per <xref:System.Windows.PropertyMetadata.PropertyChangedCallback%2A> è che le implementazioni di tutti i proprietari di metadati nella gerarchia siano mantenute e aggiunte a una tabella, con ordine di esecuzione dal sistema di proprietà che vengono richiamati per primi i callback della classe più derivata.  
  
- <xref:System.Windows.PropertyMetadata.DefaultValue%2A> è stato sostituito. Se non si specifica un <xref:System.Windows.PropertyMetadata.DefaultValue%2A> nell'override, il valore di <xref:System.Windows.PropertyMetadata.DefaultValue%2A> proviene dal predecessore più vicino che lo aveva specificato nei metadati.  
  
- <xref:System.Windows.PropertyMetadata.CoerceValueCallback%2A> le implementazioni vengono sostituite. Se si aggiunge un nuovo <xref:System.Windows.PropertyMetadata.CoerceValueCallback%2A>, quel callback viene archiviato nei metadati. Se non si specifica un <xref:System.Windows.PropertyMetadata.CoerceValueCallback%2A> nell'override, il valore di <xref:System.Windows.PropertyMetadata.CoerceValueCallback%2A> viene promosso come riferimento dal predecessore più vicino che lo aveva specificato nei metadati.  
  
- Il comportamento del sistema di proprietà è che solo il <xref:System.Windows.PropertyMetadata.CoerceValueCallback%2A> dei metadati immediati viene richiamato. Nessun riferimento ad altri <xref:System.Windows.PropertyMetadata.CoerceValueCallback%2A> vengono mantenute le implementazioni della gerarchia.  
  
 Questo comportamento viene implementato mediante <xref:System.Windows.PropertyMetadata.Merge%2A>e può essere sottoposto a override nelle classi di metadati derivate.  
  
#### <a name="overriding-attached-property-metadata"></a>Override dei metadati delle proprietà associate  
 In [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], le proprietà associate vengono implementate come proprietà di dipendenza. In altri termini, dispongono anche di metadati della proprietà di cui le singole classi possono eseguire l'override. Le considerazioni per una proprietà associata nella definizione dell'ambito [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] sono in genere che qualsiasi <xref:System.Windows.DependencyObject> può avere una proprietà associata impostata su di essi. Pertanto, qualsiasi <xref:System.Windows.DependencyObject> classe derivata può eseguire l'override di metadati per una proprietà associata, poiché potrebbe essere impostata su un'istanza della classe. È possibile eseguire l'override dei valori predefiniti, dei callback o delle proprietà di segnalazione delle caratteristiche a livello di framework WPF. Se la proprietà associata viene impostata su un'istanza della classe, vengono applicate le caratteristiche dei metadati della proprietà di override. È possibile, ad esempio, eseguire l'override del valore predefinito, in modo che il valore di override venga segnalato come valore della proprietà associata nelle istanze della classe, tutte le volte che la proprietà non viene impostata diversamente.  
  
> [!NOTE]
>  Il <xref:System.Windows.FrameworkPropertyMetadata.Inherits%2A> proprietà non è rilevante per le proprietà associate.  
  
<a name="dp_add_owner"></a>   
### <a name="adding-a-class-as-an-owner-of-an-existing-dependency-property"></a>Aggiunta di un classe come proprietario di una proprietà di dipendenza esistente  
 Una classe può aggiungersi come proprietario di una proprietà di dipendenza che è già stato registrato, usando il <xref:System.Windows.DependencyProperty.AddOwner%2A> (metodo). In questo modo, la classe può usare una proprietà di dipendenza registrata originariamente per un tipo diverso. In genere, la classe aggiunta non è una classe derivata del tipo che ha registrato per primo quella proprietà di dipendenza come proprietario. In realtà, in questo modo la classe e le relative classi derivate possono "ereditare" un'implementazione della proprietà di dipendenza senza che la classe proprietario originale e quella aggiunta si trovino nella stessa gerarchia di classi. Inoltre, la classe aggiunta (e tutte le classi derivate) possono quindi fornire metadati specifici sul tipo per la proprietà di dipendenza originale.  
  
 Oltre ad aggiungersi come proprietario tramite i metodi di utilità del sistema di proprietà, la classe aggiunta deve dichiarare ulteriori membri pubblici al proprio interno al fine di far partecipare completamente la proprietà di dipendenza nel sistema di proprietà con l'esposizione al codice e al markup. Una classe che aggiunge una proprietà di dipendenza esistente ha le stesse responsabilità, per quanto riguarda l'esposizione del modello a oggetti per quella proprietà di dipendenza, di una classe che definisce una nuova proprietà di dipendenza personalizzata. Il primo di questi membri da esporre è un campo dell'identificatore della proprietà di dipendenza. Questo campo deve essere un `public static readonly` campo di tipo <xref:System.Windows.DependencyProperty>, che viene assegnato il valore restituito del <xref:System.Windows.DependencyProperty.AddOwner%2A> chiamare. Il secondo membro da definire è la proprietà "wrapper" [!INCLUDE[TLA#tla_clr](../../../../includes/tlasharptla-clr-md.md)]. Il wrapper rende molto più semplice la modifica della proprietà di dipendenza nel codice (evitare chiamate a <xref:System.Windows.DependencyObject.SetValue%2A> ogni volta e può effettuare tale chiamata una sola volta all'interno del wrapper stesso). Il wrapper viene implementato con la stessa procedura valida per i wrapper implementati nella registrazione di una proprietà di dipendenza personalizzata. Per altre informazioni sull'implementazione di una proprietà di dipendenza, vedere [Proprietà di dipendenza personalizzate](custom-dependency-properties.md) e [Aggiungere un tipo di proprietario per una proprietà di dipendenza](how-to-add-an-owner-type-for-a-dependency-property.md).  
  
#### <a name="addowner-and-attached-properties"></a>AddOwner e proprietà associate  
 È possibile chiamare <xref:System.Windows.DependencyProperty.AddOwner%2A> per una proprietà di dipendenza definita come proprietà associata dalla classe proprietario. In genere, questa operazione viene eseguita per esporre la proprietà precedentemente associata come proprietà di dipendenza non associata. È quindi necessario esporre il <xref:System.Windows.DependencyProperty.AddOwner%2A> restituire come valore un `public static readonly` campo da usare come identificatore della proprietà di dipendenza e verranno definite proprietà "wrapper" appropriate in modo che la proprietà viene visualizzata nella tabella dei membri e supporta una proprietà non associato utilizzo della classe.  
  
## <a name="see-also"></a>Vedere anche

- <xref:System.Windows.PropertyMetadata>
- <xref:System.Windows.DependencyObject>
- <xref:System.Windows.DependencyProperty>
- <xref:System.Windows.DependencyProperty.GetMetadata%2A>
- [Panoramica sulle proprietà di dipendenza](dependency-properties-overview.md)
- [Metadati delle proprietà del framework](framework-property-metadata.md)
