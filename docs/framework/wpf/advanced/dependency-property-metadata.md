---
title: Metadati delle proprietà di dipendenza
ms.date: 03/30/2017
helpviewer_keywords:
- APIs [WPF], metadata
- dependency properties [WPF], metadata
- metadata [WPF], for dependency properties
- overriding metadata [WPF]
ms.assetid: d01ed009-b722-41bf-b82f-fe1a8cdc50dd
ms.openlocfilehash: 154a2543c62de545e8b2df711d6ad51989d0689d
ms.sourcegitcommit: 68653db98c5ea7744fd438710248935f70020dfb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/22/2019
ms.locfileid: "69964845"
---
# <a name="dependency-property-metadata"></a>Metadati delle proprietà di dipendenza
Il [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] sistema di proprietà include un sistema di creazione di report dei metadati che va oltre quello che può essere segnalato su una proprietà tramite reflection o caratteristiche generali di Common Language Runtime (CLR). I metadati di una proprietà di dipendenza possono anche essere assegnati in modo univoco dalla classe che definisce una proprietà di dipendenza, possono essere modificati quando la proprietà di dipendenza viene aggiunta a una classe diversa ed è possibile eseguirne specificatamente l'override tramite tutte le classi derivate che ereditano la proprietà di dipendenza dalla classe di base in fase di definizione.  

<a name="prerequisites"></a>   
## <a name="prerequisites"></a>Prerequisiti  
 Questo argomento presuppone la conoscenza delle proprietà di dipendenza dal punto di vista di un consumer delle proprietà di dipendenza esistenti nelle classi di [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)], nonché la lettura dell'argomento [Panoramica sulle proprietà di dipendenza](dependency-properties-overview.md). Per seguire gli esempi illustrati in questo argomento, è anche necessario conoscere [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] e saper scrivere applicazioni [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].  
  
<a name="dp_metadata_contents"></a>   
## <a name="how-dependency-property-metadata-is-used"></a>Come usare i metadati delle proprietà di dipendenza  
 I metadati della proprietà di dipendenza sono un oggetto sul quale è possibile eseguire query per esaminare le caratteristiche di una proprietà di dipendenza. Anche il sistema di proprietà accede frequentemente ai metadati durante l'elaborazione di qualsiasi proprietà di dipendenza. L'oggetto metadati di una proprietà di dipendenza può contenere i seguenti tipi di informazioni:  
  
- Valore predefinito della proprietà di dipendenza, se non è possibile determinare altri valori per la proprietà di dipendenza in base a valore locale, stile, ereditarietà e così via. Per una discussione dettagliata del ruolo dei valori predefiniti nella precedenza usata dal sistema di proprietà durante l'assegnazione dei valori per le proprietà di dipendenza, vedere [Precedenza del valore della proprietà di dipendenza](dependency-property-value-precedence.md).  
  
- I riferimenti a implementazioni di callback che influiscono sui comportamenti di coercizione o di notifica di modifica in base al tipo di proprietario. Notare che questi callback vengono spesso definiti con un livello di accesso non pubblico, pertanto in genere non è possibile ottenere i riferimenti effettivi dai metadati, a meno che i riferimenti non rientrino nell'ambito di accesso consentito. Per altre informazioni sui callback per le proprietà di dipendenza, vedere [Callback e convalida delle proprietà di dipendenza](dependency-property-callbacks-and-validation.md).  
  
- Se la proprietà di dipendenza in questione viene considerata come una proprietà a livello di framework WPF, i metadati potrebbero contenere caratteristiche della proprietà di dipendenza a livello di framework WPF, che segnalano informazioni e stato per servizi come la logica di ereditarietà delle proprietà e il motore di layout a livello di framework WPF. Per altre informazioni su questo aspetto dei metadati delle proprietà di dipendenza, vedere [Metadati delle proprietà del framework](framework-property-metadata.md).  
  
<a name="APIs"></a>   
## <a name="metadata-apis"></a>API dei metadati  
 Il tipo che indica la maggior parte delle informazioni sui metadati utilizzate dal sistema di proprietà <xref:System.Windows.PropertyMetadata> è la classe. Le istanze dei metadati possono essere specificate facoltativamente quando le proprietà di dipendenza vengono registrate nel sistema di proprietà e una seconda volta per i tipi che si aggiungono come proprietari o che eseguono l'override dei metadati ereditati dalla definizione della proprietà di dipendenza della classe di base. Per i casi in cui una registrazione di proprietà non specifica metadati, viene <xref:System.Windows.PropertyMetadata> creato un valore predefinito con i valori predefiniti per tale classe. I metadati registrati vengono restituiti come <xref:System.Windows.PropertyMetadata> quando si chiamano i vari <xref:System.Windows.DependencyProperty.GetMetadata%2A> overload che ottengono metadati da una proprietà di dipendenza in un' <xref:System.Windows.DependencyObject> istanza di.  
  
 La <xref:System.Windows.PropertyMetadata> classe viene quindi derivata da per fornire metadati più specifici per le divisioni di architettura, ad esempio le classi a livello di Framework WPF. <xref:System.Windows.UIPropertyMetadata>aggiunge la creazione di report <xref:System.Windows.FrameworkPropertyMetadata> di animazione e fornisce le proprietà a livello di Framework WPF indicate nella sezione precedente. Quando le proprietà di dipendenza vengono registrate, possono essere registrate con <xref:System.Windows.PropertyMetadata> queste classi derivate. Quando i metadati vengono esaminati, è <xref:System.Windows.PropertyMetadata> possibile eseguire il cast del tipo di base alle classi derivate in modo da poter esaminare le proprietà più specifiche.  
  
> [!NOTE]
> Le caratteristiche della proprietà che è possibile specificare <xref:System.Windows.FrameworkPropertyMetadata> in sono talvolta indicate in questa documentazione come "flag". Quando si creano nuove istanze di metadati da usare nelle registrazioni delle proprietà di dipendenza o negli override dei metadati, è necessario specificare questi <xref:System.Windows.FrameworkPropertyMetadataOptions> valori usando l'enumerazione flag, quindi fornire i valori eventualmente concatenati dell'enumerazione al <xref:System.Windows.FrameworkPropertyMetadata> costruttore. Tuttavia, una volta costruite, queste caratteristiche delle opzioni vengono <xref:System.Windows.FrameworkPropertyMetadata> esposte all'interno di un come una serie di proprietà booleane anziché il valore di enumerazione di costruzione. Le proprietà booleane consentono di verificare ogni istruzione condizionale anziché richiedere l'applicazione di una maschera a un valore di enumerazione basato su flag per ottenere le informazioni necessarie. Il costruttore utilizza l'oggetto concatenato <xref:System.Windows.FrameworkPropertyMetadataOptions> per garantire una ragionevole lunghezza della firma del costruttore, mentre i metadati costruiti effettivi espongono le proprietà discrete per rendere più intuitiva l'esecuzione di query sui metadati.  
  
<a name="override_or_subclass"></a>   
## <a name="when-to-override-metadata-when-to-derive-a-class"></a>Esecuzione dell'override dei metadati e derivazione di una classe  
 Il sistema di proprietà di [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] include funzionalità consolidate che consentono di modificare alcune caratteristiche delle proprietà di dipendenza senza richiederne una implementazione nuova e completa. Questo risultato si ottiene creando un'istanza diversa dei metadati della proprietà per la proprietà di dipendenza presente in un tipo particolare. Notare che le proprietà di dipendenza non sono per la maggior parte proprietà virtuali, pertanto, a rigor di termini, "una nuova implementazione" di queste proprietà nelle classi ereditate potrebbe essere realizzata solo nascondendo il membro esistente.  
  
 Se lo scenario che si tenta di abilitare per una proprietà di dipendenza in un tipo non può essere realizzato modificando le caratteristiche delle proprietà di dipendenza esistenti, potrebbe essere necessario creare una classe derivata e successivamente dichiarare una proprietà di dipendenza personalizzata nella classe derivata. Una proprietà di dipendenza personalizzata si comporta in modo identico alle proprietà di dipendenza [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] definite dalle API. Per altri dettagli sulle proprietà di dipendenza personalizzate, vedere [Proprietà di dipendenza personalizzate](custom-dependency-properties.md).  
  
 Una caratteristica rilevante di una proprietà di dipendenza di cui non è possibile eseguire l'override è il tipo di valore. Se si eredita una proprietà di dipendenza che si comporta nel modo richiesto, ma è richiesto un tipo diverso per questa proprietà, sarà necessario implementare una proprietà di dipendenza personalizzata e forse collegare le proprietà tramite la conversione dei tipi oppure un'altra implementazione nella classe personalizzata. Non è inoltre possibile sostituire un oggetto <xref:System.Windows.ValidateValueCallback>esistente perché questo callback esiste nel campo di registrazione e non nei relativi metadati.  
  
<a name="scenarios"></a>   
## <a name="scenarios-for-changing-existing-metadata"></a>Scenari per la modifica dei metadati esistenti  
 Se si usano i metadati di una proprietà di dipendenza esistente, uno scenario comune per modificare i metadati della proprietà di dipendenza consiste nella modifica del valore predefinito. La modifica o l'aggiunta di callback del sistema di proprietà rappresenta uno scenario più avanzato. Questa operazione può essere necessaria quando l'implementazione di una classe derivata ha molte interrelazioni tra le proprietà di dipendenza. Una delle condizioni per poter disporre di un modello di programmazione che supporti l'utilizzo del codice e l'utilizzo dichiarativo consiste nella possibilità di impostare le proprietà in qualsiasi ordine. Le proprietà dipendenti devono quindi essere impostate JIT senza contesto e senza la possibilità di basarsi sulla conoscenza di un ordine di impostazione, come potrebbe accadere in un costruttore. Per altre informazioni su questo aspetto del sistema di proprietà, vedere [Callback e convalida delle proprietà di dipendenza](dependency-property-callbacks-and-validation.md). Notare che i callback di convalida non fanno parte dei metadati, ma dell'identificatore della proprietà di dipendenza. I callback di convalida non possono quindi essere modificati mediante l'override dei metadati.  
  
 In alcuni casi, è possibile che si decida di modificare le opzioni dei metadati delle proprietà a livello di framework WPF nelle proprietà di dipendenza esistenti. Queste opzioni consentono di comunicare alcune condizioni note relative alle proprietà a livello di framework WPF ad altri processi a livello di framework WPF, ad esempio il sistema di layout.  L'impostazione delle opzioni viene in genere eseguita solo quando si registra una nuova proprietà di dipendenza, ma è anche possibile modificare i metadati della proprietà a livello di Framework WPF come <xref:System.Windows.DependencyProperty.OverrideMetadata%2A> parte <xref:System.Windows.DependencyProperty.AddOwner%2A> di una chiamata a o. Per conoscere i valori specifici da usare e per altre informazioni, vedere [Metadati delle proprietà del framework](framework-property-metadata.md). Per altre informazioni relative alla modalità di impostazione di queste opzioni per una proprietà di dipendenza appena registrata, vedere [Proprietà di dipendenza personalizzate](custom-dependency-properties.md).  
  
<a name="dp_override_metadata"></a>   
### <a name="overriding-metadata"></a>Override dei metadati  
 Lo scopo dell'override dei metadati è principalmente la possibilità di modificare i diversi comportamenti derivati dai metadati applicati alla proprietà di dipendenza esistente per il tipo. Le ragioni di questa operazione vengono spiegate più dettagliatamente nella sezione [Metadati](#dp_metadata_contents). Per altre informazioni e alcuni esempi di codice, vedere [Eseguire l'override dei metadati per una proprietà di dipendenza](how-to-override-metadata-for-a-dependency-property.md).  
  
 I metadati della proprietà possono essere forniti per una proprietà di dipendenza durante la<xref:System.Windows.DependencyProperty.Register%2A>chiamata di registrazione (). Tuttavia, in molti casi è possibile fornire metadati specifici del tipo per la classe, quando questa eredita tale proprietà di dipendenza. Questa operazione può essere eseguita chiamando il <xref:System.Windows.DependencyProperty.OverrideMetadata%2A> metodo.  Per un esempio [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] delle API, la <xref:System.Windows.FrameworkElement> classe è il tipo che prima registra la <xref:System.Windows.UIElement.Focusable%2A> proprietà di dipendenza. Tuttavia, <xref:System.Windows.Controls.Control> la classe esegue l'override dei metadati per la proprietà di dipendenza per fornire il proprio valore predefinito `false` iniziale `true`, cambiandolo da a e altrimenti riutilizza l'implementazione originale <xref:System.Windows.UIElement.Focusable%2A> .  
  
 Quando si esegue l'override dei metadati, le diverse caratteristiche dei metadati vengono unite oppure sostituite.  
  
- <xref:System.Windows.PropertyMetadata.PropertyChangedCallback%2A>viene Unito. Se si aggiunge un nuovo <xref:System.Windows.PropertyMetadata.PropertyChangedCallback%2A>oggetto, tale callback viene archiviato nei metadati. Se non si specifica un oggetto <xref:System.Windows.PropertyMetadata.PropertyChangedCallback%2A> nell'override, il valore di <xref:System.Windows.PropertyMetadata.PropertyChangedCallback%2A> viene promosso come riferimento dal predecessore più vicino che lo ha specificato nei metadati.  
  
- Il comportamento effettivo del sistema di <xref:System.Windows.PropertyMetadata.PropertyChangedCallback%2A> proprietà per è che le implementazioni per tutti i proprietari di metadati nella gerarchia vengono mantenute e aggiunte a una tabella, con ordine di esecuzione da parte del sistema di proprietà perché i callback della classe più derivata vengono richiamati per primi.  
  
- <xref:System.Windows.PropertyMetadata.DefaultValue%2A>viene sostituito. Se non si specifica un oggetto <xref:System.Windows.PropertyMetadata.DefaultValue%2A> nell'override, il valore di <xref:System.Windows.PropertyMetadata.DefaultValue%2A> deriva dal predecessore più vicino che lo ha specificato nei metadati.  
  
- <xref:System.Windows.PropertyMetadata.CoerceValueCallback%2A>le implementazioni vengono sostituite. Se si aggiunge un nuovo <xref:System.Windows.PropertyMetadata.CoerceValueCallback%2A>oggetto, tale callback viene archiviato nei metadati. Se non si specifica un oggetto <xref:System.Windows.PropertyMetadata.CoerceValueCallback%2A> nell'override, il valore di <xref:System.Windows.PropertyMetadata.CoerceValueCallback%2A> viene promosso come riferimento dal predecessore più vicino che lo ha specificato nei metadati.  
  
- Il comportamento del sistema di proprietà è che <xref:System.Windows.PropertyMetadata.CoerceValueCallback%2A> solo l'oggetto nei metadati immediati viene richiamato. Non viene mantenuto alcun <xref:System.Windows.PropertyMetadata.CoerceValueCallback%2A> riferimento ad altre implementazioni nella gerarchia.  
  
 Questo comportamento viene implementato da <xref:System.Windows.PropertyMetadata.Merge%2A>ed è possibile eseguirne l'override nelle classi di metadati derivate.  
  
#### <a name="overriding-attached-property-metadata"></a>Override dei metadati delle proprietà associate  
 In [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], le proprietà associate vengono implementate come proprietà di dipendenza. In altri termini, dispongono anche di metadati della proprietà di cui le singole classi possono eseguire l'override. Le considerazioni relative all'ambito per una proprietà [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] associata in sono in <xref:System.Windows.DependencyObject> genere di cui è possibile impostare una proprietà associata. Pertanto, qualsiasi <xref:System.Windows.DependencyObject> classe derivata può eseguire l'override dei metadati per qualsiasi proprietà associata, in quanto potrebbe essere impostata su un'istanza della classe. È possibile eseguire l'override dei valori predefiniti, dei callback o delle proprietà di segnalazione delle caratteristiche a livello di framework WPF. Se la proprietà associata viene impostata su un'istanza della classe, vengono applicate le caratteristiche dei metadati della proprietà di override. È possibile, ad esempio, eseguire l'override del valore predefinito, in modo che il valore di override venga segnalato come valore della proprietà associata nelle istanze della classe, tutte le volte che la proprietà non viene impostata diversamente.  
  
> [!NOTE]
> La <xref:System.Windows.FrameworkPropertyMetadata.Inherits%2A> proprietà non è pertinente per le proprietà associate.  
  
<a name="dp_add_owner"></a>   
### <a name="adding-a-class-as-an-owner-of-an-existing-dependency-property"></a>Aggiunta di un classe come proprietario di una proprietà di dipendenza esistente  
 Una classe può aggiungersi come proprietario di una proprietà di dipendenza che è già stata registrata, usando il <xref:System.Windows.DependencyProperty.AddOwner%2A> metodo. In questo modo, la classe può usare una proprietà di dipendenza registrata originariamente per un tipo diverso. In genere, la classe aggiunta non è una classe derivata del tipo che ha registrato per primo quella proprietà di dipendenza come proprietario. In realtà, in questo modo la classe e le relative classi derivate possono "ereditare" un'implementazione della proprietà di dipendenza senza che la classe proprietario originale e quella aggiunta si trovino nella stessa gerarchia di classi. Inoltre, la classe aggiunta (e tutte le classi derivate) possono quindi fornire metadati specifici sul tipo per la proprietà di dipendenza originale.  
  
 Oltre ad aggiungersi come proprietario tramite i metodi di utilità del sistema di proprietà, la classe aggiunta deve dichiarare ulteriori membri pubblici al proprio interno al fine di far partecipare completamente la proprietà di dipendenza nel sistema di proprietà con l'esposizione al codice e al markup. Una classe che aggiunge una proprietà di dipendenza esistente ha le stesse responsabilità, per quanto riguarda l'esposizione del modello a oggetti per quella proprietà di dipendenza, di una classe che definisce una nuova proprietà di dipendenza personalizzata. Il primo di questi membri da esporre è un campo dell'identificatore della proprietà di dipendenza. Questo campo deve essere un `public static readonly` campo di tipo <xref:System.Windows.DependencyProperty>, che viene assegnato al valore restituito della <xref:System.Windows.DependencyProperty.AddOwner%2A> chiamata. Il secondo membro da definire è la proprietà "wrapper" Common Language Runtime (CLR). Il wrapper rende molto più comodo modificare la proprietà di dipendenza nel codice (si evitano chiamate a <xref:System.Windows.DependencyObject.SetValue%2A> ogni volta e si può effettuare la chiamata solo una volta nel wrapper). Il wrapper viene implementato con la stessa procedura valida per i wrapper implementati nella registrazione di una proprietà di dipendenza personalizzata. Per altre informazioni sull'implementazione di una proprietà di dipendenza, vedere [Proprietà di dipendenza personalizzate](custom-dependency-properties.md) e [Aggiungere un tipo di proprietario per una proprietà di dipendenza](how-to-add-an-owner-type-for-a-dependency-property.md).  
  
#### <a name="addowner-and-attached-properties"></a>AddOwner e proprietà associate  
 È possibile chiamare <xref:System.Windows.DependencyProperty.AddOwner%2A> per una proprietà di dipendenza definita come proprietà associata dalla classe Owner. In genere, questa operazione viene eseguita per esporre la proprietà precedentemente associata come proprietà di dipendenza non associata. Si esporrà quindi il <xref:System.Windows.DependencyProperty.AddOwner%2A> valore restituito `public static readonly` come campo da utilizzare come identificatore della proprietà di dipendenza e verranno definite le proprietà "wrapper" appropriate, in modo che la proprietà venga visualizzata nella tabella dei membri e supporti una proprietà non associata utilizzo nella classe.  
  
## <a name="see-also"></a>Vedere anche

- <xref:System.Windows.PropertyMetadata>
- <xref:System.Windows.DependencyObject>
- <xref:System.Windows.DependencyProperty>
- <xref:System.Windows.DependencyProperty.GetMetadata%2A>
- [Panoramica sulle proprietà di dipendenza](dependency-properties-overview.md)
- [Metadati delle proprietà del framework](framework-property-metadata.md)
