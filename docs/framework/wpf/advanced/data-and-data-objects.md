---
title: Dati e oggetti dati
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- data transfer [WPF], drag-and-drop
- DataFormats class [WPF]
- DataObject class [WPF]
ms.assetid: 5967d557-1867-420f-a524-ae3af78402da
ms.openlocfilehash: 4b948a64a14df7ea79b54b810f734056d57ef406
ms.sourcegitcommit: 68653db98c5ea7744fd438710248935f70020dfb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 08/22/2019
ms.locfileid: "69964857"
---
# <a name="data-and-data-objects"></a><span data-ttu-id="2a314-102">Dati e oggetti dati</span><span class="sxs-lookup"><span data-stu-id="2a314-102">Data and Data Objects</span></span>
<span data-ttu-id="2a314-103">I dati trasferiti come parte di un'operazione di trascinamento della selezione vengono archiviati in un oggetto dati.</span><span class="sxs-lookup"><span data-stu-id="2a314-103">Data that is transferred as part of a drag-and-drop operation is stored in a data object.</span></span>  <span data-ttu-id="2a314-104">Concettualmente, un oggetto dati è costituito da una o più delle coppie seguenti:</span><span class="sxs-lookup"><span data-stu-id="2a314-104">Conceptually, a data object consists of one or more of the following pairs:</span></span>  
  
- <span data-ttu-id="2a314-105">Oggetto <xref:System.Object> che contiene i dati effettivi.</span><span class="sxs-lookup"><span data-stu-id="2a314-105">An <xref:System.Object> that contains the actual data.</span></span>  
  
- <span data-ttu-id="2a314-106">Identificatore del formato dati corrispondente.</span><span class="sxs-lookup"><span data-stu-id="2a314-106">A corresponding data format identifier.</span></span>  
  
 <span data-ttu-id="2a314-107">I dati possono essere costituiti da qualsiasi elemento che può essere rappresentato come <xref:System.Object>base.</span><span class="sxs-lookup"><span data-stu-id="2a314-107">The data itself can consist of anything that can be represented as a base <xref:System.Object>.</span></span>  <span data-ttu-id="2a314-108">Il formato dei dati corrispondente è una stringa <xref:System.Type> o che fornisce un suggerimento sul formato in cui si trovano i dati.</span><span class="sxs-lookup"><span data-stu-id="2a314-108">The corresponding data format is a string or <xref:System.Type> that provides a hint about what format the data is in.</span></span>  <span data-ttu-id="2a314-109">Gli oggetti dati supportano l'hosting di più coppie di formato dati/dati; Ciò consente a un singolo oggetto dati di fornire dati in più formati.</span><span class="sxs-lookup"><span data-stu-id="2a314-109">Data objects support hosting multiple data/data format pairs; this enables a single data object to provide data in multiple formats.</span></span>  
  
<a name="Data_and_Data_Objects"></a>   
## <a name="data-objects"></a><span data-ttu-id="2a314-110">Oggetti dati</span><span class="sxs-lookup"><span data-stu-id="2a314-110">Data Objects</span></span>  
 <span data-ttu-id="2a314-111">Tutti gli oggetti dati devono implementare <xref:System.Windows.IDataObject> l'interfaccia, che fornisce il set di metodi standard seguente che consentono e facilitano il trasferimento dei dati.</span><span class="sxs-lookup"><span data-stu-id="2a314-111">All data objects must implement the <xref:System.Windows.IDataObject> interface, which provides the following standard set of methods that enable and facilitate data transfer.</span></span>  
  
|<span data-ttu-id="2a314-112">Metodo</span><span class="sxs-lookup"><span data-stu-id="2a314-112">Method</span></span>|<span data-ttu-id="2a314-113">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="2a314-113">Summary</span></span>|  
|------------|-------------|  
|<xref:System.Windows.IDataObject.GetData%2A>|<span data-ttu-id="2a314-114">Recupera un oggetto dati in un formato dati specificato.</span><span class="sxs-lookup"><span data-stu-id="2a314-114">Retrieves a data object in a specified data format.</span></span>|  
|<xref:System.Windows.IDataObject.GetDataPresent%2A>|<span data-ttu-id="2a314-115">Verifica se i dati sono disponibili in o possono essere convertiti in un formato specificato.</span><span class="sxs-lookup"><span data-stu-id="2a314-115">Checks to see whether the data is available in, or can be converted to, a specified format.</span></span>|  
|<xref:System.Windows.IDataObject.GetFormats%2A>|<span data-ttu-id="2a314-116">Restituisce un elenco di formati in cui i dati in questo oggetto dati sono archiviati o possono essere convertiti in.</span><span class="sxs-lookup"><span data-stu-id="2a314-116">Returns a list of formats that the data in this data object is stored in, or can be converted to.</span></span>|  
|<xref:System.Windows.IDataObject.SetData%2A>|<span data-ttu-id="2a314-117">Archivia i dati specificati in questo oggetto dati.</span><span class="sxs-lookup"><span data-stu-id="2a314-117">Stores the specified data in this data object.</span></span>|  
  
 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]<span data-ttu-id="2a314-118">fornisce un'implementazione di base <xref:System.Windows.IDataObject> di <xref:System.Windows.DataObject> nella classe.</span><span class="sxs-lookup"><span data-stu-id="2a314-118">provides a basic implementation of <xref:System.Windows.IDataObject> in the <xref:System.Windows.DataObject> class.</span></span> <span data-ttu-id="2a314-119">La classe <xref:System.Windows.DataObject> Stock è sufficiente per molti scenari comuni di trasferimento dei dati.</span><span class="sxs-lookup"><span data-stu-id="2a314-119">The stock <xref:System.Windows.DataObject> class is sufficient for many common data transfer scenarios.</span></span>  
  
 <span data-ttu-id="2a314-120">Sono disponibili diversi formati predefiniti, ad esempio bitmap, CSV, file, HTML, RTF, stringhe, testo e audio.</span><span class="sxs-lookup"><span data-stu-id="2a314-120">There are several pre-defined formats, such as bitmap, CSV, file, HTML, RTF, string, text, and audio.</span></span> <span data-ttu-id="2a314-121">Per informazioni sui formati di dati predefiniti forniti con [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], vedere l'argomento di riferimento alla <xref:System.Windows.DataFormats> classe.</span><span class="sxs-lookup"><span data-stu-id="2a314-121">For information about pre-defined data formats provided with [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], see the <xref:System.Windows.DataFormats> class reference topic.</span></span>  
  
 <span data-ttu-id="2a314-122">Gli oggetti dati includono in genere una funzionalità per la conversione automatica dei dati archiviati in un formato diverso, durante l'estrazione dei dati; Questa funzionalità viene definita conversione automatica.</span><span class="sxs-lookup"><span data-stu-id="2a314-122">Data objects commonly include a facility for automatically converting data stored in one format to a different format while extracting data; this facility is referred to as auto-convert.</span></span> <span data-ttu-id="2a314-123">Quando si eseguono query per i formati di dati disponibili in un oggetto dati, è possibile filtrare i formati di dati convertibili automaticamente dai formati di <xref:System.Windows.DataObject.GetFormats%28System.Boolean%29> dati <xref:System.Windows.DataObject.GetDataPresent%28System.String%2CSystem.Boolean%29> nativi chiamando il metodo `autoConvert` o e `false`specificando il parametro come.</span><span class="sxs-lookup"><span data-stu-id="2a314-123">When querying for the data formats available in a data object, auto-convertible data formats can be filtered from native data formats by calling the <xref:System.Windows.DataObject.GetFormats%28System.Boolean%29> or <xref:System.Windows.DataObject.GetDataPresent%28System.String%2CSystem.Boolean%29> method and specifying the `autoConvert` parameter as `false`.</span></span>  <span data-ttu-id="2a314-124">Quando si aggiungono dati a un oggetto dati <xref:System.Windows.DataObject.SetData%28System.String%2CSystem.Object%2CSystem.Boolean%29> con il metodo, la conversione automatica dei dati può essere proibita `autoConvert` impostando `false`il parametro su.</span><span class="sxs-lookup"><span data-stu-id="2a314-124">When adding data to a data object with the <xref:System.Windows.DataObject.SetData%28System.String%2CSystem.Object%2CSystem.Boolean%29> method, auto-conversion of data can be prohibited by setting the `autoConvert` parameter to `false`.</span></span>  
  
<a name="Working_with_Data_Objects"></a>   
## <a name="working-with-data-objects"></a><span data-ttu-id="2a314-125">Utilizzo di oggetti dati</span><span class="sxs-lookup"><span data-stu-id="2a314-125">Working with Data Objects</span></span>  
 <span data-ttu-id="2a314-126">In questa sezione vengono descritte le tecniche comuni per la creazione e l'utilizzo di oggetti dati.</span><span class="sxs-lookup"><span data-stu-id="2a314-126">This section describes common techniques for creating and working with data objects.</span></span>  
  
### <a name="creating-new-data-objects"></a><span data-ttu-id="2a314-127">Creazione di nuovi oggetti dati</span><span class="sxs-lookup"><span data-stu-id="2a314-127">Creating New Data Objects</span></span>  
 <span data-ttu-id="2a314-128">La <xref:System.Windows.DataObject> classe fornisce diversi costruttori di overload che facilitano il popolamento di una <xref:System.Windows.DataObject> nuova istanza con una singola coppia dati/formato dati.</span><span class="sxs-lookup"><span data-stu-id="2a314-128">The <xref:System.Windows.DataObject> class provides several overloaded constructors that facilitate populating a new <xref:System.Windows.DataObject> instance with a single data/data format pair.</span></span>  
  
 <span data-ttu-id="2a314-129">Nell'esempio di codice seguente viene creato un nuovo oggetto dati e viene utilizzato uno dei costruttori <xref:System.Windows.DataObject.%23ctor%2A>di overload (<xref:System.Windows.DataObject.%23ctor(System.String,System.Object)>) per inizializzare l'oggetto dati con una stringa e un formato dati specificato.</span><span class="sxs-lookup"><span data-stu-id="2a314-129">The following example code creates a new data object and uses one of the overloaded constructors <xref:System.Windows.DataObject.%23ctor%2A>(<xref:System.Windows.DataObject.%23ctor(System.String,System.Object)>) to initialize the data object with a string and a specified data format.</span></span>  <span data-ttu-id="2a314-130">In questo caso, il formato dati è specificato da una stringa. la <xref:System.Windows.DataFormats> classe fornisce un set di stringhe di tipo predefinite.</span><span class="sxs-lookup"><span data-stu-id="2a314-130">In this case, the data format is specified by a string; the <xref:System.Windows.DataFormats> class provides a set of pre-defined type strings.</span></span> <span data-ttu-id="2a314-131">La conversione automatica dei dati archiviati è consentita per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="2a314-131">Auto-conversion of the stored data is allowed by default.</span></span>  
  
 [!code-csharp[DragDrop_DragDropMiscCode#_DragDrop_CreateDataObject_TypeString](~/samples/snippets/csharp/VS_Snippets_Wpf/DragDrop_DragDropMiscCode/CSharp/Window1.xaml.cs#_dragdrop_createdataobject_typestring)]
 [!code-vb[DragDrop_DragDropMiscCode#_DragDrop_CreateDataObject_TypeString](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DragDrop_DragDropMiscCode/visualbasic/window1.xaml.vb#_dragdrop_createdataobject_typestring)]  
  
 <span data-ttu-id="2a314-132">Per altri esempi di codice per la creazione di un oggetto dati, vedere [creare un oggetto dati](how-to-create-a-data-object.md).</span><span class="sxs-lookup"><span data-stu-id="2a314-132">For more examples of code that creates a data object, see [Create a Data Object](how-to-create-a-data-object.md).</span></span>  
  
### <a name="storing-data-in-multiple-formats"></a><span data-ttu-id="2a314-133">Archiviazione dei dati in più formati</span><span class="sxs-lookup"><span data-stu-id="2a314-133">Storing Data in Multiple Formats</span></span>  
 <span data-ttu-id="2a314-134">Un singolo oggetto dati è in grado di archiviare i dati in più formati.</span><span class="sxs-lookup"><span data-stu-id="2a314-134">A single data object is able to store data in multiple formats.</span></span>   <span data-ttu-id="2a314-135">L'uso strategico di più formati di dati all'interno di un singolo oggetto dati potenzialmente rende l'oggetto dati utilizzabile da una varietà più ampia di destinazioni di rilascio rispetto a quando è possibile rappresentare solo un singolo formato di dati.</span><span class="sxs-lookup"><span data-stu-id="2a314-135">Strategic use of multiple data formats within a single data object potentially makes the data object consumable by a wider variety of drop targets than if only a single data format could be represented.</span></span>  <span data-ttu-id="2a314-136">Si noti che, in generale, un'origine di trascinamento deve essere indipendente dai formati di dati che possono essere utilizzati da potenziali destinazioni di rilascio.</span><span class="sxs-lookup"><span data-stu-id="2a314-136">Note that, in general, a drag source must be agnostic about the data formats that are consumable by potential drop targets.</span></span>  
  
 <span data-ttu-id="2a314-137">Nell'esempio seguente viene illustrato come utilizzare il <xref:System.Windows.DataObject.SetData%28System.String%2CSystem.Object%29> metodo per aggiungere dati a un oggetto dati in più formati.</span><span class="sxs-lookup"><span data-stu-id="2a314-137">The following example shows how to use the <xref:System.Windows.DataObject.SetData%28System.String%2CSystem.Object%29> method to add data to a data object in multiple formats.</span></span>  
  
 [!code-csharp[DragDrop_DragDropMiscCode#_DragDrop_StoreMultipleFormats](~/samples/snippets/csharp/VS_Snippets_Wpf/DragDrop_DragDropMiscCode/CSharp/Window1.xaml.cs#_dragdrop_storemultipleformats)]
 [!code-vb[DragDrop_DragDropMiscCode#_DragDrop_StoreMultipleFormats](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DragDrop_DragDropMiscCode/visualbasic/window1.xaml.vb#_dragdrop_storemultipleformats)]  
  
### <a name="querying-a-data-object-for-available-formats"></a><span data-ttu-id="2a314-138">Esecuzione di query su un oggetto dati per i formati disponibili</span><span class="sxs-lookup"><span data-stu-id="2a314-138">Querying a Data Object for Available Formats</span></span>  
 <span data-ttu-id="2a314-139">Poiché un singolo oggetto dati può contenere un numero arbitrario di formati di dati, gli oggetti dati includono le funzionalità per il recupero di un elenco di formati di dati disponibili.</span><span class="sxs-lookup"><span data-stu-id="2a314-139">Because a single data object can contain an arbitrary number of data formats, data objects include facilities for retrieving a list of available data formats.</span></span>  
  
 <span data-ttu-id="2a314-140">Il codice di esempio seguente usa <xref:System.Windows.DataObject.GetFormats%2A> l'overload per ottenere una matrice di stringhe che indica tutti i formati di dati disponibili in un oggetto dati (sia nativi che tramite conversione automatica).</span><span class="sxs-lookup"><span data-stu-id="2a314-140">The following example code uses the <xref:System.Windows.DataObject.GetFormats%2A> overload to get an array of strings denoting all data formats available in a data object (both native and by auto-convert).</span></span>  
  
 [!code-csharp[DragDrop_DragDropMiscCode#_DragDrop_GetAllDataFormats](~/samples/snippets/csharp/VS_Snippets_Wpf/DragDrop_DragDropMiscCode/CSharp/Window1.xaml.cs#_dragdrop_getalldataformats)]
 [!code-vb[DragDrop_DragDropMiscCode#_DragDrop_GetAllDataFormats](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DragDrop_DragDropMiscCode/visualbasic/window1.xaml.vb#_dragdrop_getalldataformats)]  
  
 <span data-ttu-id="2a314-141">Per altri esempi di codice che esegue query su un oggetto dati per i formati di dati disponibili, vedere [elencare i formati di dati in un oggetto dati](how-to-list-the-data-formats-in-a-data-object.md).</span><span class="sxs-lookup"><span data-stu-id="2a314-141">For more examples of code that queries a data object for available data formats, see [List the Data Formats in a Data Object](how-to-list-the-data-formats-in-a-data-object.md).</span></span>  <span data-ttu-id="2a314-142">Per esempi di esecuzione di query su un oggetto dati per la presenza di un particolare formato dati, vedere [determinare se un formato di dati è presente in un oggetto dati](how-to-determine-if-a-data-format-is-present-in-a-data-object.md).</span><span class="sxs-lookup"><span data-stu-id="2a314-142">For examples of querying a data object for the presence of a particular data format, see [Determine if a Data Format is Present in a Data Object](how-to-determine-if-a-data-format-is-present-in-a-data-object.md).</span></span>  
  
### <a name="retrieving-data-from-a-data-object"></a><span data-ttu-id="2a314-143">Recupero di dati da un oggetto dati</span><span class="sxs-lookup"><span data-stu-id="2a314-143">Retrieving Data from a Data Object</span></span>  
 <span data-ttu-id="2a314-144">Il recupero di dati da un oggetto dati in un particolare formato prevede semplicemente la chiamata a <xref:System.Windows.DataObject.GetData%2A> uno dei metodi e la specifica del formato dati desiderato.</span><span class="sxs-lookup"><span data-stu-id="2a314-144">Retrieving data from a data object in a particular format simply involves calling one of the <xref:System.Windows.DataObject.GetData%2A> methods and specifying the desired data format.</span></span>  <span data-ttu-id="2a314-145">Uno dei <xref:System.Windows.DataObject.GetDataPresent%2A> metodi può essere utilizzato per verificare la presenza di un particolare formato dati.</span><span class="sxs-lookup"><span data-stu-id="2a314-145">One of the <xref:System.Windows.DataObject.GetDataPresent%2A> methods can be used to check for the presence of a particular data format.</span></span>  <span data-ttu-id="2a314-146"><xref:System.Windows.DataObject.GetData%2A>Restituisce i dati in un <xref:System.Object>oggetto; a seconda del formato dati, è possibile eseguire il cast di questo oggetto a un contenitore specifico del tipo.</span><span class="sxs-lookup"><span data-stu-id="2a314-146"><xref:System.Windows.DataObject.GetData%2A> returns the data in an <xref:System.Object>; depending on the data format, this object can be cast to a type-specific container.</span></span>  
  
 <span data-ttu-id="2a314-147">Nell'esempio di codice seguente viene <xref:System.Windows.DataObject.GetDataPresent%28System.String%29> utilizzato l'overload per verificare se è disponibile un formato dati specificato (nativo o tramite conversione automatica).</span><span class="sxs-lookup"><span data-stu-id="2a314-147">The following example code uses the <xref:System.Windows.DataObject.GetDataPresent%28System.String%29> overload to check if a specified data format is available (native or by auto-convert).</span></span> <span data-ttu-id="2a314-148">Se il formato specificato è disponibile, nell'esempio vengono recuperati i dati utilizzando <xref:System.Windows.DataObject.GetData%28System.String%29> il metodo.</span><span class="sxs-lookup"><span data-stu-id="2a314-148">If the specified format is available, the example retrieves the data by using the <xref:System.Windows.DataObject.GetData%28System.String%29> method.</span></span>  
  
 [!code-csharp[DragDrop_DragDropMiscCode#_DragDrop_GetSpecificDataFormat](~/samples/snippets/csharp/VS_Snippets_Wpf/DragDrop_DragDropMiscCode/CSharp/Window1.xaml.cs#_dragdrop_getspecificdataformat)]
 [!code-vb[DragDrop_DragDropMiscCode#_DragDrop_GetSpecificDataFormat](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DragDrop_DragDropMiscCode/visualbasic/window1.xaml.vb#_dragdrop_getspecificdataformat)]  
  
 <span data-ttu-id="2a314-149">Per altri esempi di codice che recupera dati da un oggetto dati, vedere [recuperare dati in un particolare formato dati](how-to-retrieve-data-in-a-particular-data-format.md).</span><span class="sxs-lookup"><span data-stu-id="2a314-149">For more examples of code that retrieves data from a data object, see [Retrieve Data in a Particular Data Format](how-to-retrieve-data-in-a-particular-data-format.md).</span></span>  
  
### <a name="removing-data-from-a-data-object"></a><span data-ttu-id="2a314-150">Rimozione di dati da un oggetto dati</span><span class="sxs-lookup"><span data-stu-id="2a314-150">Removing Data From a Data Object</span></span>  
 <span data-ttu-id="2a314-151">I dati non possono essere rimossi direttamente da un oggetto dati.</span><span class="sxs-lookup"><span data-stu-id="2a314-151">Data cannot be directly removed from a data object.</span></span>  <span data-ttu-id="2a314-152">Per rimuovere efficacemente i dati da un oggetto dati, attenersi alla procedura seguente:</span><span class="sxs-lookup"><span data-stu-id="2a314-152">To effectively remove data from a data object, follow these steps:</span></span>  
  
1. <span data-ttu-id="2a314-153">Creare un nuovo oggetto dati che conterrà solo i dati che si desidera mantenere.</span><span class="sxs-lookup"><span data-stu-id="2a314-153">Create a new data object that will contain only the data you want to retain.</span></span>  
  
2. <span data-ttu-id="2a314-154">"Copiare" i dati desiderati dall'oggetto dati precedente al nuovo oggetto dati.</span><span class="sxs-lookup"><span data-stu-id="2a314-154">"Copy" the desired data from the old data object to the new data object.</span></span>  <span data-ttu-id="2a314-155">Per copiare i dati, utilizzare uno dei <xref:System.Windows.DataObject.GetData%2A> metodi per recuperare un <xref:System.Object> oggetto che contiene i dati non elaborati, <xref:System.Windows.DataObject.SetData%2A> quindi utilizzare uno dei metodi per aggiungere i dati al nuovo oggetto dati.</span><span class="sxs-lookup"><span data-stu-id="2a314-155">To copy the data, use one of the <xref:System.Windows.DataObject.GetData%2A> methods to retrieve an <xref:System.Object> that contains the raw data, and then use one of the <xref:System.Windows.DataObject.SetData%2A> methods to add the data to the new data object.</span></span>  
  
3. <span data-ttu-id="2a314-156">Sostituire l'oggetto dati precedente con quello nuovo.</span><span class="sxs-lookup"><span data-stu-id="2a314-156">Replace the old data object with the new one.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="2a314-157">I <xref:System.Windows.DataObject.SetData%2A> metodi aggiungono solo dati a un oggetto dati, ma non sostituiscono i dati, anche se i dati e il formato dati sono esattamente uguali a quelli di una chiamata precedente.</span><span class="sxs-lookup"><span data-stu-id="2a314-157">The <xref:System.Windows.DataObject.SetData%2A> methods only add data to a data object; they do not replace data, even if the data and data format are exactly the same as a previous call.</span></span> <span data-ttu-id="2a314-158">La <xref:System.Windows.DataObject.SetData%2A> chiamata di due volte per gli stessi dati e il formato dati comporterà la presenza del formato dati/dati due volte nell'oggetto dati.</span><span class="sxs-lookup"><span data-stu-id="2a314-158">Calling <xref:System.Windows.DataObject.SetData%2A> twice for the same data and data format will result in the data/data format being present twice in the data object.</span></span>
