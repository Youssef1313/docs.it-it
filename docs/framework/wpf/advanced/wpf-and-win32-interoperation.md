---
title: Interoperatività di WPF e Win32
ms.date: 03/30/2017
helpviewer_keywords:
- hosting WPF content in Win32 window [WPF]
- HWND interop [WPF]
- Win32 code [WPF], WPF interoperation
- interoperability [WPF], Win32
ms.assetid: 0ffbde0d-701d-45a3-a6fa-dd71f4d9772e
ms.openlocfilehash: 7248b0e5abcf2c6357dc7ce7c708eaa85358061a
ms.sourcegitcommit: 337bdc5a463875daf2cc6883e5a2da97d56f5000
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/24/2019
ms.locfileid: "72846801"
---
# <a name="wpf-and-win32-interoperation"></a><span data-ttu-id="0e6a3-102">Interoperatività di WPF e Win32</span><span class="sxs-lookup"><span data-stu-id="0e6a3-102">WPF and Win32 Interoperation</span></span>

<span data-ttu-id="0e6a3-103">Questo argomento fornisce una panoramica dell'interoperatività tra codice [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] e [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)].</span><span class="sxs-lookup"><span data-stu-id="0e6a3-103">This topic provides an overview of how to interoperate [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] and [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] code.</span></span> [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] <span data-ttu-id="0e6a3-104">fornisce un ambiente completo per la creazione di applicazioni.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-104">provides a rich environment for creating applications.</span></span> <span data-ttu-id="0e6a3-105">Tuttavia, se si ha una grande quantità di codice [!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)], può essere più efficace riutilizzare tale codice.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-105">However, when you have a substantial investment in [!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)] code, it might be more effective to reuse some of that code.</span></span>

<a name="basics"></a>

## <a name="wpf-and-win32-interoperation-basics"></a><span data-ttu-id="0e6a3-106">Nozioni di base sull'interoperatività di WPF e Win32</span><span class="sxs-lookup"><span data-stu-id="0e6a3-106">WPF and Win32 Interoperation Basics</span></span>

<span data-ttu-id="0e6a3-107">Ci sono due tecniche di base per l'interoperatività tra codice [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] e [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)].</span><span class="sxs-lookup"><span data-stu-id="0e6a3-107">There are two basic techniques for interoperation between [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] and [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] code.</span></span>

- <span data-ttu-id="0e6a3-108">Ospitare il contenuto [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] in una finestra [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)].</span><span class="sxs-lookup"><span data-stu-id="0e6a3-108">Host [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window.</span></span> <span data-ttu-id="0e6a3-109">Con questa tecnica, è possibile usare le funzionalità grafiche avanzate di [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] nel framework di una finestra e di un'applicazione [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] standard.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-109">With this technique, you can use the advanced graphics capabilities of [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] within the framework of a standard [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window and application.</span></span>

- <span data-ttu-id="0e6a3-110">Ospitare una finestra [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] nel contenuto [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="0e6a3-110">Host a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="0e6a3-111">Con questa tecnica, è possibile usare un controllo [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] personalizzato esistente nel contesto di altro contenuto [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] e passare i dati attraversando i limiti.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-111">With this technique, you can use an existing custom [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] control in the context of other [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, and pass data across the boundaries.</span></span>

<span data-ttu-id="0e6a3-112">Questo argomento illustra concettualmente queste due tecniche.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-112">Each of these techniques is conceptually introduced in this topic.</span></span> <span data-ttu-id="0e6a3-113">Per informazioni maggiormente orientate al codice relative all'hosting di [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] in [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)], vedere [Procedura dettagliata: hosting di contenuto WPF in Win32](walkthrough-hosting-wpf-content-in-win32.md).</span><span class="sxs-lookup"><span data-stu-id="0e6a3-113">For a more code-oriented illustration of hosting [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] in [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)], see [Walkthrough: Hosting WPF Content in Win32](walkthrough-hosting-wpf-content-in-win32.md).</span></span> <span data-ttu-id="0e6a3-114">Per informazioni maggiormente orientate al codice relative all'hosting di [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], vedere [Procedura dettagliata: hosting di un controllo Win32 in WPF](walkthrough-hosting-a-win32-control-in-wpf.md).</span><span class="sxs-lookup"><span data-stu-id="0e6a3-114">For a more code-oriented illustration of hosting [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], see [Walkthrough: Hosting a Win32 Control in WPF](walkthrough-hosting-a-win32-control-in-wpf.md).</span></span>

<a name="projects"></a>

## <a name="wpf-interoperation-projects"></a><span data-ttu-id="0e6a3-115">Progetti di interoperatività WPF</span><span class="sxs-lookup"><span data-stu-id="0e6a3-115">WPF Interoperation Projects</span></span>

[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <span data-ttu-id="0e6a3-116">API sono codice gestito, ma la maggior parte dei programmi di [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] esistenti viene scritta C++in non gestita.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-116">APIs are managed code, but most existing [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] programs are written in unmanaged C++.</span></span>  <span data-ttu-id="0e6a3-117">Non è possibile chiamare [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] API da un vero programma non gestito.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-117">You cannot call [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] APIs from a true unmanaged program.</span></span> <span data-ttu-id="0e6a3-118">Tuttavia, usando l'opzione `/clr` con il compilatore visuale C++ Microsoft, è possibile creare un programma misto gestito e non gestito in cui è possibile combinare facilmente le chiamate API gestite e non gestite.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-118">However, by using the `/clr` option with the Microsoft Visual C++ compiler, you can create a mixed managed-unmanaged program where you can seamlessly mix managed and unmanaged API calls.</span></span>

<span data-ttu-id="0e6a3-119">Una complicazione a livello di progetto è che non è possibile compilare [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] file C++ in un progetto.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-119">One project-level complication is that you cannot compile [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] files into a C++ project.</span></span>  <span data-ttu-id="0e6a3-120">Per ovviare a tale problema, ci sono diverse tecniche di divisione dei progetti.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-120">There are several project division techniques to compensate for this.</span></span>

- <span data-ttu-id="0e6a3-121">Creare una C# dll contenente tutte le pagine di [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]come assembly compilato e quindi fare in modo che C++ il file eseguibile includa tale DLL come riferimento.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-121">Create a C# DLL that contains all your [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] pages as a compiled assembly, and then have your C++ executable include that DLL as a reference.</span></span>

- <span data-ttu-id="0e6a3-122">Creare un C# eseguibile per il contenuto del[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]e fare in riferimento C++ a una dll che contiene il contenuto del[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)].</span><span class="sxs-lookup"><span data-stu-id="0e6a3-122">Create a C# executable for the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, and have it reference a C++ DLL that contains the [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] content.</span></span>

- <span data-ttu-id="0e6a3-123">Usare <xref:System.Windows.Markup.XamlReader.Load%2A> per caricare qualsiasi [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] in fase di esecuzione, anziché compilare il [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span><span class="sxs-lookup"><span data-stu-id="0e6a3-123">Use <xref:System.Windows.Markup.XamlReader.Load%2A> to load any [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] at run time, instead of compiling your [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span></span>

- <span data-ttu-id="0e6a3-124">Non usare [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] e scrivere tutti i [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] nel codice, costruendo l'albero degli elementi da <xref:System.Windows.Application>.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-124">Do not use [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] at all, and write all your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] in code, building up the element tree from <xref:System.Windows.Application>.</span></span>

<span data-ttu-id="0e6a3-125">Usare l'approccio che meglio soddisfa le esigenze.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-125">Use whatever approach works best for you.</span></span>

> [!NOTE]
> <span data-ttu-id="0e6a3-126">Se non è stato usato C++/CLI in precedenza, è possibile notare alcune parole chiave "nuove", ad esempio`gcnew`e`nullptr`negli esempi di codice di interoperabilità.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-126">If you have not used C++/CLI before, you might notice some "new" keywords such as `gcnew` and `nullptr` in the interoperation code examples.</span></span> <span data-ttu-id="0e6a3-127">Queste parole chiave sostituiscono la sintassi di doppio sottolineatura precedente (`__gc`) e forniscono una sintassi più naturale per il C++codice gestito in.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-127">These keywords supersede the older double-underscore syntax (`__gc`) and provide a more natural syntax for managed code in C++.</span></span>  <span data-ttu-id="0e6a3-128">Per ulteriori informazioni sulle funzionalità C++gestite di/CLI, vedere [estensioni dei componenti per le piattaforme di runtime](/cpp/windows/component-extensions-for-runtime-platforms).</span><span class="sxs-lookup"><span data-stu-id="0e6a3-128">To learn more about the C++/CLI managed features, see [Component Extensions for Runtime Platforms](/cpp/windows/component-extensions-for-runtime-platforms).</span></span>

<a name="hwnds"></a>

## <a name="how-wpf-uses-hwnds"></a><span data-ttu-id="0e6a3-129">Modo d'uso degli handle di finestra (HWND) in WPF</span><span class="sxs-lookup"><span data-stu-id="0e6a3-129">How WPF Uses Hwnds</span></span>

<span data-ttu-id="0e6a3-130">Per sfruttare al meglio le caratteristiche di "interoperatività HWND" di [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], è necessario capire in che modo [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] usa gli handle di finestra (HWND).</span><span class="sxs-lookup"><span data-stu-id="0e6a3-130">To make the most of [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] "HWND interop", you need to understand how [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] uses HWNDs.</span></span> <span data-ttu-id="0e6a3-131">Per qualsiasi HWND, non è possibile combinare [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] rendering con il rendering DirectX o il rendering GDI/GDI+.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-131">For any HWND, you cannot mix [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] rendering with DirectX rendering or GDI / GDI+ rendering.</span></span> <span data-ttu-id="0e6a3-132">Questo comporta diverse implicazioni.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-132">This has a number of implications.</span></span> <span data-ttu-id="0e6a3-133">In primo luogo, per combinare questi modelli di rendering, è necessario creare una soluzione di interoperatività e usare segmenti designati di interoperatività per ogni modello di rendering che si sceglie di usare.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-133">Primarily, in order to mix these rendering models at all, you must create an interoperation solution, and use designated segments of interoperation for each rendering model that you choose to use.</span></span> <span data-ttu-id="0e6a3-134">Il comportamento di rendering crea inoltre una restrizione di "spazio aereo" per le operazioni che la soluzione di interoperatività può completare.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-134">Also, the rendering behavior creates an "airspace" restriction for what your interoperation solution can accomplish.</span></span> <span data-ttu-id="0e6a3-135">Il concetto di "spazio aereo" è illustrato più dettagliatamente nell'argomento [Cenni preliminari sulle aree di tecnologia](technology-regions-overview.md).</span><span class="sxs-lookup"><span data-stu-id="0e6a3-135">The "airspace" concept is explained in greater detail in the topic [Technology Regions Overview](technology-regions-overview.md).</span></span>

<span data-ttu-id="0e6a3-136">Tutti gli elementi [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] nella schermata sono supportati da un oggetto HWND.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-136">All [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] elements on the screen are ultimately backed by a HWND.</span></span> <span data-ttu-id="0e6a3-137">Quando si crea un [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.Window>, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] crea un HWND di primo livello e utilizza un <xref:System.Windows.Interop.HwndSource> per inserire il <xref:System.Windows.Window> e il relativo contenuto [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] all'interno di HWND.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-137">When you create a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.Window>, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] creates a top-level HWND, and uses an <xref:System.Windows.Interop.HwndSource> to put the <xref:System.Windows.Window> and its [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content inside the HWND.</span></span>  <span data-ttu-id="0e6a3-138">Il resto del contenuto [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] nell'applicazione condivide tale oggetto HWND singolo.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-138">The rest of your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in the application shares that singular HWND.</span></span> <span data-ttu-id="0e6a3-139">Un'eccezione è costituita da menu, caselle combinate a discesa e altri popup.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-139">An exception is menus, combo box drop downs, and other pop-ups.</span></span> <span data-ttu-id="0e6a3-140">Poiché questi elementi creano una propria finestra di primo livello, è possibile che un menu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] superi potenzialmente il bordo dell'oggetto HWND della finestra che lo contiene.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-140">These elements create their own top-level window, which is why a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] menu can potentially go past the edge of the window HWND that contains it.</span></span> <span data-ttu-id="0e6a3-141">Quando si utilizza <xref:System.Windows.Interop.HwndHost> per inserire un HWND all'interno di [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] informa [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] come posizionare il nuovo HWND figlio rispetto al [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] HWND <xref:System.Windows.Window>.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-141">When you use <xref:System.Windows.Interop.HwndHost> to put an HWND inside [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] informs [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] how to position the new child HWND relative to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.Window> HWND.</span></span>

<span data-ttu-id="0e6a3-142">Un concetto correlato a HWND è la trasparenza all'interno di ogni oggetto HWND e tra tali oggetti.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-142">A related concept to HWND is transparency within and between each HWND.</span></span> <span data-ttu-id="0e6a3-143">Questo concetto è illustrato anche nell'argomento [Cenni preliminari sulle aree di tecnologia](technology-regions-overview.md).</span><span class="sxs-lookup"><span data-stu-id="0e6a3-143">This is also discussed in the topic [Technology Regions Overview](technology-regions-overview.md).</span></span>

<a name="hosting_a_wpf_page"></a>

## <a name="hosting-wpf-content-in-a-microsoft-win32-window"></a><span data-ttu-id="0e6a3-144">Hosting di contenuto WPF in una finestra Microsoft Win32</span><span class="sxs-lookup"><span data-stu-id="0e6a3-144">Hosting WPF Content in a Microsoft Win32 Window</span></span>

<span data-ttu-id="0e6a3-145">La chiave per ospitare un [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] in una finestra di [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] è la classe <xref:System.Windows.Interop.HwndSource>.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-145">The key to hosting a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] on a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window is the <xref:System.Windows.Interop.HwndSource> class.</span></span> <span data-ttu-id="0e6a3-146">Questa classe esegue il wrapping del contenuto [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] in una finestra [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)], consentendo di incorporare il contenuto [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] nell'[!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] come finestra figlio.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-146">This class wraps the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window, so that the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content can be incorporated into your [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] as a child window.</span></span> <span data-ttu-id="0e6a3-147">Nell'approccio che segue, [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] e [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] sono combinati in un'unica applicazione.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-147">The following approach combines the [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] and [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] in a single application.</span></span>

1. <span data-ttu-id="0e6a3-148">Implementare il contenuto [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] (elemento radice del contenuto) come classe gestita.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-148">Implement your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content (the content root element) as a managed class.</span></span> <span data-ttu-id="0e6a3-149">In genere, la classe eredita da una delle classi che possono contenere più elementi figlio e/o usata come elemento radice, ad esempio <xref:System.Windows.Controls.DockPanel> o <xref:System.Windows.Controls.Page>.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-149">Typically, the class inherits from one of the classes that can contain multiple child elements and/or used as a root element, such as <xref:System.Windows.Controls.DockPanel> or <xref:System.Windows.Controls.Page>.</span></span> <span data-ttu-id="0e6a3-150">Nei passaggi successivi questa classe è detta classe contenuto [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] e le istanze della classe sono dette oggetti contenuto [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="0e6a3-150">In subsequent steps, this class is referred to as the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content class, and instances of the class are referred to as [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content objects.</span></span>

2. <span data-ttu-id="0e6a3-151">Implementare un'applicazione Windows con C++/cli.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-151">Implement a Windows application with C++/CLI.</span></span> <span data-ttu-id="0e6a3-152">Se si inizia con un' C++ applicazione non gestita esistente, in genere è possibile abilitarla per chiamare il codice gestito modificando le impostazioni del progetto in modo da includere il flag del compilatore`/clr`(l'ambito completo di ciò che potrebbe essere necessario per supportare la compilazione`/clr`non è descritto in questo argomento).</span><span class="sxs-lookup"><span data-stu-id="0e6a3-152">If you are starting with an existing unmanaged C++ application, you can usually enable it to call managed code by changing your project settings to include the `/clr` compiler flag (the full scope of what might be necessary to support `/clr` compilation is not described in this topic).</span></span>

3. <span data-ttu-id="0e6a3-153">Impostare il modello di threading su apartment a thread singolo (STA, Single Threaded Apartment).</span><span class="sxs-lookup"><span data-stu-id="0e6a3-153">Set the threading model to Single Threaded Apartment (STA).</span></span> [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <span data-ttu-id="0e6a3-154">usa questo modello di threading.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-154">uses this threading model.</span></span>

4. <span data-ttu-id="0e6a3-155">Gestire la notifica WM_CREATE nella procedura di finestra.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-155">Handle the WM_CREATE notification in your window procedure.</span></span>

5. <span data-ttu-id="0e6a3-156">All'interno del gestore (o di una funzione chiamata dal gestore) eseguire queste operazioni:</span><span class="sxs-lookup"><span data-stu-id="0e6a3-156">Within the handler (or a function that the handler calls), do the following:</span></span>

    1. <span data-ttu-id="0e6a3-157">Creare un nuovo oggetto <xref:System.Windows.Interop.HwndSource> con HWND della finestra padre come parametro di `parent`.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-157">Create a new <xref:System.Windows.Interop.HwndSource> object with the parent window HWND as its `parent` parameter.</span></span>

    2. <span data-ttu-id="0e6a3-158">Creare un'istanza della classe contenuto [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="0e6a3-158">Create an instance of your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content class.</span></span>

    3. <span data-ttu-id="0e6a3-159">Assegnare un riferimento all'oggetto [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contenuto alla proprietà <xref:System.Windows.Interop.HwndSource> oggetto <xref:System.Windows.Interop.HwndSource.RootVisual%2A>.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-159">Assign a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object to the <xref:System.Windows.Interop.HwndSource> object <xref:System.Windows.Interop.HwndSource.RootVisual%2A> property.</span></span>

    4. <span data-ttu-id="0e6a3-160">La proprietà <xref:System.Windows.Interop.HwndSource> oggetto <xref:System.Windows.Interop.HwndSource.Handle%2A> contiene l'handle di finestra (HWND).</span><span class="sxs-lookup"><span data-stu-id="0e6a3-160">The <xref:System.Windows.Interop.HwndSource> object <xref:System.Windows.Interop.HwndSource.Handle%2A> property contains the window handle (HWND).</span></span> <span data-ttu-id="0e6a3-161">Per ottenere un HWND utilizzabile nella parte non gestita dell'applicazione, eseguire il cast di `Handle.ToPointer()` a un HWND.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-161">To get an HWND that you can use in the unmanaged part of your application, cast `Handle.ToPointer()` to an HWND.</span></span>

6. <span data-ttu-id="0e6a3-162">Implementare una classe gestita che include un campo statico contenente un riferimento all'oggetto contenuto [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="0e6a3-162">Implement a managed class that contains a static field that holds a reference to your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object.</span></span> <span data-ttu-id="0e6a3-163">Questa classe consente di ottenere un riferimento all'oggetto [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contenuto dal codice [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)], ma soprattutto impedisce che la <xref:System.Windows.Interop.HwndSource> venga inavvertitamente sottoposta a Garbage Collection.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-163">This class allows you to get a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object from your [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] code, but more importantly it prevents your <xref:System.Windows.Interop.HwndSource> from being inadvertently garbage collected.</span></span>

7. <span data-ttu-id="0e6a3-164">Ricevere notifiche dall'oggetto contenuto [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] associando un gestore a uno o più eventi dell'oggetto contenuto [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="0e6a3-164">Receive notifications from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object by attaching a handler to one or more of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object events.</span></span>

8. <span data-ttu-id="0e6a3-165">Comunicare con l'oggetto contenuto [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] usando il riferimento archiviato nel campo statico per impostare proprietà, chiamare metodi e così via.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-165">Communicate with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object by using the reference that you stored in the static field to set properties, call methods, etc.</span></span>

> [!NOTE]
> <span data-ttu-id="0e6a3-166">Tutte le attività di definizione della classe contenuto [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], o alcune di esse, per il primo passaggio in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] possono essere eseguite usando la classe parziale predefinita della classe contenuto, se si genera un assembly separato e quindi vi si fa riferimento.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-166">You can do some or all of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content class definition for Step One in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] using the default partial class of the content class, if you produce a separate assembly and then reference it.</span></span> <span data-ttu-id="0e6a3-167">Sebbene in genere si includa un oggetto <xref:System.Windows.Application> come parte della compilazione del [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] in un assembly, non si finisce di utilizzare tale <xref:System.Windows.Application> come parte dell'interoperabilità, è sufficiente utilizzare una o più classi radice per i file [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] a cui fa riferimento l'applicazione. e fanno riferimento alle classi parziali.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-167">Although you typically include an <xref:System.Windows.Application> object as part of compiling the [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] into an assembly, you do not end up using that <xref:System.Windows.Application> as part of the interoperation, you just use one or more of the root classes for [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] files referred to by the application and reference their partial classes.</span></span> <span data-ttu-id="0e6a3-168">La parte restante della procedura è essenzialmente simile a quella appena descritta.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-168">The remainder of the procedure is essentially similar to that outlined above.</span></span>
>
> <span data-ttu-id="0e6a3-169">Ognuno di questi passaggi viene illustrato tramite il codice nell'argomento [Procedura dettagliata: hosting di contenuto WPF in Win32](walkthrough-hosting-wpf-content-in-win32.md).</span><span class="sxs-lookup"><span data-stu-id="0e6a3-169">Each of these steps is illustrated through code in the topic [Walkthrough: Hosting WPF Content in Win32](walkthrough-hosting-wpf-content-in-win32.md).</span></span>

<a name="hosting_an_hwnd"></a>

## <a name="hosting-a-microsoft-win32-window-in-wpf"></a><span data-ttu-id="0e6a3-170">Hosting di una finestra Microsoft Win32 in WPF</span><span class="sxs-lookup"><span data-stu-id="0e6a3-170">Hosting a Microsoft Win32 Window in WPF</span></span>

<span data-ttu-id="0e6a3-171">La chiave per ospitare una finestra [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] all'interno di altri [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contenuto è la classe <xref:System.Windows.Interop.HwndHost>.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-171">The key to hosting a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window within other [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is the <xref:System.Windows.Interop.HwndHost> class.</span></span> <span data-ttu-id="0e6a3-172">Questa classe esegue il wrapping della finestra in un elemento [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] che può essere aggiunto a un albero degli elementi [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="0e6a3-172">This class wraps the window in a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] element which can be added to a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] element tree.</span></span> <span data-ttu-id="0e6a3-173"><xref:System.Windows.Interop.HwndHost> supporta anche le API che consentono di eseguire attività quali l'elaborazione dei messaggi per la finestra ospitata.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-173"><xref:System.Windows.Interop.HwndHost> also supports APIs that allow you to do such tasks as process messages for the hosted window.</span></span> <span data-ttu-id="0e6a3-174">La procedura di base è la seguente:</span><span class="sxs-lookup"><span data-stu-id="0e6a3-174">The basic procedure is:</span></span>

1. <span data-ttu-id="0e6a3-175">Creare un albero degli elementi per un'applicazione [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] (tramite codice o markup).</span><span class="sxs-lookup"><span data-stu-id="0e6a3-175">Create an element tree for a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] application (can be through code or markup).</span></span> <span data-ttu-id="0e6a3-176">Trovare un punto appropriato e ammissibile nell'albero degli elementi in cui è possibile aggiungere l'implementazione del <xref:System.Windows.Interop.HwndHost> come elemento figlio.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-176">Find an appropriate and permissible point in the element tree where the <xref:System.Windows.Interop.HwndHost> implementation can be added as a child element.</span></span> <span data-ttu-id="0e6a3-177">Nei restanti passaggi questo elemento viene chiamato elemento di riserva.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-177">In the remainder of these steps, this element is referred to as the reserving element.</span></span>

2. <span data-ttu-id="0e6a3-178">Derivare da <xref:System.Windows.Interop.HwndHost> per creare un oggetto che include il contenuto del [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)].</span><span class="sxs-lookup"><span data-stu-id="0e6a3-178">Derive from <xref:System.Windows.Interop.HwndHost> to create an object that holds your [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] content.</span></span>

3. <span data-ttu-id="0e6a3-179">In tale classe host, eseguire l'override del metodo <xref:System.Windows.Interop.HwndHost> <xref:System.Windows.Interop.HwndHost.BuildWindowCore%2A>.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-179">In that host class, override the <xref:System.Windows.Interop.HwndHost> method <xref:System.Windows.Interop.HwndHost.BuildWindowCore%2A>.</span></span> <span data-ttu-id="0e6a3-180">Restituire l'oggetto HWND della finestra ospitata.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-180">Return the HWND of the hosted window.</span></span> <span data-ttu-id="0e6a3-181">Può essere necessario eseguire il wrapping dei controlli effettivi come finestra figlio della finestra restituita. Il wrapping dei controlli in una finestra host offre un modo semplice per consentire al contenuto [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] di ricevere notifiche dai controlli.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-181">You might want to wrap the actual control(s) as a child window of the returned window; wrapping the controls in a host window provides a simple way for your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content to receive notifications from the controls.</span></span> <span data-ttu-id="0e6a3-182">Questa tecnica aiuta a correggere alcuni problemi di [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] relativi alla gestione dei messaggi in corrispondenza del limite del controllo ospitato.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-182">This technique helps correct for some [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] issues regarding message handling at the hosted control boundary.</span></span>

4. <span data-ttu-id="0e6a3-183">Eseguire l'override dei metodi di <xref:System.Windows.Interop.HwndHost> <xref:System.Windows.Interop.HwndHost.DestroyWindowCore%2A> e <xref:System.Windows.Interop.HwndHost.WndProc%2A>.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-183">Override the <xref:System.Windows.Interop.HwndHost> methods <xref:System.Windows.Interop.HwndHost.DestroyWindowCore%2A> and <xref:System.Windows.Interop.HwndHost.WndProc%2A>.</span></span> <span data-ttu-id="0e6a3-184">Lo scopo è quello di eseguire la pulizia e rimuovere i riferimenti al contenuto ospitato, in particolare se sono stati creati riferimenti a oggetti non gestiti.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-184">The intention here is to process cleanup and remove references to the hosted content, particularly if you created references to unmanaged objects.</span></span>

5. <span data-ttu-id="0e6a3-185">Nel file code-behind creare un'istanza della classe di hosting del controllo e impostarla come figlio dell'elemento di riserva.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-185">In your code-behind file, create an instance of the control hosting class and make it a child of the reserving element.</span></span> <span data-ttu-id="0e6a3-186">In genere si usa un gestore eventi, ad esempio <xref:System.Windows.FrameworkElement.Loaded>, oppure si usa il costruttore della classe parziale.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-186">Typically you would use an event handler such as <xref:System.Windows.FrameworkElement.Loaded>, or use the partial class constructor.</span></span> <span data-ttu-id="0e6a3-187">È però anche possibile aggiungere il contenuto di interoperatività tramite un comportamento di runtime.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-187">But you could also add the interoperation content through a runtime behavior.</span></span>

6. <span data-ttu-id="0e6a3-188">Elaborare i messaggi della finestra selezionati, ad esempio le notifiche dei controlli.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-188">Process selected window messages, such as control notifications.</span></span> <span data-ttu-id="0e6a3-189">Ci sono due approcci.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-189">There are two approaches.</span></span> <span data-ttu-id="0e6a3-190">Entrambi offrono un accesso identico al flusso di messaggi, quindi la scelta dipende per lo più dalle esigenze di programmazione.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-190">Both provide identical access to the message stream, so your choice is largely a matter of programming convenience.</span></span>

    - <span data-ttu-id="0e6a3-191">Implementare l'elaborazione del messaggio per tutti i messaggi (non solo per i messaggi di arresto) nell'override del metodo <xref:System.Windows.Interop.HwndHost> <xref:System.Windows.Interop.HwndHost.WndProc%2A>.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-191">Implement message processing for all messages (not just shutdown messages) in your override of the <xref:System.Windows.Interop.HwndHost> method <xref:System.Windows.Interop.HwndHost.WndProc%2A>.</span></span>

    - <span data-ttu-id="0e6a3-192">Fare in modo che l'elemento host [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] elabori i messaggi gestendo l'evento <xref:System.Windows.Interop.HwndHost.MessageHook>.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-192">Have the hosting [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] element process the messages by handling the <xref:System.Windows.Interop.HwndHost.MessageHook> event.</span></span> <span data-ttu-id="0e6a3-193">Questo evento viene generato per ogni messaggio inviato alla procedura di finestra principale della finestra ospitata.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-193">This event is raised for every message that is sent to the main window procedure of the hosted window.</span></span>

    - <span data-ttu-id="0e6a3-194">Non è possibile elaborare messaggi da finestre che non sono in corso di elaborazione utilizzando <xref:System.Windows.Interop.HwndHost.WndProc%2A>.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-194">You cannot process messages from windows that are out of process using <xref:System.Windows.Interop.HwndHost.WndProc%2A>.</span></span>

7. <span data-ttu-id="0e6a3-195">Comunicare con la finestra ospitata usando platform invoke per chiamare la funzione `SendMessage` non gestita.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-195">Communicate with the hosted window by using platform invoke to call the unmanaged `SendMessage` function.</span></span>

<span data-ttu-id="0e6a3-196">Questi passaggi consentono di creare un'applicazione che funziona con l'input del mouse.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-196">Following these steps creates an application that works with mouse input.</span></span> <span data-ttu-id="0e6a3-197">È possibile aggiungere il supporto di tabulazione per la finestra ospitata implementando l'interfaccia <xref:System.Windows.Interop.IKeyboardInputSink>.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-197">You can add tabbing support for your hosted window by implementing the <xref:System.Windows.Interop.IKeyboardInputSink> interface.</span></span>

<span data-ttu-id="0e6a3-198">Ognuno di questi passaggi viene illustrato tramite il codice nell'argomento [Procedura dettagliata: hosting di un controllo Win32 in WPF](walkthrough-hosting-a-win32-control-in-wpf.md).</span><span class="sxs-lookup"><span data-stu-id="0e6a3-198">Each of these steps is illustrated through code in the topic [Walkthrough: Hosting a Win32 Control in WPF](walkthrough-hosting-a-win32-control-in-wpf.md).</span></span>

### <a name="hwnds-inside-wpf"></a><span data-ttu-id="0e6a3-199">Handle di finestra (HWND) in WPF</span><span class="sxs-lookup"><span data-stu-id="0e6a3-199">Hwnds Inside WPF</span></span>

<span data-ttu-id="0e6a3-200">È possibile considerare <xref:System.Windows.Interop.HwndHost> come un controllo speciale.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-200">You can think of <xref:System.Windows.Interop.HwndHost> as a special control.</span></span> <span data-ttu-id="0e6a3-201">Tecnicamente, <xref:System.Windows.Interop.HwndHost> è una classe derivata <xref:System.Windows.FrameworkElement>, non una classe derivata <xref:System.Windows.Controls.Control>, ma può essere considerata un controllo per l'interoperabilità. <xref:System.Windows.Interop.HwndHost> astrae la natura [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] sottostante del contenuto ospitato in modo che il resto del [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] consideri il contenuto ospitato come un altro oggetto simile a un controllo, che deve eseguire il rendering e l'elaborazione dell'input.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-201">(Technically, <xref:System.Windows.Interop.HwndHost> is a <xref:System.Windows.FrameworkElement> derived class, not a <xref:System.Windows.Controls.Control> derived class, but it can be considered a control for purposes of interoperation.) <xref:System.Windows.Interop.HwndHost> abstracts the underlying [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] nature of the hosted content such that the remainder of [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] considers the hosted content to be another control-like object, which should render and process input.</span></span> <span data-ttu-id="0e6a3-202"><xref:System.Windows.Interop.HwndHost> in genere si comporta in modo analogo a qualsiasi altra [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.FrameworkElement>, anche se esistono alcune importanti differenze nell'output (disegno e grafica) e input (mouse e tastiera) in base alle limitazioni di ciò che gli HWND sottostanti sono in grado di supportare.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-202"><xref:System.Windows.Interop.HwndHost> generally behaves like any other [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.FrameworkElement>, although there are some important differences around output (drawing and graphics) and input (mouse and keyboard) based on limitations of what the underlying HWNDs can support.</span></span>

#### <a name="notable-differences-in-output-behavior"></a><span data-ttu-id="0e6a3-203">Differenze rilevanti nel comportamento di output</span><span class="sxs-lookup"><span data-stu-id="0e6a3-203">Notable Differences in Output Behavior</span></span>

- <span data-ttu-id="0e6a3-204"><xref:System.Windows.FrameworkElement>, ovvero la classe di base <xref:System.Windows.Interop.HwndHost>, presenta alcune proprietà che implicano modifiche all'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-204"><xref:System.Windows.FrameworkElement>, which is the <xref:System.Windows.Interop.HwndHost> base class, has quite a few properties that imply changes to the UI.</span></span> <span data-ttu-id="0e6a3-205">Sono incluse proprietà come <xref:System.Windows.FrameworkElement.FlowDirection%2A?displayProperty=nameWithType>, che modifica il layout degli elementi all'interno di tale elemento come padre.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-205">These include properties such as <xref:System.Windows.FrameworkElement.FlowDirection%2A?displayProperty=nameWithType>, which changes the layout of elements within that element as a parent.</span></span> <span data-ttu-id="0e6a3-206">La maggior parte di queste proprietà non è tuttavia mappata a possibili equivalenti [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)], anche se tali equivalenti possono essere presenti.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-206">However, most of these properties are not mapped to possible [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] equivalents, even if such equivalents might exist.</span></span> <span data-ttu-id="0e6a3-207">Poiché un numero elevato di queste proprietà e dei relativi significati è troppo specifico della tecnologia di rendering, il mapping non è una soluzione pratica.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-207">Too many of these properties and their meanings are too rendering-technology specific for mappings to be practical.</span></span> <span data-ttu-id="0e6a3-208">Di conseguenza, l'impostazione di proprietà quali <xref:System.Windows.FrameworkElement.FlowDirection%2A> su <xref:System.Windows.Interop.HwndHost> non ha alcun effetto.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-208">Therefore, setting properties such as <xref:System.Windows.FrameworkElement.FlowDirection%2A> on <xref:System.Windows.Interop.HwndHost> has no effect.</span></span>

- <span data-ttu-id="0e6a3-209"><xref:System.Windows.Interop.HwndHost> non possono essere ruotate, ridimensionate, inclinate o modificate in altro modo da una trasformazione.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-209"><xref:System.Windows.Interop.HwndHost> cannot be rotated, scaled, skewed, or otherwise affected by a Transform.</span></span>

- <span data-ttu-id="0e6a3-210"><xref:System.Windows.Interop.HwndHost> non supporta la proprietà <xref:System.Windows.UIElement.Opacity%2A> (fusione alfa).</span><span class="sxs-lookup"><span data-stu-id="0e6a3-210"><xref:System.Windows.Interop.HwndHost> does not support the <xref:System.Windows.UIElement.Opacity%2A> property (alpha blending).</span></span> <span data-ttu-id="0e6a3-211">Se il contenuto all'interno del <xref:System.Windows.Interop.HwndHost> esegue <xref:System.Drawing> operazioni che includono informazioni Alpha, non si tratta di una violazione, ma l'<xref:System.Windows.Interop.HwndHost> nel suo complesso supporta solo l'opacità = 1,0 (100%).</span><span class="sxs-lookup"><span data-stu-id="0e6a3-211">If content inside the <xref:System.Windows.Interop.HwndHost> performs <xref:System.Drawing> operations that include alpha information, that is itself not a violation, but the <xref:System.Windows.Interop.HwndHost> as a whole only supports Opacity = 1.0 (100%).</span></span>

- <span data-ttu-id="0e6a3-212"><xref:System.Windows.Interop.HwndHost> verranno visualizzati sopra gli altri elementi [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] nella stessa finestra di primo livello.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-212"><xref:System.Windows.Interop.HwndHost> will appear on top of other [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] elements in the same top-level window.</span></span> <span data-ttu-id="0e6a3-213">Tuttavia, un menu <xref:System.Windows.Controls.ToolTip> o <xref:System.Windows.Controls.ContextMenu> generato è una finestra di primo livello distinta e quindi si comporterà correttamente con <xref:System.Windows.Interop.HwndHost>.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-213">However, a <xref:System.Windows.Controls.ToolTip> or <xref:System.Windows.Controls.ContextMenu> generated menu is a separate top-level window, and so will behave correctly with <xref:System.Windows.Interop.HwndHost>.</span></span>

- <span data-ttu-id="0e6a3-214"><xref:System.Windows.Interop.HwndHost> non rispetta l'area di visualizzazione del <xref:System.Windows.UIElement>padre.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-214"><xref:System.Windows.Interop.HwndHost> does not respect the clipping region of its parent <xref:System.Windows.UIElement>.</span></span> <span data-ttu-id="0e6a3-215">Si tratta potenzialmente di un problema se si tenta di inserire una classe <xref:System.Windows.Interop.HwndHost> all'interno di un'area di scorrimento o di un <xref:System.Windows.Controls.Canvas>.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-215">This is potentially an issue if you attempt to put an <xref:System.Windows.Interop.HwndHost> class inside a scrolling region or <xref:System.Windows.Controls.Canvas>.</span></span>

#### <a name="notable-differences-in-input-behavior"></a><span data-ttu-id="0e6a3-216">Differenze rilevanti nel comportamento di input</span><span class="sxs-lookup"><span data-stu-id="0e6a3-216">Notable Differences in Input Behavior</span></span>

- <span data-ttu-id="0e6a3-217">In generale, mentre l'ambito dei dispositivi di input è all'interno dell'area <xref:System.Windows.Interop.HwndHost> [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] ospitata, gli eventi di input passano direttamente al [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)].</span><span class="sxs-lookup"><span data-stu-id="0e6a3-217">In general, while input devices are scoped within the <xref:System.Windows.Interop.HwndHost> hosted [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] region, input events go directly to [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)].</span></span>

- <span data-ttu-id="0e6a3-218">Quando il mouse è posizionato sul <xref:System.Windows.Interop.HwndHost>, l'applicazione non riceve [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] eventi del mouse e il valore della proprietà [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.UIElement.IsMouseOver%2A> verrà `false`.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-218">While the mouse is over the <xref:System.Windows.Interop.HwndHost>, your application does not receive [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] mouse events, and the value of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] property <xref:System.Windows.UIElement.IsMouseOver%2A> will be `false`.</span></span>

- <span data-ttu-id="0e6a3-219">Mentre il <xref:System.Windows.Interop.HwndHost> ha lo stato attivo della tastiera, l'applicazione non riceverà [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] eventi della tastiera e il valore della proprietà [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.UIElement.IsKeyboardFocusWithin%2A> verrà `false`.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-219">While the <xref:System.Windows.Interop.HwndHost> has keyboard focus, your application will not receive [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] keyboard events and the value of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] property <xref:System.Windows.UIElement.IsKeyboardFocusWithin%2A> will be `false`.</span></span>

- <span data-ttu-id="0e6a3-220">Quando lo stato attivo è all'interno del <xref:System.Windows.Interop.HwndHost> e le modifiche apportate a un altro controllo all'interno del <xref:System.Windows.Interop.HwndHost>, l'applicazione non riceverà gli eventi di [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.UIElement.GotFocus> o <xref:System.Windows.UIElement.LostFocus>.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-220">When focus is within the <xref:System.Windows.Interop.HwndHost> and changes to another control inside the <xref:System.Windows.Interop.HwndHost>, your application will not receive the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] events <xref:System.Windows.UIElement.GotFocus> or <xref:System.Windows.UIElement.LostFocus>.</span></span>

- <span data-ttu-id="0e6a3-221">Le proprietà e gli eventi dello stilo correlati sono analoghi e non segnalano informazioni quando lo stilo è sopra <xref:System.Windows.Interop.HwndHost>.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-221">Related stylus properties and events are analogous, and do not report information while the stylus is over <xref:System.Windows.Interop.HwndHost>.</span></span>

<a name="tabbing_mnemonics_accelerators"></a>

## <a name="tabbing-mnemonics-and-accelerators"></a><span data-ttu-id="0e6a3-222">Tabulazioni, tasti di scelta e tasti di scelta rapida</span><span class="sxs-lookup"><span data-stu-id="0e6a3-222">Tabbing, Mnemonics, and Accelerators</span></span>

<span data-ttu-id="0e6a3-223">Le interfacce <xref:System.Windows.Interop.IKeyboardInputSink> e <xref:System.Windows.Interop.IKeyboardInputSite> consentono di creare un'esperienza di tastiera senza problemi per le applicazioni miste di [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] e [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)]:</span><span class="sxs-lookup"><span data-stu-id="0e6a3-223">The <xref:System.Windows.Interop.IKeyboardInputSink> and <xref:System.Windows.Interop.IKeyboardInputSite> interfaces allow you to create a seamless keyboard experience for mixed [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] and [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] applications:</span></span>

- <span data-ttu-id="0e6a3-224">Spostamento tra componenti [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] e [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] tramite il tasto TAB</span><span class="sxs-lookup"><span data-stu-id="0e6a3-224">Tabbing between [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] and [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] components</span></span>

- <span data-ttu-id="0e6a3-225">Tasti di scelta e tasti di scelta rapida che funzionano sia quando lo stato attivo è all'interno di un componente Win32 che quando è all'interno di un componente WPF.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-225">Mnemonics and accelerators that work both when focus is within a Win32 component and when it is within a WPF component.</span></span>

<span data-ttu-id="0e6a3-226">Le classi <xref:System.Windows.Interop.HwndHost> e <xref:System.Windows.Interop.HwndSource> forniscono entrambe le implementazioni di <xref:System.Windows.Interop.IKeyboardInputSink>, ma non possono gestire tutti i messaggi di input desiderati per scenari più avanzati.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-226">The <xref:System.Windows.Interop.HwndHost> and <xref:System.Windows.Interop.HwndSource> classes both provide implementations of <xref:System.Windows.Interop.IKeyboardInputSink>, but they may not handle all the input messages that you want for more advanced scenarios.</span></span> <span data-ttu-id="0e6a3-227">Eseguire l'override dei metodi appropriati per ottenere il comportamento di tastiera desiderato.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-227">Override the appropriate methods to get the keyboard behavior you want.</span></span>

<span data-ttu-id="0e6a3-228">Le interfacce forniscono supporto solo per le operazioni eseguite nella transizione tra le aree [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] e [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)].</span><span class="sxs-lookup"><span data-stu-id="0e6a3-228">The interfaces only provide support for what happens on the transition between the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] and [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] regions.</span></span> <span data-ttu-id="0e6a3-229">All'interno dell'area [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)], il comportamento di tabulazione è completamente controllato dalla logica implementata da [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] per la tabulazione, se presente.</span><span class="sxs-lookup"><span data-stu-id="0e6a3-229">Within the [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] region, tabbing behavior is entirely controlled by the [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] implemented logic for tabbing, if any.</span></span>

## <a name="see-also"></a><span data-ttu-id="0e6a3-230">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="0e6a3-230">See also</span></span>

- <xref:System.Windows.Interop.HwndHost>
- <xref:System.Windows.Interop.HwndSource>
- <xref:System.Windows.Interop>
- [<span data-ttu-id="0e6a3-231">Procedura dettagliata: Hosting di un controllo Win32 in WPF</span><span class="sxs-lookup"><span data-stu-id="0e6a3-231">Walkthrough: Hosting a Win32 Control in WPF</span></span>](walkthrough-hosting-a-win32-control-in-wpf.md)
- [<span data-ttu-id="0e6a3-232">Procedura dettagliata: hosting di contenuto WPF in Win32</span><span class="sxs-lookup"><span data-stu-id="0e6a3-232">Walkthrough: Hosting WPF Content in Win32</span></span>](walkthrough-hosting-wpf-content-in-win32.md)
