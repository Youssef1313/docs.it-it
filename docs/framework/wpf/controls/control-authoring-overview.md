---
title: Panoramica della creazione di controlli
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- controls [WPF], authoring overview
- authoring overview for controls [WPF]
ms.assetid: 3d864748-cff0-4e63-9b23-d8e5a635b28f
ms.openlocfilehash: 1ac8964f915206205d5c9e6ab782fcaa59bf2a99
ms.sourcegitcommit: f348c84443380a1959294cdf12babcb804cfa987
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 11/12/2019
ms.locfileid: "73975722"
---
# <a name="control-authoring-overview"></a><span data-ttu-id="ab8fa-102">Panoramica della creazione di controlli</span><span class="sxs-lookup"><span data-stu-id="ab8fa-102">Control Authoring Overview</span></span>

<span data-ttu-id="ab8fa-103">L'estendibilità del modello di controlli di [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] riduce notevolmente l'esigenza di creare un nuovo controllo.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-103">The extensibility of the [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] control model greatly reduces the need to create a new control.</span></span> <span data-ttu-id="ab8fa-104">In alcuni casi può tuttavia essere ancora necessario creare un controllo personalizzato.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-104">However, in certain cases you may still need to create a custom control.</span></span> <span data-ttu-id="ab8fa-105">Questo argomento illustra le funzionalità che riducono al minimo l'esigenza di creare un controllo personalizzato e i diversi modelli di creazione di controlli in [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="ab8fa-105">This topic discusses the features that minimize your need to create a custom control and the different control authoring models in [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)].</span></span> <span data-ttu-id="ab8fa-106">Viene anche illustrato come creare un nuovo controllo.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-106">This topic also demonstrates how to create a new control.</span></span>

<a name="when_to_write_a_new_control"></a>

## <a name="alternatives-to-writing-a-new-control"></a><span data-ttu-id="ab8fa-107">Alternative alla scrittura di un nuovo controllo</span><span class="sxs-lookup"><span data-stu-id="ab8fa-107">Alternatives to Writing a New Control</span></span>

<span data-ttu-id="ab8fa-108">In precedenza, per ottenere un'esperienza personalizzata da un controllo esistente, le modifiche erano limitate alle proprietà standard del controllo, ad esempio colore di sfondo, spessore del bordo e dimensioni del carattere.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-108">Historically, if you wanted to get a customized experience from an existing control, you were limited to changing the standard properties of the control, such as background color, border width, and font size.</span></span> <span data-ttu-id="ab8fa-109">Per estendere l'aspetto o il comportamento di un controllo oltre questi parametri predefiniti, era necessario creare un nuovo controllo, in genere ereditando da un controllo esistente ed eseguendo l'override del metodo responsabile del disegno del controllo.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-109">If you wished to extend the appearance or behavior of a control beyond these predefined parameters, you would need to create a new control, usually by inheriting from an existing control and overriding the method responsible for drawing the control.</span></span>  <span data-ttu-id="ab8fa-110">Sebbene ciò sia ancora possibile, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] consente di personalizzare i controlli esistenti usando un modello di contenuto avanzato, stili, modelli e trigger.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-110">Although that is still an option, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] enables to you customize existing controls by using its rich content model, styles, templates, and triggers.</span></span> <span data-ttu-id="ab8fa-111">L'elenco seguente fornisce alcuni esempi relativi a come usare queste funzionalità per creare esperienze coerenti e personalizzate senza dover creare un nuovo controllo.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-111">The following list gives examples of how these features can be used to create custom and consistent experiences without having to create a new control.</span></span>

- <span data-ttu-id="ab8fa-112">**Contenuto avanzato.**</span><span class="sxs-lookup"><span data-stu-id="ab8fa-112">**Rich Content.**</span></span> <span data-ttu-id="ab8fa-113">Molti controlli [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] standard supportano il contenuto avanzato.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-113">Many of the standard [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] controls support rich content.</span></span> <span data-ttu-id="ab8fa-114">La proprietà Content di un <xref:System.Windows.Controls.Button>, ad esempio, è di tipo <xref:System.Object>, quindi teoricamente qualsiasi elemento può essere visualizzato in un <xref:System.Windows.Controls.Button>.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-114">For example, the content property of a <xref:System.Windows.Controls.Button> is of type <xref:System.Object>, so theoretically anything can be displayed on a <xref:System.Windows.Controls.Button>.</span></span>  <span data-ttu-id="ab8fa-115">Per fare in modo che un pulsante visualizzi un'immagine e un testo, è possibile aggiungere un'immagine e un <xref:System.Windows.Controls.TextBlock> a un <xref:System.Windows.Controls.StackPanel> e assegnare il <xref:System.Windows.Controls.StackPanel> alla proprietà <xref:System.Windows.Controls.ContentControl.Content%2A>.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-115">To have a button display an image and text, you can add an image and a <xref:System.Windows.Controls.TextBlock> to a <xref:System.Windows.Controls.StackPanel> and assign the <xref:System.Windows.Controls.StackPanel> to the <xref:System.Windows.Controls.ContentControl.Content%2A> property.</span></span> <span data-ttu-id="ab8fa-116">Poiché i controlli possono visualizzare dati arbitrari ed elementi visivi di [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], c'è una minore esigenza di creare un nuovo controllo o di modificarne uno esistente per supportare una visualizzazione complessa.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-116">Because the controls can display [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] visual elements and arbitrary data, there is less need to create a new control or to modify an existing control to support a complex visualization.</span></span> <span data-ttu-id="ab8fa-117">Per ulteriori informazioni sul modello di contenuto per <xref:System.Windows.Controls.Button> e altri modelli di contenuto in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], vedere [modello di contenuto WPF](wpf-content-model.md).</span><span class="sxs-lookup"><span data-stu-id="ab8fa-117">For more information about the content model for <xref:System.Windows.Controls.Button> and other content models in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], see [WPF Content Model](wpf-content-model.md).</span></span>

- <span data-ttu-id="ab8fa-118">**Stili.**</span><span class="sxs-lookup"><span data-stu-id="ab8fa-118">**Styles.**</span></span> <span data-ttu-id="ab8fa-119">Un <xref:System.Windows.Style> è una raccolta di valori che rappresentano le proprietà di un controllo.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-119">A <xref:System.Windows.Style> is a collection of values that represent properties for a control.</span></span> <span data-ttu-id="ab8fa-120">Usando gli stili, è possibile creare una rappresentazione riutilizzabile dell'aspetto e del comportamento desiderati di un controllo, senza scriverne uno nuovo.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-120">By using styles, you can create a reusable representation of a desired control appearance and behavior without writing a new control.</span></span> <span data-ttu-id="ab8fa-121">Si supponga, ad esempio, che si desideri che tutti i controlli di <xref:System.Windows.Controls.TextBlock> dispongano di un carattere Arial rosso con una dimensione del carattere pari a 14.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-121">For example, assume that you want all of your <xref:System.Windows.Controls.TextBlock> controls to have red, Arial font with a font size of 14.</span></span> <span data-ttu-id="ab8fa-122">È possibile creare uno stile come risorsa e impostare le proprietà appropriate di conseguenza.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-122">You can create a style as a resource and set the appropriate properties accordingly.</span></span> <span data-ttu-id="ab8fa-123">Ogni <xref:System.Windows.Controls.TextBlock> aggiunta all'applicazione avrà lo stesso aspetto.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-123">Then every <xref:System.Windows.Controls.TextBlock> that you add to your application will have the same appearance.</span></span>

- <span data-ttu-id="ab8fa-124">**Modelli di dati.**</span><span class="sxs-lookup"><span data-stu-id="ab8fa-124">**Data Templates.**</span></span> <span data-ttu-id="ab8fa-125">Un <xref:System.Windows.DataTemplate> consente di personalizzare la modalità di visualizzazione dei dati in un controllo.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-125">A <xref:System.Windows.DataTemplate> enables you to customize how data is displayed on a control.</span></span> <span data-ttu-id="ab8fa-126">Ad esempio, è possibile usare un <xref:System.Windows.DataTemplate> per specificare la modalità di visualizzazione dei dati in una <xref:System.Windows.Controls.ListBox>.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-126">For example, a <xref:System.Windows.DataTemplate> can be used to specify how data is displayed in a <xref:System.Windows.Controls.ListBox>.</span></span>  <span data-ttu-id="ab8fa-127">Per un esempio, vedere [Cenni preliminari sui modelli di dati](../data/data-templating-overview.md).</span><span class="sxs-lookup"><span data-stu-id="ab8fa-127">For an example of this, see [Data Templating Overview](../data/data-templating-overview.md).</span></span>  <span data-ttu-id="ab8fa-128">Oltre a personalizzare l'aspetto dei dati, un <xref:System.Windows.DataTemplate> può includere elementi dell'interfaccia utente, che offre una grande flessibilità nelle interfacce utente personalizzate.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-128">In addition to customizing the appearance of data, a <xref:System.Windows.DataTemplate> can include UI elements, which gives you a lot of flexibility in custom UIs.</span></span>  <span data-ttu-id="ab8fa-129">Usando, ad esempio, una <xref:System.Windows.DataTemplate>, è possibile creare un <xref:System.Windows.Controls.ComboBox> in cui ogni elemento contiene una casella di controllo.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-129">For example, by using a <xref:System.Windows.DataTemplate>, you can create a <xref:System.Windows.Controls.ComboBox> in which each item contains a check box.</span></span>

- <span data-ttu-id="ab8fa-130">**Modelli di controllo.**</span><span class="sxs-lookup"><span data-stu-id="ab8fa-130">**Control Templates.**</span></span> <span data-ttu-id="ab8fa-131">Molti controlli in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] usano un <xref:System.Windows.Controls.ControlTemplate> per definire la struttura e l'aspetto del controllo, che separa l'aspetto di un controllo dalla funzionalità del controllo.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-131">Many controls in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] use a <xref:System.Windows.Controls.ControlTemplate> to define the control's structure and appearance, which separates the appearance of a control from the functionality of the control.</span></span> <span data-ttu-id="ab8fa-132">È possibile modificare drasticamente l'aspetto di un controllo ridefinendo la relativa <xref:System.Windows.Controls.ControlTemplate>.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-132">You can drastically change the appearance of a control by redefining its <xref:System.Windows.Controls.ControlTemplate>.</span></span>  <span data-ttu-id="ab8fa-133">Si supponga, ad esempio, di voler creare un controllo con l'aspetto di un semaforo.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-133">For example, suppose you want a control that looks like a stoplight.</span></span> <span data-ttu-id="ab8fa-134">Il controllo ha una funzionalità e un'interfaccia utente semplici.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-134">This control has a simple user interface and functionality.</span></span>  <span data-ttu-id="ab8fa-135">È costituito da tre cerchi, che possono essere illuminati soltanto uno alla volta.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-135">The control is three circles, only one of which can be lit up at a time.</span></span> <span data-ttu-id="ab8fa-136">Dopo un certo livello di reflection, è possibile che un <xref:System.Windows.Controls.RadioButton> offra la funzionalità di un solo elemento da selezionare alla volta, ma l'aspetto predefinito del <xref:System.Windows.Controls.RadioButton> non sembra essere un semaforo.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-136">After some reflection, you might realize that a <xref:System.Windows.Controls.RadioButton> offers the functionality of only one being selected at a time, but the default appearance of the <xref:System.Windows.Controls.RadioButton> looks nothing like the lights on a stoplight.</span></span>  <span data-ttu-id="ab8fa-137">Poiché la <xref:System.Windows.Controls.RadioButton> usa un modello di controllo per definirne l'aspetto, è facile ridefinire la <xref:System.Windows.Controls.ControlTemplate> per adattarla ai requisiti del controllo e usare i pulsanti di opzione per creare il semaforo.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-137">Because the <xref:System.Windows.Controls.RadioButton> uses a control template to define its appearance, it is easy to redefine the <xref:System.Windows.Controls.ControlTemplate> to fit the requirements of the control, and use radio buttons to make your stoplight.</span></span>

  > [!NOTE]
  > <span data-ttu-id="ab8fa-138">Sebbene un <xref:System.Windows.Controls.RadioButton> possa usare una <xref:System.Windows.DataTemplate>, in questo esempio una <xref:System.Windows.DataTemplate> non è sufficiente.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-138">Although a <xref:System.Windows.Controls.RadioButton> can use a <xref:System.Windows.DataTemplate>, a <xref:System.Windows.DataTemplate> is not sufficient in this example.</span></span>  <span data-ttu-id="ab8fa-139">Il <xref:System.Windows.DataTemplate> definisce l'aspetto del contenuto di un controllo.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-139">The <xref:System.Windows.DataTemplate> defines the appearance of the content of a control.</span></span> <span data-ttu-id="ab8fa-140">Nel caso di un <xref:System.Windows.Controls.RadioButton>, il contenuto è quello visualizzato a destra del cerchio che indica se il <xref:System.Windows.Controls.RadioButton> è selezionato.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-140">In the case of a <xref:System.Windows.Controls.RadioButton>, the content is whatever appears to the right of the circle that indicates whether the <xref:System.Windows.Controls.RadioButton> is selected.</span></span>  <span data-ttu-id="ab8fa-141">Nell'esempio del semaforo il pulsante di opzione deve essere costituito semplicemente da un cerchio in grado di "illuminarsi".</span><span class="sxs-lookup"><span data-stu-id="ab8fa-141">In the example of the stoplight, the radio button needs just be a circle that can "light up."</span></span> <span data-ttu-id="ab8fa-142">Poiché il requisito di aspetto per il semaforo è così diverso dall'aspetto predefinito del <xref:System.Windows.Controls.RadioButton>, è necessario ridefinire l'<xref:System.Windows.Controls.ControlTemplate>.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-142">Because the appearance requirement for the stoplight is so different than the default appearance of the <xref:System.Windows.Controls.RadioButton>, it is necessary to redefine the <xref:System.Windows.Controls.ControlTemplate>.</span></span>  <span data-ttu-id="ab8fa-143">In generale, una <xref:System.Windows.DataTemplate> viene utilizzata per definire il contenuto (o i dati) di un controllo e viene utilizzata una <xref:System.Windows.Controls.ControlTemplate> per definire la struttura di un controllo.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-143">In general a <xref:System.Windows.DataTemplate> is used for defining the content (or data) of a control, and a <xref:System.Windows.Controls.ControlTemplate> is used for defining how a control is structured.</span></span>

- <span data-ttu-id="ab8fa-144">**Trigger.**</span><span class="sxs-lookup"><span data-stu-id="ab8fa-144">**Triggers.**</span></span> <span data-ttu-id="ab8fa-145">Un <xref:System.Windows.Trigger> consente di modificare dinamicamente l'aspetto e il comportamento di un controllo senza creare un nuovo controllo.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-145">A <xref:System.Windows.Trigger> allows you to dynamically change the appearance and behavior of a control without creating a new control.</span></span> <span data-ttu-id="ab8fa-146">Si supponga, ad esempio, di avere più controlli <xref:System.Windows.Controls.ListBox> nell'applicazione e che gli elementi in ogni <xref:System.Windows.Controls.ListBox> siano in grassetto e rossi quando vengono selezionati.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-146">For example, suppose you have multiple <xref:System.Windows.Controls.ListBox> controls in your application and want the items in each <xref:System.Windows.Controls.ListBox> to be bold and red when they are selected.</span></span> <span data-ttu-id="ab8fa-147">Il primo istinto potrebbe consistere nel creare una classe che eredita da <xref:System.Windows.Controls.ListBox> ed eseguire l'override del metodo <xref:System.Windows.Controls.Primitives.Selector.OnSelectionChanged%2A> per modificare l'aspetto dell'elemento selezionato, ma un approccio migliore consiste nell'aggiungere un trigger a uno stile di un <xref:System.Windows.Controls.ListBoxItem> che modifica l'aspetto dell'elemento selezionato.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-147">Your first instinct might be to create a class that inherits from <xref:System.Windows.Controls.ListBox> and override the <xref:System.Windows.Controls.Primitives.Selector.OnSelectionChanged%2A> method to change the appearance of the selected item, but a better approach is to add a trigger to a style of a <xref:System.Windows.Controls.ListBoxItem> that changes the appearance of the selected item.</span></span> <span data-ttu-id="ab8fa-148">Un trigger consente di modificare i valori delle proprietà o di eseguire determinate azioni in base al valore di una proprietà.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-148">A trigger enables you to change property values or take actions based on the value of a property.</span></span> <span data-ttu-id="ab8fa-149">Un <xref:System.Windows.EventTrigger> consente di intraprendere le azioni quando si verifica un evento.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-149">An <xref:System.Windows.EventTrigger> enables you to take actions when an event occurs.</span></span>

<span data-ttu-id="ab8fa-150">Per altre informazioni su stili, modelli e trigger, vedere [Applicazione di stili e modelli](styling-and-templating.md).</span><span class="sxs-lookup"><span data-stu-id="ab8fa-150">For more information about styles, templates, and triggers, see [Styling and Templating](styling-and-templating.md).</span></span>

<span data-ttu-id="ab8fa-151">In genere, se il controllo rispecchia la funzionalità di un controllo esistente, ma si vuole che abbia un aspetto diverso, valutare innanzitutto la possibilità di usare uno dei metodi descritti in questa sezione per modificare l'aspetto del controllo esistente.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-151">In general, if your control mirrors the functionality of an existing control, but you want the control to look different, you should first consider whether you can use any of the methods discussed in this section to change the existing control's appearance.</span></span>

<a name="models_for_control_authoring"></a>

## <a name="models-for-control-authoring"></a><span data-ttu-id="ab8fa-152">Modelli per la modifica dei controlli</span><span class="sxs-lookup"><span data-stu-id="ab8fa-152">Models for Control Authoring</span></span>

<span data-ttu-id="ab8fa-153">Il modello di contenuto avanzato, gli stili, i modelli e i trigger riducono al minimo la necessità di creare un nuovo controllo.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-153">The rich content model, styles, templates, and triggers minimize the need for you to create a new control.</span></span> <span data-ttu-id="ab8fa-154">Se, tuttavia, è necessario creare un nuovo controllo, è importante conoscere i diversi modelli di creazione di controlli in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="ab8fa-154">However, if you do need to create a new control, it is important to understand the different control authoring models in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span></span> [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <span data-ttu-id="ab8fa-155">fornisce tre modelli generali per la creazione di un controllo, ognuno dei quali offre un set di funzionalità e un livello di flessibilità specifici.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-155">provides three general models for creating a control, each of which provides a different set of features and level of flexibility.</span></span> <span data-ttu-id="ab8fa-156">Le classi di base per i tre modelli sono <xref:System.Windows.Controls.UserControl>, <xref:System.Windows.Controls.Control>e <xref:System.Windows.FrameworkElement>.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-156">The base classes for the three models are <xref:System.Windows.Controls.UserControl>, <xref:System.Windows.Controls.Control>, and <xref:System.Windows.FrameworkElement>.</span></span>

### <a name="deriving-from-usercontrol"></a><span data-ttu-id="ab8fa-157">Derivazione da UserControl</span><span class="sxs-lookup"><span data-stu-id="ab8fa-157">Deriving from UserControl</span></span>

<span data-ttu-id="ab8fa-158">Il modo più semplice per creare un controllo in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] consiste nel derivare da <xref:System.Windows.Controls.UserControl>.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-158">The simplest way to create a control in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] is to derive from <xref:System.Windows.Controls.UserControl>.</span></span> <span data-ttu-id="ab8fa-159">Quando si compila un controllo che eredita da <xref:System.Windows.Controls.UserControl>, i componenti esistenti vengono aggiunti al <xref:System.Windows.Controls.UserControl>, vengono denominati i componenti e i gestori eventi di riferimento in [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)].</span><span class="sxs-lookup"><span data-stu-id="ab8fa-159">When you build a control that inherits from <xref:System.Windows.Controls.UserControl>, you add existing components to the <xref:System.Windows.Controls.UserControl>, name the components, and reference event handlers in [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)].</span></span> <span data-ttu-id="ab8fa-160">È quindi possibile fare riferimento agli elementi denominati e definire i gestori eventi nel codice.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-160">You can then reference the named elements and define the event handlers in code.</span></span> <span data-ttu-id="ab8fa-161">Questo modello di sviluppo è molto simile al modello usato per lo sviluppo di applicazioni in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="ab8fa-161">This development model is very similar to the model used for application development in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span></span>

<span data-ttu-id="ab8fa-162">Se compilata correttamente, un <xref:System.Windows.Controls.UserControl> può sfruttare i vantaggi di contenuto avanzato, stili e trigger.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-162">If built correctly, a <xref:System.Windows.Controls.UserControl> can take advantage of the benefits of rich content, styles, and triggers.</span></span> <span data-ttu-id="ab8fa-163">Tuttavia, se il controllo eredita da <xref:System.Windows.Controls.UserControl>, gli utenti che usano il controllo non saranno in grado di usare una <xref:System.Windows.DataTemplate> o <xref:System.Windows.Controls.ControlTemplate> per personalizzarne l'aspetto.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-163">However, if your control inherits from <xref:System.Windows.Controls.UserControl>, people who use your control will not be able to use a <xref:System.Windows.DataTemplate> or <xref:System.Windows.Controls.ControlTemplate> to customize its appearance.</span></span>  <span data-ttu-id="ab8fa-164">È necessario derivare dalla classe <xref:System.Windows.Controls.Control> o da una delle classi derivate (diverse da <xref:System.Windows.Controls.UserControl>) per creare un controllo personalizzato che supporta i modelli.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-164">It is necessary to derive from the <xref:System.Windows.Controls.Control> class or one of its derived classes (other than <xref:System.Windows.Controls.UserControl>) to create a custom control that supports templates.</span></span>

#### <a name="benefits-of-deriving-from-usercontrol"></a><span data-ttu-id="ab8fa-165">Vantaggi della derivazione da UserControl</span><span class="sxs-lookup"><span data-stu-id="ab8fa-165">Benefits of Deriving from UserControl</span></span>

<span data-ttu-id="ab8fa-166">Prendere in considerazione la derivazione da <xref:System.Windows.Controls.UserControl> se si applicano tutte le condizioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="ab8fa-166">Consider deriving from <xref:System.Windows.Controls.UserControl> if all of the following apply:</span></span>

- <span data-ttu-id="ab8fa-167">Si vuole creare il controllo in modo analogo a come si crea un'applicazione.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-167">You want to build your control similarly to how you build an application.</span></span>

- <span data-ttu-id="ab8fa-168">Il controllo è costituito esclusivamente da componenti esistenti.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-168">Your control consists only of existing components.</span></span>

- <span data-ttu-id="ab8fa-169">Non è necessario supportare una personalizzazione complessa.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-169">You don't need to support complex customization.</span></span>

### <a name="deriving-from-control"></a><span data-ttu-id="ab8fa-170">Derivazione da Control</span><span class="sxs-lookup"><span data-stu-id="ab8fa-170">Deriving from Control</span></span>

<span data-ttu-id="ab8fa-171">La derivazione dalla classe <xref:System.Windows.Controls.Control> è il modello utilizzato dalla maggior parte dei controlli [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] esistenti.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-171">Deriving from the <xref:System.Windows.Controls.Control> class is the model used by most of the existing [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] controls.</span></span> <span data-ttu-id="ab8fa-172">Quando si crea un controllo che eredita dalla classe <xref:System.Windows.Controls.Control>, l'aspetto viene definito usando i modelli.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-172">When you create a control that inherits from the <xref:System.Windows.Controls.Control> class, you define its appearance by using templates.</span></span> <span data-ttu-id="ab8fa-173">In tal modo, la logica operativa viene separata dalla rappresentazione visiva.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-173">By doing so, you separate the operational logic from the visual representation.</span></span> <span data-ttu-id="ab8fa-174">È anche possibile garantire la separazione dell'interfaccia utente e della logica usando i comandi e le associazioni anziché gli eventi e evitando di fare riferimento agli elementi nel <xref:System.Windows.Controls.ControlTemplate> quando possibile.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-174">You can also ensure the decoupling of the UI and logic by using commands and bindings instead of events and avoiding referencing elements in the <xref:System.Windows.Controls.ControlTemplate> whenever possible.</span></span>  <span data-ttu-id="ab8fa-175">Se l'interfaccia utente e la logica del controllo sono disaccoppiate correttamente, un utente del controllo può ridefinire il <xref:System.Windows.Controls.ControlTemplate> del controllo per personalizzarne l'aspetto.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-175">If the UI and logic of your control are properly decoupled, a user of your control can redefine the control's <xref:System.Windows.Controls.ControlTemplate> to customize its appearance.</span></span> <span data-ttu-id="ab8fa-176">Sebbene la creazione di un <xref:System.Windows.Controls.Control> personalizzato non sia semplice come la creazione di un <xref:System.Windows.Controls.UserControl>, un <xref:System.Windows.Controls.Control> personalizzato offre la massima flessibilità.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-176">Although building a custom <xref:System.Windows.Controls.Control> is not as simple as building a <xref:System.Windows.Controls.UserControl>, a custom <xref:System.Windows.Controls.Control> provides the most flexibility.</span></span>

#### <a name="benefits-of-deriving-from-control"></a><span data-ttu-id="ab8fa-177">Vantaggi della derivazione da Control</span><span class="sxs-lookup"><span data-stu-id="ab8fa-177">Benefits of Deriving from Control</span></span>

<span data-ttu-id="ab8fa-178">Provare a derivare da <xref:System.Windows.Controls.Control> invece di usare la classe <xref:System.Windows.Controls.UserControl> se si verifica una delle condizioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="ab8fa-178">Consider deriving from <xref:System.Windows.Controls.Control> instead of using the <xref:System.Windows.Controls.UserControl> class if any of the following apply:</span></span>

- <span data-ttu-id="ab8fa-179">Si vuole che l'aspetto del controllo sia personalizzabile tramite il <xref:System.Windows.Controls.ControlTemplate>.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-179">You want the appearance of your control to be customizable via the <xref:System.Windows.Controls.ControlTemplate>.</span></span>

- <span data-ttu-id="ab8fa-180">Si vuole che il controllo supporti temi diversi.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-180">You want your control to support different themes.</span></span>

### <a name="deriving-from-frameworkelement"></a><span data-ttu-id="ab8fa-181">Derivazione da FrameworkElement</span><span class="sxs-lookup"><span data-stu-id="ab8fa-181">Deriving from FrameworkElement</span></span>

<span data-ttu-id="ab8fa-182">I controlli che derivano da <xref:System.Windows.Controls.UserControl> o <xref:System.Windows.Controls.Control> si basano sulla composizione di elementi esistenti.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-182">Controls that derive from <xref:System.Windows.Controls.UserControl> or <xref:System.Windows.Controls.Control> rely upon composing existing elements.</span></span> <span data-ttu-id="ab8fa-183">Per molti scenari, si tratta di una soluzione accettabile, perché qualsiasi oggetto che eredita da <xref:System.Windows.FrameworkElement> può trovarsi in una <xref:System.Windows.Controls.ControlTemplate>.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-183">For many scenarios, this is an acceptable solution, because any object that inherits from <xref:System.Windows.FrameworkElement> can be in a <xref:System.Windows.Controls.ControlTemplate>.</span></span> <span data-ttu-id="ab8fa-184">A volte, tuttavia, le funzionalità di composizione semplice di elementi non sono sufficienti per definire l'aspetto di un controllo.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-184">However, there are times when a control's appearance requires more than the functionality of simple element composition.</span></span> <span data-ttu-id="ab8fa-185">Per questi scenari, basare un componente su <xref:System.Windows.FrameworkElement> è la scelta migliore.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-185">For these scenarios, basing a component on <xref:System.Windows.FrameworkElement> is the right choice.</span></span>

<span data-ttu-id="ab8fa-186">Per la compilazione di componenti basati su <xref:System.Windows.FrameworkElement>sono disponibili due metodi standard: il rendering diretto e la composizione di elementi personalizzati.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-186">There are two standard methods for building <xref:System.Windows.FrameworkElement>-based components: direct rendering and custom element composition.</span></span> <span data-ttu-id="ab8fa-187">Per il rendering diretto è necessario eseguire l'override del metodo <xref:System.Windows.UIElement.OnRender%2A> di <xref:System.Windows.FrameworkElement> e fornire <xref:System.Windows.Media.DrawingContext> operazioni che definiscono in modo esplicito gli oggetti visivi dei componenti.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-187">Direct rendering involves overriding the <xref:System.Windows.UIElement.OnRender%2A> method of <xref:System.Windows.FrameworkElement> and providing <xref:System.Windows.Media.DrawingContext> operations that explicitly define the component visuals.</span></span> <span data-ttu-id="ab8fa-188">Si tratta del metodo usato da <xref:System.Windows.Controls.Image> e <xref:System.Windows.Controls.Border>.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-188">This is the method used by <xref:System.Windows.Controls.Image> and <xref:System.Windows.Controls.Border>.</span></span> <span data-ttu-id="ab8fa-189">La composizione di elementi personalizzati prevede l'uso di oggetti di tipo <xref:System.Windows.Media.Visual> per comporre l'aspetto del componente.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-189">Custom element composition involves using objects of type <xref:System.Windows.Media.Visual> to compose the appearance of your component.</span></span> <span data-ttu-id="ab8fa-190">Per un esempio, vedere [Uso degli oggetti DrawingVisual](../graphics-multimedia/using-drawingvisual-objects.md).</span><span class="sxs-lookup"><span data-stu-id="ab8fa-190">For an example, see [Using DrawingVisual Objects](../graphics-multimedia/using-drawingvisual-objects.md).</span></span> <span data-ttu-id="ab8fa-191"><xref:System.Windows.Controls.Primitives.Track> è un esempio di un controllo in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] che utilizza la composizione di elementi personalizzata.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-191"><xref:System.Windows.Controls.Primitives.Track> is an example of a control in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] that uses custom element composition.</span></span> <span data-ttu-id="ab8fa-192">È anche possibile combinare il rendering diretto e la composizione personalizzata di elementi nello stesso controllo.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-192">It is also possible to mix direct rendering and custom element composition in the same control.</span></span>

#### <a name="benefits-of-deriving-from-frameworkelement"></a><span data-ttu-id="ab8fa-193">Vantaggi della derivazione da FrameworkElement</span><span class="sxs-lookup"><span data-stu-id="ab8fa-193">Benefits of Deriving from FrameworkElement</span></span>

<span data-ttu-id="ab8fa-194">Prendere in considerazione la derivazione da <xref:System.Windows.FrameworkElement> se si verifica una delle condizioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="ab8fa-194">Consider deriving from <xref:System.Windows.FrameworkElement> if any of the following apply:</span></span>

- <span data-ttu-id="ab8fa-195">Si vuole controllare l'aspetto del controllo in modo più preciso rispetto a quanto possibile con la composizione semplice di elementi.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-195">You want to have precise control over the appearance of your control beyond what is provided by simple element composition.</span></span>

- <span data-ttu-id="ab8fa-196">Si vuole definire l'aspetto del controllo definendo una logica di rendering personalizzata.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-196">You want to define the appearance of your control by defining your own render logic.</span></span>

- <span data-ttu-id="ab8fa-197">Si desidera comporre gli elementi esistenti in modi nuovi, oltre a quanto possibile con <xref:System.Windows.Controls.UserControl> e <xref:System.Windows.Controls.Control>.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-197">You want to compose existing elements in novel ways that go beyond what is possible with <xref:System.Windows.Controls.UserControl> and <xref:System.Windows.Controls.Control>.</span></span>

<a name="control_authoring_basics"></a>

## <a name="control-authoring-basics"></a><span data-ttu-id="ab8fa-198">Nozioni di base sulla creazione di controlli</span><span class="sxs-lookup"><span data-stu-id="ab8fa-198">Control Authoring Basics</span></span>

<span data-ttu-id="ab8fa-199">Come illustrato in precedenza, una delle funzionalità più efficaci di [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] è la possibilità di andare oltre l'impostazione delle proprietà di base di un controllo per modificare l'aspetto e il comportamento senza dover necessariamente creare un controllo personalizzato.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-199">As discussed earlier, one of the most powerful features of [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] is the ability to go beyond setting basic properties of a control to change its appearance and behavior, yet still not needing to create a custom control.</span></span> <span data-ttu-id="ab8fa-200">Le funzionalità di applicazione di stili, data binding e trigger sono possibili grazie al sistema di proprietà di [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] e al sistema di eventi di [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="ab8fa-200">The styling, data binding, and trigger features are made possible by the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] property system and the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] event system.</span></span> <span data-ttu-id="ab8fa-201">Le sezioni seguenti descrivono alcune procedure da seguire, indipendentemente dal modello usato per creare il controllo personalizzato, in modo che gli utenti del controllo personalizzato possano usare le funzionalità come farebbero per un controllo incluso in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="ab8fa-201">The following sections describe some practices that you should follow, regardless of the model you use to create the custom control, so that users of your custom control can use these features just as they would for a control that is included with [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span></span>

### <a name="use-dependency-properties"></a><span data-ttu-id="ab8fa-202">Usare le proprietà di dipendenza</span><span class="sxs-lookup"><span data-stu-id="ab8fa-202">Use Dependency Properties</span></span>

<span data-ttu-id="ab8fa-203">Con le proprietà di dipendenza è possibile eseguire le operazioni indicate di seguito:</span><span class="sxs-lookup"><span data-stu-id="ab8fa-203">When a property is a dependency property, it is possible to do the following:</span></span>

- <span data-ttu-id="ab8fa-204">Impostare la proprietà in uno stile.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-204">Set the property in a style.</span></span>

- <span data-ttu-id="ab8fa-205">Associare la proprietà a un'origine dati.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-205">Bind the property to a data source.</span></span>

- <span data-ttu-id="ab8fa-206">Usare una risorsa dinamica come valore della proprietà.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-206">Use a dynamic resource as the property's value.</span></span>

- <span data-ttu-id="ab8fa-207">Animare la proprietà.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-207">Animate the property.</span></span>

<span data-ttu-id="ab8fa-208">Se si vuole che una proprietà del controllo supporti queste funzionalità, è necessario implementarla come proprietà di dipendenza.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-208">If you want a property of your control to support any of this functionality, you should implement it as a dependency property.</span></span> <span data-ttu-id="ab8fa-209">L'esempio seguente definisce una proprietà di dipendenza denominata `Value` mediante le operazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="ab8fa-209">The following example defines a dependency property named `Value` by doing the following:</span></span>

- <span data-ttu-id="ab8fa-210">Definire un identificatore <xref:System.Windows.DependencyProperty> denominato `ValueProperty` come campo `public` `static` `readonly`.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-210">Define a <xref:System.Windows.DependencyProperty> identifier named `ValueProperty` as a `public` `static` `readonly` field.</span></span>

- <span data-ttu-id="ab8fa-211">Registrare il nome della proprietà con il sistema di proprietà chiamando <xref:System.Windows.DependencyProperty.Register%2A?displayProperty=nameWithType>per specificare gli elementi seguenti:</span><span class="sxs-lookup"><span data-stu-id="ab8fa-211">Register the property name with the property system, by calling <xref:System.Windows.DependencyProperty.Register%2A?displayProperty=nameWithType>, to specify the following:</span></span>

  - <span data-ttu-id="ab8fa-212">Nome della proprietà.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-212">The name of the property.</span></span>

  - <span data-ttu-id="ab8fa-213">Tipo della proprietà.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-213">The type of the property.</span></span>

  - <span data-ttu-id="ab8fa-214">Tipo proprietario della proprietà.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-214">The type that owns the property.</span></span>

  - <span data-ttu-id="ab8fa-215">Metadati della proprietà.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-215">The metadata for the property.</span></span> <span data-ttu-id="ab8fa-216">I metadati contengono il valore predefinito della proprietà, un <xref:System.Windows.CoerceValueCallback> e una <xref:System.Windows.PropertyChangedCallback>.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-216">The metadata contains the property's default value, a <xref:System.Windows.CoerceValueCallback> and a <xref:System.Windows.PropertyChangedCallback>.</span></span>

- <span data-ttu-id="ab8fa-217">Definire una proprietà wrapper CLR denominata `Value`, che corrisponde allo stesso nome usato per registrare la proprietà di dipendenza, implementando le funzioni di accesso `get` e `set` della proprietà.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-217">Define a CLR wrapper property named `Value`, which is the same name that is used to register the dependency property, by implementing the property's `get` and `set` accessors.</span></span> <span data-ttu-id="ab8fa-218">Si noti che le funzioni di accesso `get` e `set` chiamano rispettivamente <xref:System.Windows.DependencyObject.GetValue%2A> e <xref:System.Windows.DependencyObject.SetValue%2A>.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-218">Note that the `get` and `set` accessors only call <xref:System.Windows.DependencyObject.GetValue%2A> and <xref:System.Windows.DependencyObject.SetValue%2A> respectively.</span></span> <span data-ttu-id="ab8fa-219">È consigliabile che le funzioni di accesso delle proprietà di dipendenza non contengano logica aggiuntiva perché client e [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] possono ignorare le funzioni di accesso e chiamare <xref:System.Windows.DependencyObject.GetValue%2A> e <xref:System.Windows.DependencyObject.SetValue%2A> direttamente.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-219">It is recommended that the accessors of dependency properties not contain additional logic because clients and [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] can bypass the accessors and call <xref:System.Windows.DependencyObject.GetValue%2A> and <xref:System.Windows.DependencyObject.SetValue%2A> directly.</span></span> <span data-ttu-id="ab8fa-220">Ad esempio, quando una proprietà è associata a un'origine dati, la funzione di accesso `set` della proprietà non viene chiamata.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-220">For example, when a property is bound to a data source, the property's `set` accessor is not called.</span></span>  <span data-ttu-id="ab8fa-221">Anziché aggiungere logica aggiuntiva alle funzioni di accesso get e set, utilizzare i delegati <xref:System.Windows.ValidateValueCallback>, <xref:System.Windows.CoerceValueCallback>e <xref:System.Windows.PropertyChangedCallback> per rispondere o controllare il valore in caso di modifica.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-221">Instead of adding additional logic to the get and set accessors, use the <xref:System.Windows.ValidateValueCallback>, <xref:System.Windows.CoerceValueCallback>, and <xref:System.Windows.PropertyChangedCallback> delegates to respond to or check the value when it changes.</span></span>  <span data-ttu-id="ab8fa-222">Per altre informazioni su questi callback, vedere [Callback e convalida delle proprietà di dipendenza](../advanced/dependency-property-callbacks-and-validation.md).</span><span class="sxs-lookup"><span data-stu-id="ab8fa-222">For more information on these callbacks, see [Dependency Property Callbacks and Validation](../advanced/dependency-property-callbacks-and-validation.md).</span></span>

- <span data-ttu-id="ab8fa-223">Definire un metodo per la <xref:System.Windows.CoerceValueCallback> `CoerceValue`denominata.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-223">Define a method for the <xref:System.Windows.CoerceValueCallback> named `CoerceValue`.</span></span> <span data-ttu-id="ab8fa-224">`CoerceValue` garantisce che `Value` sia maggiore o uguale a `MinValue` e minore o uguale a `MaxValue`.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-224">`CoerceValue` ensures that `Value` is greater or equal to `MinValue` and less than or equal to `MaxValue`.</span></span>

- <span data-ttu-id="ab8fa-225">Definire un metodo per il <xref:System.Windows.PropertyChangedCallback>, denominato `OnValueChanged`.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-225">Define a method for the <xref:System.Windows.PropertyChangedCallback>, named `OnValueChanged`.</span></span> <span data-ttu-id="ab8fa-226">`OnValueChanged` crea un oggetto <xref:System.Windows.RoutedPropertyChangedEventArgs%601> e prepara la generazione dell'evento indirizzato `ValueChanged`.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-226">`OnValueChanged` creates a <xref:System.Windows.RoutedPropertyChangedEventArgs%601> object and prepares to raise the `ValueChanged` routed event.</span></span> <span data-ttu-id="ab8fa-227">Gli eventi indirizzati sono illustrati nella sezione successiva.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-227">Routed events are discussed in the next section.</span></span>

[!code-csharp[UserControlNumericUpDown#DependencyProperty](~/samples/snippets/csharp/VS_Snippets_Wpf/UserControlNumericUpDown/CSharp/NumericUpDown.xaml.cs#dependencyproperty)]
[!code-vb[UserControlNumericUpDown#DependencyProperty](~/samples/snippets/visualbasic/VS_Snippets_Wpf/UserControlNumericUpDown/visualbasic/numericupdown.xaml.vb#dependencyproperty)]

<span data-ttu-id="ab8fa-228">Per altre informazioni, vedere [Proprietà di dipendenza personalizzate](../advanced/custom-dependency-properties.md).</span><span class="sxs-lookup"><span data-stu-id="ab8fa-228">For more information, see [Custom Dependency Properties](../advanced/custom-dependency-properties.md).</span></span>

### <a name="use-routed-events"></a><span data-ttu-id="ab8fa-229">Usare gli eventi indirizzati</span><span class="sxs-lookup"><span data-stu-id="ab8fa-229">Use Routed Events</span></span>

<span data-ttu-id="ab8fa-230">Così come le proprietà di dipendenza estendono il concetto di proprietà CLR con funzionalità aggiuntive, gli eventi indirizzati estendono la nozione di eventi CLR standard.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-230">Just as dependency properties extend the notion of CLR properties with additional functionality, routed events extend the notion of standard CLR events.</span></span> <span data-ttu-id="ab8fa-231">Quando si crea un nuovo controllo [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], è anche consigliabile implementare l'evento come evento indirizzato, perché gli eventi indirizzati supportano i comportamenti seguenti:</span><span class="sxs-lookup"><span data-stu-id="ab8fa-231">When you create a new [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] control, it is also good practice to implement your event as a routed event because a routed event supports the following behavior:</span></span>

- <span data-ttu-id="ab8fa-232">Gli eventi possono essere gestiti in un elemento padre di più controlli.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-232">Events can be handled on a parent of multiple controls.</span></span> <span data-ttu-id="ab8fa-233">Nel caso di un evento di bubbling, un singolo elemento padre nell'albero degli elementi può sottoscrivere l'evento.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-233">If an event is a bubbling event, a single parent in the element tree can subscribe to the event.</span></span> <span data-ttu-id="ab8fa-234">Gli autori dell'applicazione possono quindi usare un solo gestore per rispondere all'evento di più controlli.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-234">Then application authors can use one handler to respond to the event of multiple controls.</span></span> <span data-ttu-id="ab8fa-235">Se, ad esempio, il controllo fa parte di ogni elemento di un <xref:System.Windows.Controls.ListBox> (perché è incluso in una <xref:System.Windows.DataTemplate>), lo sviluppatore dell'applicazione può definire il gestore eventi per l'evento del controllo sul <xref:System.Windows.Controls.ListBox>.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-235">For example, if your control is a part of each item in a <xref:System.Windows.Controls.ListBox> (because it is included in a <xref:System.Windows.DataTemplate>), the application developer can define the event handler for your control's event on the <xref:System.Windows.Controls.ListBox>.</span></span> <span data-ttu-id="ab8fa-236">Il gestore eventi viene chiamato ogni volta che l'evento si verifica in uno dei controlli.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-236">Whenever the event occurs on any of the controls, the event handler is called.</span></span>

- <span data-ttu-id="ab8fa-237">Gli eventi indirizzati possono essere usati in un <xref:System.Windows.EventSetter>, che consente agli sviluppatori di applicazioni di specificare il gestore di un evento all'interno di uno stile.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-237">Routed events can be used in an <xref:System.Windows.EventSetter>, which enables application developers to specify the handler of an event within a style.</span></span>

- <span data-ttu-id="ab8fa-238">Gli eventi indirizzati possono essere usati in un <xref:System.Windows.EventTrigger>, che risulta utile per l'animazione delle proprietà tramite [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span><span class="sxs-lookup"><span data-stu-id="ab8fa-238">Routed events can be used in an <xref:System.Windows.EventTrigger>, which is useful for animating properties by using [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span></span> <span data-ttu-id="ab8fa-239">Per altre informazioni, vedere [Panoramica dell'animazione](../graphics-multimedia/animation-overview.md).</span><span class="sxs-lookup"><span data-stu-id="ab8fa-239">For more information, see [Animation Overview](../graphics-multimedia/animation-overview.md).</span></span>

<span data-ttu-id="ab8fa-240">L'esempio seguente definisce un evento indirizzato mediante le operazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="ab8fa-240">The following example defines a routed event by doing the following:</span></span>

- <span data-ttu-id="ab8fa-241">Definire un identificatore <xref:System.Windows.RoutedEvent> denominato `ValueChangedEvent` come campo `public` `static` `readonly`.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-241">Define a <xref:System.Windows.RoutedEvent> identifier named `ValueChangedEvent` as a `public` `static` `readonly` field.</span></span>

- <span data-ttu-id="ab8fa-242">Registrare l'evento indirizzato chiamando il metodo <xref:System.Windows.EventManager.RegisterRoutedEvent%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-242">Register the routed event by calling the <xref:System.Windows.EventManager.RegisterRoutedEvent%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="ab8fa-243">Nell'esempio vengono specificate le informazioni seguenti quando viene chiamato <xref:System.Windows.EventManager.RegisterRoutedEvent%2A>:</span><span class="sxs-lookup"><span data-stu-id="ab8fa-243">The example specifies the following information when it calls <xref:System.Windows.EventManager.RegisterRoutedEvent%2A>:</span></span>

  - <span data-ttu-id="ab8fa-244">Il nome dell'evento è `ValueChanged`.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-244">The name of the event is `ValueChanged`.</span></span>

  - <span data-ttu-id="ab8fa-245">La strategia di routing è <xref:System.Windows.RoutingStrategy.Bubble>, il che significa che un gestore eventi nell'origine (l'oggetto che genera l'evento) viene chiamato per primo, quindi i gestori eventi negli elementi padre dell'origine vengono chiamati in successione, a partire dal gestore eventi sul più vicino elemento padre.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-245">The routing strategy is <xref:System.Windows.RoutingStrategy.Bubble>, which means that an event handler on the source (the object that raises the event) is called first, and then event handlers on the source's parent elements are called in succession, starting with the event handler on the closest parent element.</span></span>

  - <span data-ttu-id="ab8fa-246">Il tipo del gestore eventi è <xref:System.Windows.RoutedPropertyChangedEventHandler%601>, costruito con un tipo di <xref:System.Decimal>.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-246">The type of the event handler is <xref:System.Windows.RoutedPropertyChangedEventHandler%601>, constructed with a <xref:System.Decimal> type.</span></span>

  - <span data-ttu-id="ab8fa-247">Il tipo proprietario dell'evento è `NumericUpDown`.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-247">The owning type of the event is `NumericUpDown`.</span></span>

- <span data-ttu-id="ab8fa-248">Dichiarazione di un evento pubblico denominato `ValueChanged` e inserimento di dichiarazioni delle funzioni di accesso dell'evento.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-248">Declare a public event named `ValueChanged` and includes event-accessor declarations.</span></span> <span data-ttu-id="ab8fa-249">Nell'esempio viene chiamato <xref:System.Windows.UIElement.AddHandler%2A> nella dichiarazione della funzione di accesso `add` e <xref:System.Windows.UIElement.RemoveHandler%2A> nella dichiarazione della funzione di accesso `remove` per utilizzare i servizi evento [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="ab8fa-249">The example calls <xref:System.Windows.UIElement.AddHandler%2A> in the `add` accessor declaration and <xref:System.Windows.UIElement.RemoveHandler%2A> in the `remove` accessor declaration to use the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] event services.</span></span>

- <span data-ttu-id="ab8fa-250">Creazione di un metodo virtuale protetto denominato `OnValueChanged` che genera l'evento `ValueChanged`.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-250">Create a protected, virtual method named `OnValueChanged` that raises the `ValueChanged` event.</span></span>

[!code-csharp[UserControlNumericUpDown#RoutedEvent](~/samples/snippets/csharp/VS_Snippets_Wpf/UserControlNumericUpDown/CSharp/NumericUpDown.xaml.cs#routedevent)]
[!code-vb[UserControlNumericUpDown#RoutedEvent](~/samples/snippets/visualbasic/VS_Snippets_Wpf/UserControlNumericUpDown/visualbasic/numericupdown.xaml.vb#routedevent)]

<span data-ttu-id="ab8fa-251">Per altre informazioni, vedere [Cenni preliminari sugli eventi indirizzati](../advanced/routed-events-overview.md) e [Creare un evento indirizzato personalizzato](../advanced/how-to-create-a-custom-routed-event.md).</span><span class="sxs-lookup"><span data-stu-id="ab8fa-251">For more information, see [Routed Events Overview](../advanced/routed-events-overview.md) and [Create a Custom Routed Event](../advanced/how-to-create-a-custom-routed-event.md).</span></span>

### <a name="use-binding"></a><span data-ttu-id="ab8fa-252">Usare il binding</span><span class="sxs-lookup"><span data-stu-id="ab8fa-252">Use Binding</span></span>

<span data-ttu-id="ab8fa-253">Per separare l'interfaccia utente del controllo dalla relativa logica, è possibile usare il data binding.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-253">To decouple the UI of your control from its logic, consider using data binding.</span></span> <span data-ttu-id="ab8fa-254">Questa operazione è particolarmente importante se si definisce l'aspetto del controllo utilizzando un <xref:System.Windows.Controls.ControlTemplate>.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-254">This is particularly important if you define the appearance of your control by using a <xref:System.Windows.Controls.ControlTemplate>.</span></span> <span data-ttu-id="ab8fa-255">Se si usa il data binding, potrebbe non essere più necessario fare riferimento a parti specifiche dell'interfaccia utente dal codice.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-255">When you use data binding, you might be able to eliminate the need to reference specific parts of the UI from the code.</span></span> <span data-ttu-id="ab8fa-256">È consigliabile evitare di fare riferimento a elementi presenti nel <xref:System.Windows.Controls.ControlTemplate> perché quando il codice fa riferimento a elementi presenti nel <xref:System.Windows.Controls.ControlTemplate> e la <xref:System.Windows.Controls.ControlTemplate> viene modificata, l'elemento a cui si fa riferimento deve essere incluso nella nuova <xref:System.Windows.Controls.ControlTemplate>.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-256">It's a good idea to avoid referencing elements that are in the <xref:System.Windows.Controls.ControlTemplate> because when the code references elements that are in the <xref:System.Windows.Controls.ControlTemplate> and the <xref:System.Windows.Controls.ControlTemplate> is changed, the referenced element needs to be included in the new <xref:System.Windows.Controls.ControlTemplate>.</span></span>

<span data-ttu-id="ab8fa-257">Nell'esempio seguente viene aggiornata la <xref:System.Windows.Controls.TextBlock> del controllo `NumericUpDown`, l'assegnazione di un nome e il riferimento alla casella di testo in base al nome nel codice.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-257">The following example updates the <xref:System.Windows.Controls.TextBlock> of the `NumericUpDown` control, assigning a name to it and referencing the textbox by name in code.</span></span>

[!code-xaml[UserControlNumericUpDownSimple#UIRefMarkup](~/samples/snippets/csharp/VS_Snippets_Wpf/UserControlNumericUpDownSimple/CSharp/NumericUpDown.xaml#uirefmarkup)]

[!code-csharp[UserControlNumericUpDownSimple#UIRefCode](~/samples/snippets/csharp/VS_Snippets_Wpf/UserControlNumericUpDownSimple/CSharp/NumericUpDown.xaml.cs#uirefcode)]
[!code-vb[UserControlNumericUpDownSimple#UIRefCode](~/samples/snippets/visualbasic/VS_Snippets_Wpf/UserControlNumericUpDownSimple/VisualBasic/NumericUpDown.xaml.vb#uirefcode)]

<span data-ttu-id="ab8fa-258">L'esempio seguente usa il binding per ottenere lo stesso risultato.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-258">The following example uses binding to accomplish the same thing.</span></span>

[!code-xaml[UserControlNumericUpDown#Binding](~/samples/snippets/csharp/VS_Snippets_Wpf/UserControlNumericUpDown/CSharp/NumericUpDown.xaml#binding)]

<span data-ttu-id="ab8fa-259">Per altre informazioni sul data binding, vedere [Panoramica sul data binding](../../../desktop-wpf/data/data-binding-overview.md).</span><span class="sxs-lookup"><span data-stu-id="ab8fa-259">For more information about data binding, see [Data Binding Overview](../../../desktop-wpf/data/data-binding-overview.md).</span></span>

### <a name="design-for-designers"></a><span data-ttu-id="ab8fa-260">Progettare le finestre di progettazione</span><span class="sxs-lookup"><span data-stu-id="ab8fa-260">Design for Designers</span></span>

<span data-ttu-id="ab8fa-261">Per ricevere il supporto per i controlli WPF personalizzati in WPF Designer per Visual Studio (ad esempio, la modifica delle proprietà con la Finestra Proprietà), seguire queste linee guida.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-261">To receive support for custom WPF controls in the WPF Designer for Visual Studio (for example, property editing with the Properties window), follow these guidelines.</span></span>  <span data-ttu-id="ab8fa-262">Per ulteriori informazioni sullo sviluppo per WPF Designer, vedere [progettazione di XAML in Visual Studio](/visualstudio/xaml-tools/designing-xaml-in-visual-studio).</span><span class="sxs-lookup"><span data-stu-id="ab8fa-262">For more information on developing for the WPF Designer, see [Design XAML in Visual Studio](/visualstudio/xaml-tools/designing-xaml-in-visual-studio).</span></span>

#### <a name="dependency-properties"></a><span data-ttu-id="ab8fa-263">Proprietà di dipendenza</span><span class="sxs-lookup"><span data-stu-id="ab8fa-263">Dependency Properties</span></span>

<span data-ttu-id="ab8fa-264">Assicurarsi di implementare le funzioni di accesso `get` e `set` CLR come descritto in precedenza, in "utilizzare le proprietà di dipendenza".</span><span class="sxs-lookup"><span data-stu-id="ab8fa-264">Be sure to implement CLR `get` and `set` accessors as described earlier, in "Use Dependency Properties."</span></span> <span data-ttu-id="ab8fa-265">Le finestre di progettazione possono usare il wrapper per rilevare la presenza di una proprietà di dipendenza, ma, come accade per [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] e per i client del controllo, non è necessario chiamare le funzioni di accesso quando si ottiene o si imposta la proprietà.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-265">Designers may use the wrapper to detect the presence of a dependency property, but they, like [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] and clients of the control, are not required to call the accessors when getting or setting the property.</span></span>

#### <a name="attached-properties"></a><span data-ttu-id="ab8fa-266">Proprietà associate</span><span class="sxs-lookup"><span data-stu-id="ab8fa-266">Attached Properties</span></span>

<span data-ttu-id="ab8fa-267">Per implementare le proprietà associate nei controlli personalizzati, attenersi alle linee guida seguenti:</span><span class="sxs-lookup"><span data-stu-id="ab8fa-267">You should implement attached properties on custom controls using the following guidelines:</span></span>

- <span data-ttu-id="ab8fa-268">Avere un `public` `static` `readonly` <xref:System.Windows.DependencyProperty> nel formato *PropertyName*`Property` che stava creando usando il metodo <xref:System.Windows.DependencyProperty.RegisterAttached%2A>.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-268">Have a `public` `static` `readonly` <xref:System.Windows.DependencyProperty> of the form *PropertyName*`Property` that was creating using the <xref:System.Windows.DependencyProperty.RegisterAttached%2A> method.</span></span> <span data-ttu-id="ab8fa-269">Il nome della proprietà passato a <xref:System.Windows.DependencyProperty.RegisterAttached%2A> deve corrispondere a *PropertyName*.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-269">The property name that is passed to <xref:System.Windows.DependencyProperty.RegisterAttached%2A> must match *PropertyName*.</span></span>

- <span data-ttu-id="ab8fa-270">Implementare una coppia di metodi CLR`public` `static` denominati `Set`*NomeProprietà* e `Get`*NomeProprietà*.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-270">Implement a pair of `public` `static` CLR methods named `Set`*PropertyName* and `Get`*PropertyName*.</span></span> <span data-ttu-id="ab8fa-271">Entrambi i metodi devono accettare una classe derivata da <xref:System.Windows.DependencyProperty> come primo argomento.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-271">Both methods should accept a class derived from <xref:System.Windows.DependencyProperty> as their first argument.</span></span> <span data-ttu-id="ab8fa-272">Il metodo `Set`*NomeProprietà* accetta anche un argomento il cui tipo corrisponde al tipo di dati registrato per la proprietà.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-272">The `Set`*PropertyName* method also accepts an argument whose type matches the registered data type for the property.</span></span> <span data-ttu-id="ab8fa-273">Il metodo `Get`*NomeProprietà* deve restituire un valore dello stesso tipo.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-273">The `Get`*PropertyName* method should return a value of the same type.</span></span> <span data-ttu-id="ab8fa-274">In assenza del metodo `Set`*NomeProprietà*, la proprietà viene contrassegnata come di sola lettura.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-274">If the `Set`*PropertyName* method is missing, the property is marked read-only.</span></span>

- <span data-ttu-id="ab8fa-275">`Set` *PropertyName* e `Get`*PropertyName* devono essere indirizzati direttamente ai metodi di <xref:System.Windows.DependencyObject.GetValue%2A> e <xref:System.Windows.DependencyObject.SetValue%2A> rispettivamente nell'oggetto dipendenza di destinazione.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-275">`Set` *PropertyName* and `Get`*PropertyName* must route directly to the <xref:System.Windows.DependencyObject.GetValue%2A> and <xref:System.Windows.DependencyObject.SetValue%2A> methods on the target dependency object, respectively.</span></span> <span data-ttu-id="ab8fa-276">Le finestre di progettazione possono accedere alla proprietà associata eseguendo una chiamata tramite il wrapper del metodo oppure una chiamata diretta all'oggetto dipendenza di destinazione.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-276">Designers may access the attached property by calling through the method wrapper or making a direct call to the target dependency object.</span></span>

<span data-ttu-id="ab8fa-277">Per altre informazioni sulle proprietà associate, vedere [Cenni preliminari sulle proprietà associate](../advanced/attached-properties-overview.md).</span><span class="sxs-lookup"><span data-stu-id="ab8fa-277">For more information on attached properties, see [Attached Properties Overview](../advanced/attached-properties-overview.md).</span></span>

### <a name="define-and-use-shared-resources"></a><span data-ttu-id="ab8fa-278">Definire e usare risorse condivise</span><span class="sxs-lookup"><span data-stu-id="ab8fa-278">Define and Use Shared Resources</span></span>

<span data-ttu-id="ab8fa-279">È possibile includere il controllo nello stesso assembly dell'applicazione oppure inserirlo in un pacchetto in un assembly separato che può essere usato in più applicazioni.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-279">You can include your control in the same assembly as your application, or you can package your control in a separate assembly that can be used in multiple applications.</span></span> <span data-ttu-id="ab8fa-280">Nella maggior parte dei casi, le informazioni di questo argomento si applicano indipendentemente dal metodo usato.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-280">For the most part, the information discussed in this topic applies regardless of the method you use.</span></span>  <span data-ttu-id="ab8fa-281">È importante tuttavia notare una differenza.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-281">There is one difference worth noting, however.</span></span>  <span data-ttu-id="ab8fa-282">Quando si inserisce un controllo nello stesso assembly di un'applicazione, è possibile aggiungere risorse globali al file App.xaml.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-282">When you put a control in the same assembly as an application, you are free to add global resources to the App.xaml file.</span></span> <span data-ttu-id="ab8fa-283">Tuttavia, a un assembly che contiene solo controlli non è associato un oggetto <xref:System.Windows.Application>, pertanto non è disponibile un file app. XAML.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-283">But an assembly that contains only controls does not have an <xref:System.Windows.Application> object associated with it, so an App.xaml file is not available.</span></span>

<span data-ttu-id="ab8fa-284">Quando un'applicazione cerca una risorsa, la ricerca viene effettuata a tre livelli nell'ordine seguente:</span><span class="sxs-lookup"><span data-stu-id="ab8fa-284">When an application looks for a resource, it looks at three levels in the following order:</span></span>

1. <span data-ttu-id="ab8fa-285">Livello dell'elemento.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-285">The element level.</span></span>

   <span data-ttu-id="ab8fa-286">Il sistema inizia dall'elemento che fa riferimento alla risorsa, quindi esegue la ricerca delle risorse dell'elemento padre logico continuando fino a raggiungere l'elemento radice.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-286">The system starts with the element that references the resource and then searches resources of the logical parent and so forth until the root element is reached.</span></span>

2. <span data-ttu-id="ab8fa-287">Livello dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-287">The application level.</span></span>

   <span data-ttu-id="ab8fa-288">Risorse definite dall'oggetto <xref:System.Windows.Application>.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-288">Resources defined by the <xref:System.Windows.Application> object.</span></span>

3. <span data-ttu-id="ab8fa-289">Livello del tema.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-289">The theme level.</span></span>

   <span data-ttu-id="ab8fa-290">I dizionari a livello di tema vengono archiviati in una sottocartella denominata Themes.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-290">Theme-level dictionaries are stored in a subfolder named Themes.</span></span>  <span data-ttu-id="ab8fa-291">I file nella cartella Themes corrispondono ai temi.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-291">The files in the Themes folder correspond to themes.</span></span>  <span data-ttu-id="ab8fa-292">Potrebbero ad esempio essere presenti Aero.NormalColor.xaml, Luna.NormalColor.xaml, Royale.NormalColor.xaml e così via.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-292">For example, you might have Aero.NormalColor.xaml, Luna.NormalColor.xaml, Royale.NormalColor.xaml, and so on.</span></span>  <span data-ttu-id="ab8fa-293">Può esserci anche un file denominato generic.xaml.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-293">You can also have a file named generic.xaml.</span></span>  <span data-ttu-id="ab8fa-294">Quando il sistema cerca una risorsa a livello di tema, la ricerca viene effettuata prima nel file specifico del tema e poi nel file generic.xaml.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-294">When the system looks for a resource at the themes level, it first looks for it in the theme-specific file and then looks for it in generic.xaml.</span></span>

<span data-ttu-id="ab8fa-295">Quando il controllo si trova in un assembly separato dall'applicazione, è necessario inserire le risorse globali a livello di elemento o a livello di tema.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-295">When your control is in an assembly that is separate from the application, you must put your global resources at the element level or at the theme level.</span></span> <span data-ttu-id="ab8fa-296">Entrambi i metodi offrono alcuni vantaggi.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-296">Both methods have their advantages.</span></span>

#### <a name="defining-resources-at-the-element-level"></a><span data-ttu-id="ab8fa-297">Definizione delle risorse a livello di elemento</span><span class="sxs-lookup"><span data-stu-id="ab8fa-297">Defining Resources at the Element Level</span></span>

<span data-ttu-id="ab8fa-298">È possibile definire le risorse condivise a livello di elemento creando un dizionario risorse personalizzato e unendolo al dizionario risorse del controllo.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-298">You can define shared resources at the element level by creating a custom resource dictionary and merging it with your control’s resource dictionary.</span></span>  <span data-ttu-id="ab8fa-299">Quando si usa questo metodo, è possibile assegnare un nome qualsiasi al file di risorse, che può trovarsi nella stessa cartella dei controlli.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-299">When you use this method, you can name your resource file anything you want, and it can be in the same folder as your controls.</span></span> <span data-ttu-id="ab8fa-300">Le risorse a livello di elemento possono anche usare semplici stringhe come chiavi.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-300">Resources at the element level can also use simple strings as keys.</span></span> <span data-ttu-id="ab8fa-301">Nell'esempio seguente viene creato un file di risorse <xref:System.Windows.Media.LinearGradientBrush> denominato Dictionary1. XAML.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-301">The following example creates a <xref:System.Windows.Media.LinearGradientBrush> resource file named Dictionary1.xaml.</span></span>

[!code-xaml[SharedResources#1](~/samples/snippets/csharp/VS_Snippets_Wpf/SharedResources/CS/Dictionary1.xaml#1)]

<span data-ttu-id="ab8fa-302">Una volta definito il dizionario, è necessario unirlo al dizionario risorse del controllo.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-302">Once you have defined your dictionary, you need to merge it with your control's resource dictionary.</span></span>  <span data-ttu-id="ab8fa-303">A tale scopo, è possibile usare [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] o il codice.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-303">You can do this by using [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] or code.</span></span>

<span data-ttu-id="ab8fa-304">L'esempio seguente unisce un dizionario risorse usando [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span><span class="sxs-lookup"><span data-stu-id="ab8fa-304">The following example merges a resource dictionary by using [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span></span>

[!code-xaml[SharedResources#2](~/samples/snippets/csharp/VS_Snippets_Wpf/SharedResources/CS/ShapeResizer.xaml#2)]

<span data-ttu-id="ab8fa-305">Lo svantaggio di questo approccio consiste nel fatto che un oggetto <xref:System.Windows.ResourceDictionary> viene creato ogni volta che vi si fa riferimento.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-305">The disadvantage to this approach is that a <xref:System.Windows.ResourceDictionary> object is created each time you reference it.</span></span>  <span data-ttu-id="ab8fa-306">Se, ad esempio, nella libreria sono presenti 10 controlli personalizzati e si uniscono i dizionari risorse condivise per ogni controllo usando XAML, si creeranno 10 oggetti <xref:System.Windows.ResourceDictionary> identici.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-306">For example, if you have 10 custom controls in your library and merge the shared resource dictionaries for each control by using XAML, you create 10 identical <xref:System.Windows.ResourceDictionary> objects.</span></span>  <span data-ttu-id="ab8fa-307">È possibile evitare questo problema creando una classe statica che unisce le risorse nel codice e restituisce il <xref:System.Windows.ResourceDictionary>risultante.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-307">You can avoid this by creating a static class that merges the resources in code and returns the resulting <xref:System.Windows.ResourceDictionary>.</span></span>

<span data-ttu-id="ab8fa-308">Nell'esempio seguente viene creata una classe che restituisce una <xref:System.Windows.ResourceDictionary>condivisa.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-308">The following example creates a class that returns a shared <xref:System.Windows.ResourceDictionary>.</span></span>

[!code-csharp[SharedResources#3](~/samples/snippets/csharp/VS_Snippets_Wpf/SharedResources/CS/SharedDictionaryManager.cs#3)]

<span data-ttu-id="ab8fa-309">L'esempio seguente unisce la risorsa condivisa con le risorse di un controllo personalizzato nel costruttore del controllo prima di chiamare `InitializeComponent`.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-309">The following example merges the shared resource with the resources of a custom control in the control's constructor before it calls `InitializeComponent`.</span></span>  <span data-ttu-id="ab8fa-310">Poiché il `SharedDictionaryManager.SharedDictionary` è una proprietà statica, il <xref:System.Windows.ResourceDictionary> viene creato una sola volta.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-310">Because the `SharedDictionaryManager.SharedDictionary` is a static property, the <xref:System.Windows.ResourceDictionary> is created only once.</span></span> <span data-ttu-id="ab8fa-311">Poiché il dizionario risorse è stato unito prima di chiamare `InitializeComponent`, le risorse sono disponibili per il controllo nel relativo file [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span><span class="sxs-lookup"><span data-stu-id="ab8fa-311">Because the resource dictionary was merged before `InitializeComponent` was called, the resources are available to the control in its [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] file.</span></span>

[!code-csharp[SharedResources#4](~/samples/snippets/csharp/VS_Snippets_Wpf/SharedResources/CS/ShapeResizer.xaml.cs#4)]

#### <a name="defining-resources-at-the-theme-level"></a><span data-ttu-id="ab8fa-312">Definizione delle risorse a livello di tema</span><span class="sxs-lookup"><span data-stu-id="ab8fa-312">Defining Resources at the Theme Level</span></span>

[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <span data-ttu-id="ab8fa-313">consente di creare risorse per diversi temi di Windows.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-313">enables you to create resources for different Windows themes.</span></span>  <span data-ttu-id="ab8fa-314">L'autore di un controllo può definire una risorsa per un tema specifico in modo da modificare l'aspetto del controllo a seconda del tema in uso.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-314">As a control author, you can define a resource for a specific theme to change your control's appearance depending on what theme is in use.</span></span> <span data-ttu-id="ab8fa-315">Ad esempio, l'aspetto di un <xref:System.Windows.Controls.Button> nel tema Windows classico (il tema predefinito per Windows 2000) è diverso da un <xref:System.Windows.Controls.Button> nel tema Windows Luna (il tema predefinito per Windows XP) perché il <xref:System.Windows.Controls.Button> usa un <xref:System.Windows.Controls.ControlTemplate> diverso per ogni tema.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-315">For example, the appearance of a <xref:System.Windows.Controls.Button> in the Windows Classic theme (the default theme for Windows 2000) differs from a <xref:System.Windows.Controls.Button> in the Windows Luna theme (the default theme for Windows XP) because the <xref:System.Windows.Controls.Button> uses a different <xref:System.Windows.Controls.ControlTemplate> for each theme.</span></span>

<span data-ttu-id="ab8fa-316">Le risorse specifiche di un tema vengono inserite in un dizionario risorse con un nome file specifico.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-316">Resources that are specific to a theme are kept in a resource dictionary with a specific file name.</span></span> <span data-ttu-id="ab8fa-317">Questi file devono trovarsi in una cartella denominata `Themes` che è una sottocartella della cartella contenente il controllo.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-317">These files must be in a folder named `Themes` that is a subfolder of the folder that contains the control.</span></span> <span data-ttu-id="ab8fa-318">La tabella seguente elenca i file del dizionario risorse e il tema associato a ogni file:</span><span class="sxs-lookup"><span data-stu-id="ab8fa-318">The following table lists the resource dictionary files and the theme that is associated with each file:</span></span>

|<span data-ttu-id="ab8fa-319">Nome file del dizionario risorse</span><span class="sxs-lookup"><span data-stu-id="ab8fa-319">Resource dictionary file name</span></span>|<span data-ttu-id="ab8fa-320">Tema di Windows</span><span class="sxs-lookup"><span data-stu-id="ab8fa-320">Windows theme</span></span>|
|-----------------------------------|-------------------|
|`Classic.xaml`|<span data-ttu-id="ab8fa-321">Aspetto classico di Windows 9x/2000 in Windows XP</span><span class="sxs-lookup"><span data-stu-id="ab8fa-321">Classic Windows 9x/2000 look on Windows XP</span></span>|
|`Luna.NormalColor.xaml`|<span data-ttu-id="ab8fa-322">Tema blu predefinito in Windows XP</span><span class="sxs-lookup"><span data-stu-id="ab8fa-322">Default blue theme on Windows XP</span></span>|
|`Luna.Homestead.xaml`|<span data-ttu-id="ab8fa-323">Tema verde oliva in Windows XP</span><span class="sxs-lookup"><span data-stu-id="ab8fa-323">Olive theme on Windows XP</span></span>|
|`Luna.Metallic.xaml`|<span data-ttu-id="ab8fa-324">Tema argento in Windows XP</span><span class="sxs-lookup"><span data-stu-id="ab8fa-324">Silver theme on Windows XP</span></span>|
|`Royale.NormalColor.xaml`|<span data-ttu-id="ab8fa-325">Tema predefinito in Windows XP Media Center Edition</span><span class="sxs-lookup"><span data-stu-id="ab8fa-325">Default theme on Windows XP Media Center Edition</span></span>|
|`Aero.NormalColor.xaml`|<span data-ttu-id="ab8fa-326">Tema predefinito in Windows Vista</span><span class="sxs-lookup"><span data-stu-id="ab8fa-326">Default theme on Windows Vista</span></span>|

<span data-ttu-id="ab8fa-327">Non è necessario definire una risorsa per ogni tema.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-327">You do not need to define a resource for every theme.</span></span> <span data-ttu-id="ab8fa-328">Se una risorsa non è definita per un tema specifico, il controllo la cerca in `Classic.xaml`.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-328">If a resource is not defined for a specific theme, then the control checks `Classic.xaml` for the resource.</span></span> <span data-ttu-id="ab8fa-329">Se la risorsa non è definita nel file che corrisponde al tema corrente o in `Classic.xaml`, il controllo usa la risorsa generica, che si trova in un file del dizionario risorse denominato `generic.xaml`.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-329">If the resource is not defined in the file that corresponds to the current theme or in `Classic.xaml`, the control uses the generic resource, which is in a resource dictionary file named `generic.xaml`.</span></span>  <span data-ttu-id="ab8fa-330">Il file `generic.xaml` si trova nella stessa cartella dei file del dizionario risorse specifico del tema.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-330">The `generic.xaml` file is located in the same folder as the theme-specific resource dictionary files.</span></span> <span data-ttu-id="ab8fa-331">Anche se `generic.xaml` non corrisponde a un tema di Windows specifico, è comunque un dizionario a livello di tema.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-331">Although `generic.xaml` does not correspond to a specific Windows theme, it is still a theme-level dictionary.</span></span>

<span data-ttu-id="ab8fa-332">L' [C#](https://github.com/dotnet/samples/tree/master/snippets/csharp/VS_Snippets_Wpf/CustomControlNumericUpDown/CSharp) esempio o [Visual Basic](https://github.com/dotnet/samples/tree/master/snippets/visualbasic/VS_Snippets_Wpf/CustomControlNumericUpDown/visualbasic) controllo personalizzato NumericUpDown con tema e supporto di automazione interfaccia utente contiene due dizionari risorse per il controllo `NumericUpDown`: uno si trova in Generic. XAML, mentre l'altro è in luna. NormalColor. XAML.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-332">The [C#](https://github.com/dotnet/samples/tree/master/snippets/csharp/VS_Snippets_Wpf/CustomControlNumericUpDown/CSharp) or [Visual Basic](https://github.com/dotnet/samples/tree/master/snippets/visualbasic/VS_Snippets_Wpf/CustomControlNumericUpDown/visualbasic) NumericUpDown custom control with theme and UI automation support sample contains two resource dictionaries for the `NumericUpDown` control: one is in generic.xaml, and the other is in Luna.NormalColor.xaml.</span></span> 

<span data-ttu-id="ab8fa-333">Quando si inserisce una <xref:System.Windows.Controls.ControlTemplate> in uno dei file del dizionario risorse specifici del tema, è necessario creare un costruttore statico per il controllo e chiamare il metodo <xref:System.Windows.DependencyProperty.OverrideMetadata%28System.Type%2CSystem.Windows.PropertyMetadata%29> sul <xref:System.Windows.FrameworkElement.DefaultStyleKey%2A>, come illustrato nell'esempio seguente.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-333">When you put a <xref:System.Windows.Controls.ControlTemplate> in any of the theme-specific resource dictionary files, you must create a static constructor for your control and call the <xref:System.Windows.DependencyProperty.OverrideMetadata%28System.Type%2CSystem.Windows.PropertyMetadata%29> method on the <xref:System.Windows.FrameworkElement.DefaultStyleKey%2A>, as shown in the following example.</span></span>

[!code-csharp[CustomControlNumericUpDownOneProject#StaticConstructor](~/samples/snippets/csharp/VS_Snippets_Wpf/CustomControlNumericUpDownOneProject/CSharp/NumericUpDown.cs#staticconstructor)]
[!code-vb[CustomControlNumericUpDownOneProject#StaticConstructor](~/samples/snippets/visualbasic/VS_Snippets_Wpf/CustomControlNumericUpDownOneProject/visualbasic/numericupdown.vb#staticconstructor)]

##### <a name="defining-and-referencing-keys-for-theme-resources"></a><span data-ttu-id="ab8fa-334">Definizione delle chiavi e relativo riferimento per le risorse del tema</span><span class="sxs-lookup"><span data-stu-id="ab8fa-334">Defining and Referencing Keys for Theme Resources</span></span>

<span data-ttu-id="ab8fa-335">Quando si definisce una risorsa a livello di elemento, è possibile assegnare una stringa come chiave e accedere alla risorsa tramite la stringa.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-335">When you define a resource at the element level, you can assign a string as its key and access the resource via the string.</span></span> <span data-ttu-id="ab8fa-336">Quando si definisce una risorsa a livello di tema, è necessario usare un <xref:System.Windows.ComponentResourceKey> come chiave.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-336">When you define a resource at the theme level, you must use a <xref:System.Windows.ComponentResourceKey> as the key.</span></span>  <span data-ttu-id="ab8fa-337">L'esempio seguente definisce una risorsa in generic.xaml.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-337">The following example defines a resource in generic.xaml.</span></span>

[!code-xaml[ThemeResourcesControlLibrary#5](~/samples/snippets/csharp/VS_Snippets_Wpf/ThemeResourcesControlLibrary/CS/Themes/generic.xaml#5)]

<span data-ttu-id="ab8fa-338">Nell'esempio seguente viene fatto riferimento alla risorsa specificando il <xref:System.Windows.ComponentResourceKey> come chiave.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-338">The following example references the resource by specifying the <xref:System.Windows.ComponentResourceKey> as the key.</span></span>

[!code-xaml[ThemeResourcesControlLibrary#6](~/samples/snippets/csharp/VS_Snippets_Wpf/ThemeResourcesControlLibrary/CS/NumericUpDown.xaml#6)]

##### <a name="specifying-the-location-of-theme-resources"></a><span data-ttu-id="ab8fa-339">Indicazione del percorso delle risorse del tema</span><span class="sxs-lookup"><span data-stu-id="ab8fa-339">Specifying the Location of Theme Resources</span></span>

<span data-ttu-id="ab8fa-340">Per trovare le risorse per un controllo, l'applicazione host deve sapere che l'assembly contiene risorse specifiche del controllo.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-340">To find the resources for a control, the hosting application needs to know that the assembly contains control-specific resources.</span></span> <span data-ttu-id="ab8fa-341">È possibile eseguire questa operazione aggiungendo il <xref:System.Windows.ThemeInfoAttribute> all'assembly che contiene il controllo.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-341">You can accomplish that by adding the <xref:System.Windows.ThemeInfoAttribute> to the assembly that contains the control.</span></span> <span data-ttu-id="ab8fa-342">Il <xref:System.Windows.ThemeInfoAttribute> dispone di una proprietà <xref:System.Windows.ThemeInfoAttribute.GenericDictionaryLocation%2A> che specifica il percorso delle risorse generiche e una proprietà <xref:System.Windows.ThemeInfoAttribute.ThemeDictionaryLocation%2A> che specifica il percorso delle risorse specifiche del tema.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-342">The <xref:System.Windows.ThemeInfoAttribute> has a <xref:System.Windows.ThemeInfoAttribute.GenericDictionaryLocation%2A> property that specifies the location of generic resources, and a <xref:System.Windows.ThemeInfoAttribute.ThemeDictionaryLocation%2A> property that specifies the location of the theme-specific resources.</span></span>

<span data-ttu-id="ab8fa-343">Nell'esempio seguente vengono impostate le proprietà <xref:System.Windows.ThemeInfoAttribute.GenericDictionaryLocation%2A> e <xref:System.Windows.ThemeInfoAttribute.ThemeDictionaryLocation%2A> su <xref:System.Windows.ResourceDictionaryLocation.SourceAssembly>, per specificare che le risorse generiche e specifiche del tema si trovano nello stesso assembly del controllo.</span><span class="sxs-lookup"><span data-stu-id="ab8fa-343">The following example sets the <xref:System.Windows.ThemeInfoAttribute.GenericDictionaryLocation%2A> and <xref:System.Windows.ThemeInfoAttribute.ThemeDictionaryLocation%2A> properties to <xref:System.Windows.ResourceDictionaryLocation.SourceAssembly>, to specify that the generic and theme-specific resources are in the same assembly as the control.</span></span>

[!code-csharp[CustomControlNumericUpDown#ThemesSection](~/samples/snippets/csharp/VS_Snippets_Wpf/CustomControlNumericUpDown/CSharp/CustomControlLibrary/Properties/AssemblyInfo.cs#themessection)]
[!code-vb[CustomControlNumericUpDown#ThemesSection](~/samples/snippets/visualbasic/VS_Snippets_Wpf/CustomControlNumericUpDown/visualbasic/customcontrollibrary/my project/assemblyinfo.vb#themessection)]

## <a name="see-also"></a><span data-ttu-id="ab8fa-344">Vedere anche</span><span class="sxs-lookup"><span data-stu-id="ab8fa-344">See also</span></span>

- [<span data-ttu-id="ab8fa-345">Progettare XAML in Visual Studio</span><span class="sxs-lookup"><span data-stu-id="ab8fa-345">Design XAML in Visual Studio</span></span>](/visualstudio/xaml-tools/designing-xaml-in-visual-studio)
- [<span data-ttu-id="ab8fa-346">URI di tipo pack in WPF</span><span class="sxs-lookup"><span data-stu-id="ab8fa-346">Pack URIs in WPF</span></span>](../app-development/pack-uris-in-wpf.md)
- [<span data-ttu-id="ab8fa-347">Personalizzazione dei controlli</span><span class="sxs-lookup"><span data-stu-id="ab8fa-347">Control Customization</span></span>](control-customization.md)
