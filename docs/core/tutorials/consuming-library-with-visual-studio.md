---
title: Usare una libreria .NET Standard in Visual Studio 2017
description: Compilare un'applicazione .NET Core che chiama i membri di un'altra libreria di classi con Visual Studio 2017.
author: BillWagner
ms.author: wiwagn
ms.date: 06/05/2018
dev_langs:
- csharp
- vb
ms.custom: vs-dotnet, seodec18
ms.openlocfilehash: 7a7ab9e8f148eaab8250a7cb10c7d38d2f70e4cd
ms.sourcegitcommit: cdf67135a98a5a51913dacddb58e004a3c867802
ms.translationtype: HT
ms.contentlocale: it-IT
ms.lasthandoff: 08/21/2019
ms.locfileid: "69660573"
---
# <a name="consume-a-net-standard-library-in-visual-studio-2017"></a><span data-ttu-id="2f66c-103">Usare una libreria .NET Standard in Visual Studio 2017</span><span class="sxs-lookup"><span data-stu-id="2f66c-103">Consume a .NET Standard library in Visual Studio 2017</span></span>

<span data-ttu-id="2f66c-104">Dopo aver creato una libreria di classi .NET Standard seguendo i passaggi riportati in [Creazione di una libreria di classi con C# e .NET Core in Visual Studio 2017](./library-with-visual-studio.md) o [Compilazione di una libreria di classi con Visual Basic e .NET Core in Visual Studio 2017](vb-library-with-visual-studio.md), dopo averla testata in [Test di una libreria di classi con .NET Core in Visual Studio 2017](testing-library-with-visual-studio.md) e dopo aver compilato una versione di rilascio della libreria, il passaggio successivo consiste nel rendere tale libreria disponibile per i chiamanti.</span><span class="sxs-lookup"><span data-stu-id="2f66c-104">Once you've created a .NET Standard class library by following the steps in [Building a C# class library with .NET Core in Visual Studio 2017](./library-with-visual-studio.md) or [Building a Visual Basic class library with .NET Core in Visual Studio 2017](vb-library-with-visual-studio.md), tested it in [Testing a class library with .NET Core in Visual Studio 2017](testing-library-with-visual-studio.md), and built a Release version of the library, the next step is to make it available to callers.</span></span> <span data-ttu-id="2f66c-105">Questa operazione può essere eseguita in due modi diversi:</span><span class="sxs-lookup"><span data-stu-id="2f66c-105">You can do this in two ways:</span></span>

* <span data-ttu-id="2f66c-106">Se la libreria verrà usata da una sola soluzione, ad esempio se è un componente di un'unica applicazione di grandi dimensioni, è possibile includerla come progetto all'interno della soluzione.</span><span class="sxs-lookup"><span data-stu-id="2f66c-106">If the library will be used by a single solution (for example, if it's a component in a single large application), you can include it as a project in your solution.</span></span>

* <span data-ttu-id="2f66c-107">Se la libreria sarà accessibile a livello generale, è possibile distribuirla come pacchetto NuGet.</span><span class="sxs-lookup"><span data-stu-id="2f66c-107">If the library will be generally accessible, you can distribute it as a NuGet package.</span></span>

## <a name="including-a-library-as-a-project-in-a-solution"></a><span data-ttu-id="2f66c-108">Inclusione di una libreria in una soluzione come progetto</span><span class="sxs-lookup"><span data-stu-id="2f66c-108">Including a library as a project in a solution</span></span>

<span data-ttu-id="2f66c-109">È possibile includere l'applicazione come parte della soluzione, allo stesso modo in cui sono stati inclusi unit test nella soluzione della libreria di classi.</span><span class="sxs-lookup"><span data-stu-id="2f66c-109">Just as you included unit tests in the same solution as your class library, you can include your application as part of that solution.</span></span> <span data-ttu-id="2f66c-110">Ad esempio, è possibile usare la libreria di classi in un'applicazione console che chiede all'utente di immettere una stringa e segnala se il primo carattere è in maiuscolo:</span><span class="sxs-lookup"><span data-stu-id="2f66c-110">For example, you can use your class library in a console application that prompts the user to enter a string and reports whether its first character is uppercase:</span></span>

# <a name="ctabcsharp"></a>[<span data-ttu-id="2f66c-111">C#</span><span class="sxs-lookup"><span data-stu-id="2f66c-111">C#</span></span>](#tab/csharp)
1. <span data-ttu-id="2f66c-112">Aprire la soluzione `ClassLibraryProjects` creata in [Creazione di una libreria di classi con C# e .NET Core in Visual Studio 2017](./library-with-visual-studio.md).</span><span class="sxs-lookup"><span data-stu-id="2f66c-112">Open the `ClassLibraryProjects` solution you created in the [Building a C# Class Library with .NET Core in Visual Studio 2017](./library-with-visual-studio.md) topic.</span></span> <span data-ttu-id="2f66c-113">In **Esplora soluzioni**, fare clic con il pulsante destro del mouse sulla soluzione **ClassLibraryProjects** e scegliere **Aggiungi** > **Nuovo progetto** dal menu di scelta rapida.</span><span class="sxs-lookup"><span data-stu-id="2f66c-113">In **Solution Explorer**, right-click the **ClassLibraryProjects** solution and select **Add** > **New Project** from the context menu.</span></span>

1. <span data-ttu-id="2f66c-114">Nella finestra di dialogo **Aggiungi nuovo progetto**, espandere il nodo selezionare il nodo **Visual C#** e selezionare **.NET Core** seguito dal modello di progetto **Console App (.NET Core)** .</span><span class="sxs-lookup"><span data-stu-id="2f66c-114">In the **Add New Project** dialog, expand the **Visual C#** node and select the **.NET Core** node followed by the **Console App (.NET Core)** project template.</span></span> <span data-ttu-id="2f66c-115">Nella casella di testo **Nome**, digitare "ShowCase", quindi selezionare il pulsante **OK**.</span><span class="sxs-lookup"><span data-stu-id="2f66c-115">In the **Name** text box, type "ShowCase", and select the **OK** button.</span></span>

   ![Finestra di dialogo di Visual Studio Aggiungi nuovo progetto - C#](./media/consuming-library-with-visual-studio/add-new-project-dialog.png)

1. <span data-ttu-id="2f66c-117">In **Esplora soluzioni** fare clic con il pulsante destro del mouse sul progetto **ShowCase** e selezionare **Imposta come progetto di avvio** nel menu di scelta rapida.</span><span class="sxs-lookup"><span data-stu-id="2f66c-117">In **Solution Explorer**, right-click the **ShowCase** project and select **Set as StartUp Project** in the context menu.</span></span>

   ![Menu di scelta rapida del progetto di Visual Studio per impostare il progetto di avvio - C#](./media/consuming-library-with-visual-studio/set-startup-project-context-menu.png)

1. <span data-ttu-id="2f66c-119">All'inizio il progetto non ha accesso alla libreria di classi.</span><span class="sxs-lookup"><span data-stu-id="2f66c-119">Initially, your project doesn't have access to your class library.</span></span> <span data-ttu-id="2f66c-120">Per consentire al progetto di chiamare metodi della libreria di classi, si crea un riferimento alla libreria di classi.</span><span class="sxs-lookup"><span data-stu-id="2f66c-120">To allow it to call methods in your class library, you create a reference to the class library.</span></span> <span data-ttu-id="2f66c-121">In **Esplora soluzioni** fare clic con il pulsante destro del mouse sul nodo **Dipendenze** del progetto `ShowCase` e selezionare **Aggiungi riferimento**.</span><span class="sxs-lookup"><span data-stu-id="2f66c-121">In **Solution Explorer**, right-click the `ShowCase` project's **Dependencies** node and select **Add Reference**.</span></span>

   ![Menu di scelta rapida per aggiungere riferimenti al progetto di Visual Studio - C#](./media/consuming-library-with-visual-studio/add-reference-context-menu.png)

1. <span data-ttu-id="2f66c-123">Nella finestra di dialogo **Gestione riferimenti** selezionare **StringLibrary**, il progetto della libreria di classi e fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="2f66c-123">In the **Reference Manager** dialog, select **StringLibrary**, your class library project, and select the **OK** button.</span></span>

   ![Finestra di dialogo Gestione riferimenti di Visual Studio - C#](./media/consuming-library-with-visual-studio/manage-project-references.png)

1. <span data-ttu-id="2f66c-125">Nella finestra del codice del file *Program.cs* sostituire tutto il codice con il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="2f66c-125">In the code window for the *Program.cs* file, replace all of the code with the following code:</span></span>

   [!CODE-csharp[UsingClassLib#1](../../../samples/snippets/csharp/getting_started/with_visual_studio_2017/showcase.cs)]

   <span data-ttu-id="2f66c-126">Il codice usa la variabile `row` per mantenere il conteggio del numero di righe di dati scritti nella finestra della console.</span><span class="sxs-lookup"><span data-stu-id="2f66c-126">The code uses the `row` variable to maintain a count of the number of rows of data written to the console window.</span></span> <span data-ttu-id="2f66c-127">Ogni volta che è maggiore o uguale a 25, il codice cancella la finestra della console e visualizza un messaggio per l'utente.</span><span class="sxs-lookup"><span data-stu-id="2f66c-127">Whenever it is greater than or equal to 25, the code clears the console window and displays a message to the user.</span></span>

   <span data-ttu-id="2f66c-128">Il programma richiede all'utente di immettere una stringa.</span><span class="sxs-lookup"><span data-stu-id="2f66c-128">The program prompts the user to enter a string.</span></span> <span data-ttu-id="2f66c-129">Indica se la stringa inizia con un carattere maiuscolo.</span><span class="sxs-lookup"><span data-stu-id="2f66c-129">It indicates whether the string starts with an uppercase character.</span></span> <span data-ttu-id="2f66c-130">Se l'utente preme INVIO senza immettere una stringa, l'applicazione viene terminata e la finestra della console viene chiusa.</span><span class="sxs-lookup"><span data-stu-id="2f66c-130">If the user presses the Enter key without entering a string, the application terminates, and the console window closes.</span></span>

1. <span data-ttu-id="2f66c-131">Se necessario, modificare la barra degli strumenti per compilare la versione di **debug** del progetto `ShowCase`.</span><span class="sxs-lookup"><span data-stu-id="2f66c-131">If necessary, change the toolbar to compile the **Debug** release of the `ShowCase` project.</span></span> <span data-ttu-id="2f66c-132">Compilare ed eseguire il programma selezionando la freccia verde nel pulsante **ShowCase**.</span><span class="sxs-lookup"><span data-stu-id="2f66c-132">Compile and run the program by selecting the green arrow on the **ShowCase** button.</span></span>

   ![Barra degli strumenti di Visual Studio con il pulsante di debug - C#](./media/consuming-library-with-visual-studio/visual-studio-project-toolbar.png)
# <a name="visual-basictabvb"></a>[<span data-ttu-id="2f66c-134">Visual Basic</span><span class="sxs-lookup"><span data-stu-id="2f66c-134">Visual Basic</span></span>](#tab/vb)
1. <span data-ttu-id="2f66c-135">Aprire la soluzione `ClassLibraryProjects` creata in [Creazione di una libreria di classi con Visual Basic e .NET Core in Visual Studio 2017](vb-library-with-visual-studio.md).</span><span class="sxs-lookup"><span data-stu-id="2f66c-135">Open the `ClassLibraryProjects` solution you created in the [Building a class Library with Visual Basic and .NET Core in Visual Studio 2017](vb-library-with-visual-studio.md) topic.</span></span> <span data-ttu-id="2f66c-136">In **Esplora soluzioni**, fare clic con il pulsante destro del mouse sulla soluzione **ClassLibraryProjects** e scegliere **Aggiungi** > **Nuovo progetto** dal menu di scelta rapida.</span><span class="sxs-lookup"><span data-stu-id="2f66c-136">In **Solution Explorer**, right-click the **ClassLibraryProjects** solution and select **Add** > **New Project** from the context menu.</span></span>

1. <span data-ttu-id="2f66c-137">Nella finestra di dialogo **Aggiungi nuovo progetto**, espandere il nodo selezionare il nodo **Visual Basic** e selezionare **.NET Core** seguito dal modello di progetto **Console App (.NET Core)** .</span><span class="sxs-lookup"><span data-stu-id="2f66c-137">In the **Add New Project** dialog, expand the **Visual Basic** node and select the **.NET Core** node followed by the **Console App (.NET Core)** project template.</span></span> <span data-ttu-id="2f66c-138">Nella casella di testo **Nome**, digitare "ShowCase", quindi selezionare il pulsante **OK**.</span><span class="sxs-lookup"><span data-stu-id="2f66c-138">In the **Name** text box, type "ShowCase", and select the **OK** button.</span></span>

   ![Finestra di dialogo di Visual Studio Aggiungi nuovo progetto - Visual Basic](./media/consuming-library-with-visual-studio/add-new-vb-project-dialog.png)

1. <span data-ttu-id="2f66c-140">In **Esplora soluzioni** fare clic con il pulsante destro del mouse sul progetto **ShowCase** e selezionare **Imposta come progetto di avvio** nel menu di scelta rapida.</span><span class="sxs-lookup"><span data-stu-id="2f66c-140">In **Solution Explorer**, right-click the **ShowCase** project and select **Set as StartUp Project** in the context menu.</span></span> 

   ![Menu di scelta rapida del progetto di Visual Studio per impostare il progetto di avvio - Visual Basic](./media/consuming-library-with-visual-studio/set-startup-project-context-menu.png)

1. <span data-ttu-id="2f66c-142">All'inizio il progetto non ha accesso alla libreria di classi.</span><span class="sxs-lookup"><span data-stu-id="2f66c-142">Initially, your project doesn't have access to your class library.</span></span> <span data-ttu-id="2f66c-143">Per consentire al progetto di chiamare metodi della libreria di classi, si crea un riferimento alla libreria di classi.</span><span class="sxs-lookup"><span data-stu-id="2f66c-143">To allow it to call methods in your class library, you create a reference to the class library.</span></span> <span data-ttu-id="2f66c-144">In **Esplora soluzioni** fare clic con il pulsante destro del mouse sul nodo **Dipendenze** del progetto `ShowCase` e selezionare **Aggiungi riferimento**.</span><span class="sxs-lookup"><span data-stu-id="2f66c-144">In **Solution Explorer**, right-click the `ShowCase` project's **Dependencies** node and select **Add Reference**.</span></span>

   ![Menu di scelta rapida per aggiungere riferimenti al progetto di Visual Studio - Visual Basic](./media/consuming-library-with-visual-studio/add-reference-context-menu.png)

1. <span data-ttu-id="2f66c-146">Nella finestra di dialogo **Gestione riferimenti** selezionare **StringLibrary**, il progetto della libreria di classi e fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="2f66c-146">In the **Reference Manager** dialog, select **StringLibrary**, your class library project, and select the **OK** button.</span></span>

   ![Finestra di dialogo di Visual Studio Gestione riferimenti - Visual Basic](./media/consuming-library-with-visual-studio/manage-project-references.png)

1. <span data-ttu-id="2f66c-148">Nella finestra del codice del file *Program.vb* sostituire tutto il codice con il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="2f66c-148">In the code window for the *Program.vb* file, replace all of the code with the following code:</span></span>

    [!CODE-vb[UsingClassLib#1](../../../samples/snippets/core/tutorials/vb-library-with-visual-studio/showcase.vb)]

   <span data-ttu-id="2f66c-149">Il codice usa la variabile `row` per mantenere il conteggio del numero di righe di dati scritti nella finestra della console.</span><span class="sxs-lookup"><span data-stu-id="2f66c-149">The code uses the `row` variable to maintain a count of the number of rows of data written to the console window.</span></span> <span data-ttu-id="2f66c-150">Ogni volta che è maggiore o uguale a 25, il codice cancella la finestra della console e visualizza un messaggio per l'utente.</span><span class="sxs-lookup"><span data-stu-id="2f66c-150">Whenever it is greater than or equal to 25, the code clears the console window and displays a message to the user.</span></span>

   <span data-ttu-id="2f66c-151">Il programma richiede all'utente di immettere una stringa.</span><span class="sxs-lookup"><span data-stu-id="2f66c-151">The program prompts the user to enter a string.</span></span> <span data-ttu-id="2f66c-152">Indica se la stringa inizia con un carattere maiuscolo.</span><span class="sxs-lookup"><span data-stu-id="2f66c-152">It indicates whether the string starts with an uppercase character.</span></span> <span data-ttu-id="2f66c-153">Se l'utente preme INVIO senza immettere una stringa, l'applicazione viene terminata e la finestra della console viene chiusa.</span><span class="sxs-lookup"><span data-stu-id="2f66c-153">If the user presses the Enter key without entering a string, the application terminates, and the console window closes.</span></span>

1. <span data-ttu-id="2f66c-154">Se necessario, modificare la barra degli strumenti per compilare la versione di **debug** del progetto `ShowCase`.</span><span class="sxs-lookup"><span data-stu-id="2f66c-154">If necessary, change the toolbar to compile the **Debug** release of the `ShowCase` project.</span></span> <span data-ttu-id="2f66c-155">Compilare ed eseguire il programma selezionando la freccia verde nel pulsante **ShowCase**.</span><span class="sxs-lookup"><span data-stu-id="2f66c-155">Compile and run the program by selecting the green arrow on the **ShowCase** button.</span></span>

   ![Debug sulla barra degli strumenti - Visual Basic](./media/consuming-library-with-visual-studio/visual-studio-project-toolbar.png)
---

<span data-ttu-id="2f66c-157">È possibile eseguire il debug e pubblicare l'applicazione che usa questa libreria seguendo i passaggi illustrati in [Esecuzione del debug dell'applicazione C# Hello World con Visual Studio 2017](debugging-with-visual-studio.md) e [Pubblicazione dell'applicazione Hello World con Visual Studio 2017](publishing-with-visual-studio.md).</span><span class="sxs-lookup"><span data-stu-id="2f66c-157">You can debug and publish the application that uses this library by following the steps in [Debugging your Hello World application with Visual Studio 2017](debugging-with-visual-studio.md) and [Publishing your Hello World Application with Visual Studio 2017](publishing-with-visual-studio.md).</span></span>

## <a name="distributing-the-library-in-a-nuget-package"></a><span data-ttu-id="2f66c-158">Distribuzione della libreria in un pacchetto NuGet</span><span class="sxs-lookup"><span data-stu-id="2f66c-158">Distributing the library in a NuGet package</span></span>

<span data-ttu-id="2f66c-159">Per rendere la libreria di classi disponibile sul Web, è possibile pubblicarla come pacchetto NuGet.</span><span class="sxs-lookup"><span data-stu-id="2f66c-159">You can make your class library widely available by publishing it as a NuGet package.</span></span> <span data-ttu-id="2f66c-160">Visual Studio non supporta la creazione di pacchetti NuGet.</span><span class="sxs-lookup"><span data-stu-id="2f66c-160">Visual Studio does not support the creation of NuGet packages.</span></span> <span data-ttu-id="2f66c-161">Per creare un pacchetto, usare l'[utilità della riga di comando `dotnet`](../tools/dotnet.md):</span><span class="sxs-lookup"><span data-stu-id="2f66c-161">To create one, you use the [`dotnet` command line utility](../tools/dotnet.md):</span></span>

1. <span data-ttu-id="2f66c-162">Aprire una finestra della console.</span><span class="sxs-lookup"><span data-stu-id="2f66c-162">Open a console window.</span></span> <span data-ttu-id="2f66c-163">Ad esempio, nella casella di testo **Chiedimi qualcosa** della barra delle applicazioni di Windows immettere `Command Prompt`, o `cmd` per maggiore brevità, e aprire una finestra della console selezionando l'app desktop **Prompt dei comandi** o premendo INVIO se è selezionata nei risultati della ricerca.</span><span class="sxs-lookup"><span data-stu-id="2f66c-163">For example in the **Ask me anything** text box in the Windows taskbar, enter `Command Prompt` (or `cmd` for short), and open a console window by either selecting the **Command Prompt** desktop app or pressing Enter if it's selected in the search results.</span></span>

1. <span data-ttu-id="2f66c-164">Passare alla directory del progetto della libreria.</span><span class="sxs-lookup"><span data-stu-id="2f66c-164">Navigate to your library's project directory.</span></span> <span data-ttu-id="2f66c-165">A meno che non sia stato riconfigurato il percorso tipico dei file, si tratta della directory *Documenti\Visual Studio 2017\Projects\ClassLibraryProjects\StringLibrary*.</span><span class="sxs-lookup"><span data-stu-id="2f66c-165">Unless you've reconfigured the typical file location, it's in the *Documents\Visual Studio 2017\Projects\ClassLibraryProjects\StringLibrary* directory.</span></span> <span data-ttu-id="2f66c-166">La directory contiene il codice sorgente e un file di progetto, *StringLibrary.csproj*.</span><span class="sxs-lookup"><span data-stu-id="2f66c-166">The directory contains your source code and a project file, *StringLibrary.csproj*.</span></span>

1. <span data-ttu-id="2f66c-167">Eseguire il comando `dotnet pack --no-build`.</span><span class="sxs-lookup"><span data-stu-id="2f66c-167">Issue the command `dotnet pack --no-build`.</span></span> <span data-ttu-id="2f66c-168">L'utilità `dotnet` genera un pacchetto con estensione *nupkg*.</span><span class="sxs-lookup"><span data-stu-id="2f66c-168">The `dotnet` utility generates a package with a *.nupkg* extension.</span></span>

   > [!TIP]
   > <span data-ttu-id="2f66c-169">Se la directory che contiene *dotnet.exe* non si trova nel percorso indicato, è possibile individuarne il percorso immettendo `where dotnet.exe` nella finestra della console.</span><span class="sxs-lookup"><span data-stu-id="2f66c-169">If the directory that contains *dotnet.exe* is not in your PATH, you can find its location by entering `where dotnet.exe` in the console window.</span></span>

<span data-ttu-id="2f66c-170">Per altre informazioni sulla creazione di pacchetti NuGet, vedere [Come creare un pacchetto NuGet con strumenti multipiattaforma](../deploying/creating-nuget-packages.md).</span><span class="sxs-lookup"><span data-stu-id="2f66c-170">For more information on creating NuGet packages, see [How to Create a NuGet Package with Cross Platform Tools](../deploying/creating-nuget-packages.md).</span></span>
